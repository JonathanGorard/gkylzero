/* -*- c++ -*- */

extern "C" {
#include <gkyl_alloc.h>
#include <gkyl_array.h>
#include <gkyl_array_ops.h>
#include <gkyl_const.h>
#include <gkyl_gauss_quad_data.h>
#include <gkyl_vlasov_lte_proj_on_basis.h>
#include <gkyl_vlasov_lte_proj_on_basis_priv.h>
#include <gkyl_range.h>
}

static void
gkyl_parallelize_components_kernel_launch_dims(dim3* dimGrid, dim3* dimBlock, gkyl_range range, int ncomp)
{
  // Create a 2D thread grid so we launch ncomp*range.volume number of threads and can parallelize over components too
  dimBlock->y = GKYL_MIN2(ncomp, GKYL_DEFAULT_NUM_THREADS);
  dimGrid->y = gkyl_int_div_up(ncomp, dimBlock->y);
  dimBlock->x = GKYL_DEFAULT_NUM_THREADS/ncomp;
  dimGrid->x = gkyl_int_div_up(range.volume, dimBlock->x);
}

__global__ static void
gkyl_vlasov_lte_proj_on_basis_advance_cu_ker(const struct gkyl_rect_grid phase_grid,
  const struct gkyl_range phase_range, const struct gkyl_range conf_range,
  const struct gkyl_array* GKYL_RESTRICT conf_basis_at_ords, 
  const struct gkyl_array* GKYL_RESTRICT phase_basis_at_ords, 
  const struct gkyl_array* GKYL_RESTRICT phase_ordinates, 
  const struct gkyl_array* GKYL_RESTRICT phase_weights, const int *p2c_qidx, bool is_relativistic, 
  bool is_canonical_pb, const struct gkyl_array* GKYL_RESTRICT h_ij_inv,  const struct gkyl_array* GKYL_RESTRICT det_h,
  const struct gkyl_array* GKYL_RESTRICT moms_lte, struct gkyl_array* GKYL_RESTRICT f_lte_at_nodes)
{
  double f_floor = 1.e-40;
  int pdim = phase_range.ndim, cdim = conf_range.ndim;
  int vdim = pdim-cdim;

  int num_conf_basis = conf_basis_at_ords->ncomp;
  int tot_conf_quad = conf_basis_at_ords->size;
  int tot_phase_quad = phase_basis_at_ords->size;

  // JJ 2024/03/23: hard-coded to 3x, vdim=3, p=2 for now.
  // This hard-coding avoids issues with GPUs and dynamic memory allocation.
  double n_quad[27], V_drift_quad[27][3], T_over_m_quad[27];
  double V_drift_quad_cell_avg[27][3];
  double expamp_quad[27];
  double h_ij_inv_quad[27][6];
  double det_h_quad[27];

  double xc[GKYL_MAX_DIM], xmu[GKYL_MAX_DIM];
  int pidx[GKYL_MAX_DIM], cidx[GKYL_MAX_CDIM];

  // 2D thread grid
  // linc2 = c where c is the component index (from 0 to tot_phase_quad)
  long linc2 = threadIdx.y + blockIdx.y*blockDim.y;
  for(unsigned long tid = threadIdx.x + blockIdx.x*blockDim.x;
      tid < phase_range.volume; tid += blockDim.x*gridDim.x) {
    gkyl_sub_range_inv_idx(&phase_range, tid, pidx);

    // get configuration-space linear index.
    for (unsigned int k = 0; k < conf_range.ndim; k++) {
      cidx[k] = pidx[k];
    }
    long lincC = gkyl_range_idx(&conf_range, cidx);

    const double *moms_lte_d = (const double*) gkyl_array_cfetch(moms_lte, lincC);
    const double *n_d = moms_lte_d;
    const double *V_drift_d = &moms_lte_d[num_conf_basis];
    const double *T_over_m_d = &moms_lte_d[num_conf_basis*(vdim+1)];
    const double *h_ij_inv_d;
    const double *det_h_d;
    if (is_canonical_pb) {
      h_ij_inv_d = (const double*) gkyl_array_cfetch(h_ij_inv, lincC);
      det_h_d = (const double*) gkyl_array_cfetch(det_h, lincC);
    }

    // Sum over basis for given LTE moments (n, V_drift, T/m) in the stationary frame
    for (int n=0; n<tot_conf_quad; ++n) {
      const double *b_ord = (const double*) gkyl_array_cfetch(conf_basis_at_ords, n);

      // Zero out quadrature values
      n_quad[n] = 0.0;
      for (int d=0; d<vdim; ++d) {
        V_drift_quad[n][d] = 0.0;
        // Store the cell average of V_drift to use if V_drift^2 > c^2 at quadrature points
        V_drift_quad_cell_avg[n][d] = V_drift_d[num_conf_basis*d]*b_ord[0];
      }
      T_over_m_quad[n] = 0.0;

      // Compute the configuration-space quadrature
      for (int k=0; k<num_conf_basis; ++k) {
        n_quad[n] += n_d[k]*b_ord[k];
        for (int d=0; d<vdim; ++d) {
          V_drift_quad[n][d] += V_drift_d[num_conf_basis*d+k]*b_ord[k];
        }
        T_over_m_quad[n] += T_over_m_d[k]*b_ord[k];
      }

      if (is_canonical_pb) {
        det_h_quad[n] = 0.0;
        for (int k=0; k<num_conf_basis; ++k) {
          for (int j=0; j<vdim*(vdim+1)/2; ++j) {
            h_ij_inv_quad[n][j] = 0;
          }
        }
        for (int k=0; k<num_conf_basis; ++k) {
          det_h_quad[n] += det_h_d[k]*b_ord[k];
          for (int j=0; j<vdim*(vdim+1)/2; ++j) {
            h_ij_inv_quad[n][j] += h_ij_inv_d[num_conf_basis*j+k]*b_ord[k];
          }
        }
      }

      // Amplitude of the exponential.
      if ((n_quad[n] > 0.0) && (T_over_m_quad[n] > 0.0)) {
        if (is_relativistic) {
          expamp_quad[n] = n_quad[n]*(1.0/(4.0*GKYL_PI*T_over_m_quad[n]))*(sqrt(2*T_over_m_quad[n]/GKYL_PI));;
        }
        else if (is_canonical_pb) { 
          expamp_quad[n] = (1/det_h_quad[n])*n_quad[n]/sqrt(pow(2.0*GKYL_PI*T_over_m_quad[n], vdim));
        }
        else {
          expamp_quad[n] = n_quad[n]/sqrt(pow(2.0*GKYL_PI*T_over_m_quad[n], vdim));
        }
      }
      else {
        expamp_quad[n] = 0.0;
      }      
    }

    gkyl_rect_grid_cell_center(&phase_grid, pidx, xc);

    long lidx = gkyl_range_idx(&phase_range, pidx);

    // Select for a phase space index fq
    double *fq = (double*) gkyl_array_fetch(f_lte_at_nodes, lidx);
  
    // compute Maxwellian at phase-space quadrature nodes
    for (int n=0; n<tot_phase_quad; ++n) {

      // Each thread in linc2 thread grid handles a different component
      //if (linc2 == n) {

        int cqidx = p2c_qidx[n];

        comp_to_phys(pdim, (const double*) gkyl_array_cfetch(phase_ordinates, n),
          phase_grid.dx, xc, &xmu[0]);

        fq[n] = f_floor;
        if (T_over_m_quad[cqidx] > 0.0) {
          if (is_relativistic) {
            double uu = 0.0;
            double vu = 0.0;
            double vv = 0.0;
            for (int d=0; d<vdim; ++d){
              vv += (V_drift_quad[cqidx][d]*V_drift_quad[cqidx][d]);
              vu += (V_drift_quad[cqidx][d]*xmu[cdim+d]);
              uu += (xmu[cdim+d]*xmu[cdim+d]);
            }
            double gamma_shifted = 0.0;
            if (vv > 1.0) {
              // Check if V_drift^2 > c^2 (where c = 1.0) at quadrature points 
              // If it is, switch to just using the cell average of V_drift for
              // computing the Lorentz boost factor
              double V_drift_sq_avg = 0.0;
              for (int d=0; d<vdim; ++d) { 
                V_drift_sq_avg += (V_drift_quad_cell_avg[cqidx][d]*V_drift_quad_cell_avg[cqidx][d]);
              }
              gamma_shifted = 1.0/sqrt(1.0-V_drift_sq_avg);
            } 
            else {
              gamma_shifted = 1.0/sqrt(1.0-vv);
            }

            fq[n] += expamp_quad[cqidx]*exp( (1.0/T_over_m_quad[cqidx]) 
              - (gamma_shifted/T_over_m_quad[cqidx])*(sqrt(1+uu) - vu) );
          }
            // Assumes a (particle) hamiltonian in canocial form: g = 1/2g^{ij}w_i_w_j
            else if (is_canonical_pb) {
              double efact = 0.0;
              for (int d0=0; d0<vdim; ++d0) {
                for (int d1=d0; d1<vdim; ++d1) {
                  int sym_tensor_index = (d0*(2*vdim - d0 + 1))/2 + (d1-d0);
                  // Grab the spatial metric component, the ctx includes geometry that isn't 
                  // part of the canonical set of variables, like R on the surf of a sphere
                  // q_can includes the canonical variables list
                  double h_ij_inv_loc = h_ij_inv_quad[cqidx][sym_tensor_index]; 
                  // For off-diagnol components, we need to count these twice, due to symmetry
                  int sym_fact = 2;
                  if (d0 == d1){
                    sym_fact = 1;
                  }
                  efact += sym_fact*h_ij_inv_loc*(xmu[cdim+d0]-V_drift_quad[cqidx][d0])*(xmu[cdim+d1]-V_drift_quad[cqidx][d1]);
                }
              }
              // Accuracy of the prefactor doesn't really matter since it will 
              // be fixed by the correct routine
              fq[n] += expamp_quad[cqidx]*exp(-efact/(2.0*T_over_m_quad[cqidx]));
          }
          else {
            double efact = 0.0;        
            for (int d=0; d<vdim; ++d) {
              efact += (xmu[cdim+d]-V_drift_quad[cqidx][d])*(xmu[cdim+d]-V_drift_quad[cqidx][d]);
            }
            fq[n] += expamp_quad[cqidx]*exp(-efact/(2.0*T_over_m_quad[cqidx]));
          }
        }
      //}
    }
  }
}

__global__ static void
gkyl_proj_on_basis_cu_ker(const struct gkyl_rect_grid phase_grid,
  const struct gkyl_range phase_range, const struct gkyl_range conf_range,
  const struct gkyl_array* GKYL_RESTRICT conf_basis_at_ords, 
  const struct gkyl_array* GKYL_RESTRICT phase_basis_at_ords, 
  const struct gkyl_array* GKYL_RESTRICT phase_ordinates, 
  const struct gkyl_array* GKYL_RESTRICT phase_weights, const int *p2c_qidx, bool is_relativistic, 
  bool is_canonical_pb, const struct gkyl_array* GKYL_RESTRICT h_ij_inv,  const struct gkyl_array* GKYL_RESTRICT det_h,
  const struct gkyl_array* GKYL_RESTRICT moms_lte, struct gkyl_array* GKYL_RESTRICT f_lte_at_nodes, 
  struct gkyl_array* GKYL_RESTRICT f_lte)
{

  int num_phase_basis = f_lte->ncomp;
  int tot_phase_quad = phase_basis_at_ords->size;
  int pidx[GKYL_MAX_DIM];

  // 2D thread grid
  // linc2 = c where c is the component index (from 0 to num_phase_basis)
  long linc2 = threadIdx.y + blockIdx.y*blockDim.y;
  for(unsigned long tid = threadIdx.x + blockIdx.x*blockDim.x;
    tid < phase_range.volume; tid += blockDim.x*gridDim.x) {
    gkyl_sub_range_inv_idx(&phase_range, tid, pidx);

    long lidx = gkyl_range_idx(&phase_range, pidx);
    double *f_lte_d = (double*) gkyl_array_fetch(f_lte, lidx);

    // Select for a phase space index fq
    double *fq = (double*) gkyl_array_fetch(f_lte_at_nodes, lidx);

    // compute expansion coefficients of LTE distribution function on basis
    // The following is modeled after proj_on_basis in the private header.
    const double *phase_w = (const double*) phase_weights->data;
    const double *phaseb_o = (const double*) phase_basis_at_ords->data;

  if(linc2 == 0) f_lte_d[0] = 0.02381496723060509*fq[80]+0.03810394756896814*fq[79]+0.02381496723060509*fq[78]+0.03810394756896814*fq[77]+0.06096631611034904*fq[76]+0.03810394756896814*fq[75]+0.02381496723060509*fq[74]+0.03810394756896814*fq[73]+0.02381496723060509*fq[72]+0.03810394756896814*fq[71]+0.06096631611034904*fq[70]+0.03810394756896814*fq[69]+0.06096631611034904*fq[68]+0.09754610577655845*fq[67]+0.06096631611034904*fq[66]+0.03810394756896814*fq[65]+0.06096631611034904*fq[64]+0.03810394756896814*fq[63]+0.02381496723060509*fq[62]+0.03810394756896814*fq[61]+0.02381496723060509*fq[60]+0.03810394756896814*fq[59]+0.06096631611034904*fq[58]+0.03810394756896814*fq[57]+0.02381496723060509*fq[56]+0.03810394756896814*fq[55]+0.02381496723060509*fq[54]+0.03810394756896814*fq[53]+0.06096631611034904*fq[52]+0.03810394756896814*fq[51]+0.06096631611034904*fq[50]+0.09754610577655845*fq[49]+0.06096631611034904*fq[48]+0.03810394756896814*fq[47]+0.06096631611034904*fq[46]+0.03810394756896814*fq[45]+0.06096631611034904*fq[44]+0.09754610577655845*fq[43]+0.06096631611034904*fq[42]+0.09754610577655845*fq[41]+0.1560737692424935*fq[40]+0.09754610577655845*fq[39]+0.06096631611034904*fq[38]+0.09754610577655845*fq[37]+0.06096631611034904*fq[36]+0.03810394756896814*fq[35]+0.06096631611034904*fq[34]+0.03810394756896814*fq[33]+0.06096631611034904*fq[32]+0.09754610577655845*fq[31]+0.06096631611034904*fq[30]+0.03810394756896814*fq[29]+0.06096631611034904*fq[28]+0.03810394756896814*fq[27]+0.02381496723060509*fq[26]+0.03810394756896814*fq[25]+0.02381496723060509*fq[24]+0.03810394756896814*fq[23]+0.06096631611034904*fq[22]+0.03810394756896814*fq[21]+0.02381496723060509*fq[20]+0.03810394756896814*fq[19]+0.02381496723060509*fq[18]+0.03810394756896814*fq[17]+0.06096631611034904*fq[16]+0.03810394756896814*fq[15]+0.06096631611034904*fq[14]+0.09754610577655845*fq[13]+0.06096631611034904*fq[12]+0.03810394756896814*fq[11]+0.06096631611034904*fq[10]+0.03810394756896814*fq[9]+0.02381496723060509*fq[8]+0.03810394756896814*fq[7]+0.02381496723060509*fq[6]+0.03810394756896814*fq[5]+0.06096631611034904*fq[4]+0.03810394756896814*fq[3]+0.02381496723060509*fq[2]+0.03810394756896814*fq[1]+0.02381496723060509*fq[0]; 
  if(linc2 == 1) f_lte_d[1] = 0.03195113136573774*fq[80]+0.05112181018518039*fq[79]+0.03195113136573774*fq[78]+0.05112181018518039*fq[77]+0.08179489629628862*fq[76]+0.05112181018518039*fq[75]+0.03195113136573774*fq[74]+0.05112181018518039*fq[73]+0.03195113136573774*fq[72]+0.05112181018518039*fq[71]+0.08179489629628862*fq[70]+0.05112181018518039*fq[69]+0.08179489629628862*fq[68]+0.1308718340740618*fq[67]+0.08179489629628862*fq[66]+0.05112181018518039*fq[65]+0.08179489629628862*fq[64]+0.05112181018518039*fq[63]+0.03195113136573774*fq[62]+0.05112181018518039*fq[61]+0.03195113136573774*fq[60]+0.05112181018518039*fq[59]+0.08179489629628862*fq[58]+0.05112181018518039*fq[57]+0.03195113136573774*fq[56]+0.05112181018518039*fq[55]+0.03195113136573774*fq[54]-0.03195113136573774*fq[26]-0.05112181018518039*fq[25]-0.03195113136573774*fq[24]-0.05112181018518039*fq[23]-0.08179489629628862*fq[22]-0.05112181018518039*fq[21]-0.03195113136573774*fq[20]-0.05112181018518039*fq[19]-0.03195113136573774*fq[18]-0.05112181018518039*fq[17]-0.08179489629628862*fq[16]-0.05112181018518039*fq[15]-0.08179489629628862*fq[14]-0.1308718340740618*fq[13]-0.08179489629628862*fq[12]-0.05112181018518039*fq[11]-0.08179489629628862*fq[10]-0.05112181018518039*fq[9]-0.03195113136573774*fq[8]-0.05112181018518039*fq[7]-0.03195113136573774*fq[6]-0.05112181018518039*fq[5]-0.08179489629628862*fq[4]-0.05112181018518039*fq[3]-0.03195113136573774*fq[2]-0.05112181018518039*fq[1]-0.03195113136573774*fq[0]; 
  if(linc2 == 2) f_lte_d[2] = 0.03195113136573774*fq[80]+0.05112181018518039*fq[79]+0.03195113136573774*fq[78]+0.05112181018518039*fq[77]+0.08179489629628862*fq[76]+0.05112181018518039*fq[75]+0.03195113136573774*fq[74]+0.05112181018518039*fq[73]+0.03195113136573774*fq[72]-0.03195113136573774*fq[62]-0.05112181018518039*fq[61]-0.03195113136573774*fq[60]-0.05112181018518039*fq[59]-0.08179489629628862*fq[58]-0.05112181018518039*fq[57]-0.03195113136573774*fq[56]-0.05112181018518039*fq[55]-0.03195113136573774*fq[54]+0.05112181018518039*fq[53]+0.08179489629628862*fq[52]+0.05112181018518039*fq[51]+0.08179489629628862*fq[50]+0.1308718340740618*fq[49]+0.08179489629628862*fq[48]+0.05112181018518039*fq[47]+0.08179489629628862*fq[46]+0.05112181018518039*fq[45]-0.05112181018518039*fq[35]-0.08179489629628862*fq[34]-0.05112181018518039*fq[33]-0.08179489629628862*fq[32]-0.1308718340740618*fq[31]-0.08179489629628862*fq[30]-0.05112181018518039*fq[29]-0.08179489629628862*fq[28]-0.05112181018518039*fq[27]+0.03195113136573774*fq[26]+0.05112181018518039*fq[25]+0.03195113136573774*fq[24]+0.05112181018518039*fq[23]+0.08179489629628862*fq[22]+0.05112181018518039*fq[21]+0.03195113136573774*fq[20]+0.05112181018518039*fq[19]+0.03195113136573774*fq[18]-0.03195113136573774*fq[8]-0.05112181018518039*fq[7]-0.03195113136573774*fq[6]-0.05112181018518039*fq[5]-0.08179489629628862*fq[4]-0.05112181018518039*fq[3]-0.03195113136573774*fq[2]-0.05112181018518039*fq[1]-0.03195113136573774*fq[0]; 
  if(linc2 == 3) f_lte_d[3] = 0.03195113136573774*fq[80]+0.05112181018518039*fq[79]+0.03195113136573774*fq[78]-0.03195113136573774*fq[74]-0.05112181018518039*fq[73]-0.03195113136573774*fq[72]+0.05112181018518039*fq[71]+0.08179489629628862*fq[70]+0.05112181018518039*fq[69]-0.05112181018518039*fq[65]-0.08179489629628862*fq[64]-0.05112181018518039*fq[63]+0.03195113136573774*fq[62]+0.05112181018518039*fq[61]+0.03195113136573774*fq[60]-0.03195113136573774*fq[56]-0.05112181018518039*fq[55]-0.03195113136573774*fq[54]+0.05112181018518039*fq[53]+0.08179489629628862*fq[52]+0.05112181018518039*fq[51]-0.05112181018518039*fq[47]-0.08179489629628862*fq[46]-0.05112181018518039*fq[45]+0.08179489629628862*fq[44]+0.1308718340740618*fq[43]+0.08179489629628862*fq[42]-0.08179489629628862*fq[38]-0.1308718340740618*fq[37]-0.08179489629628862*fq[36]+0.05112181018518039*fq[35]+0.08179489629628862*fq[34]+0.05112181018518039*fq[33]-0.05112181018518039*fq[29]-0.08179489629628862*fq[28]-0.05112181018518039*fq[27]+0.03195113136573774*fq[26]+0.05112181018518039*fq[25]+0.03195113136573774*fq[24]-0.03195113136573774*fq[20]-0.05112181018518039*fq[19]-0.03195113136573774*fq[18]+0.05112181018518039*fq[17]+0.08179489629628862*fq[16]+0.05112181018518039*fq[15]-0.05112181018518039*fq[11]-0.08179489629628862*fq[10]-0.05112181018518039*fq[9]+0.03195113136573774*fq[8]+0.05112181018518039*fq[7]+0.03195113136573774*fq[6]-0.03195113136573774*fq[2]-0.05112181018518039*fq[1]-0.03195113136573774*fq[0]; 
  if(linc2 == 4) f_lte_d[4] = 0.03195113136573774*fq[80]-0.03195113136573774*fq[78]+0.05112181018518039*fq[77]-0.05112181018518039*fq[75]+0.03195113136573774*fq[74]-0.03195113136573774*fq[72]+0.05112181018518039*fq[71]-0.05112181018518039*fq[69]+0.08179489629628862*fq[68]-0.08179489629628862*fq[66]+0.05112181018518039*fq[65]-0.05112181018518039*fq[63]+0.03195113136573774*fq[62]-0.03195113136573774*fq[60]+0.05112181018518039*fq[59]-0.05112181018518039*fq[57]+0.03195113136573774*fq[56]-0.03195113136573774*fq[54]+0.05112181018518039*fq[53]-0.05112181018518039*fq[51]+0.08179489629628862*fq[50]-0.08179489629628862*fq[48]+0.05112181018518039*fq[47]-0.05112181018518039*fq[45]+0.08179489629628862*fq[44]-0.08179489629628862*fq[42]+0.1308718340740618*fq[41]-0.1308718340740618*fq[39]+0.08179489629628862*fq[38]-0.08179489629628862*fq[36]+0.05112181018518039*fq[35]-0.05112181018518039*fq[33]+0.08179489629628862*fq[32]-0.08179489629628862*fq[30]+0.05112181018518039*fq[29]-0.05112181018518039*fq[27]+0.03195113136573774*fq[26]-0.03195113136573774*fq[24]+0.05112181018518039*fq[23]-0.05112181018518039*fq[21]+0.03195113136573774*fq[20]-0.03195113136573774*fq[18]+0.05112181018518039*fq[17]-0.05112181018518039*fq[15]+0.08179489629628862*fq[14]-0.08179489629628862*fq[12]+0.05112181018518039*fq[11]-0.05112181018518039*fq[9]+0.03195113136573774*fq[8]-0.03195113136573774*fq[6]+0.05112181018518039*fq[5]-0.05112181018518039*fq[3]+0.03195113136573774*fq[2]-0.03195113136573774*fq[0]; 
  if(linc2 == 5) f_lte_d[5] = 0.04286694101508916*fq[80]+0.06858710562414266*fq[79]+0.04286694101508916*fq[78]+0.06858710562414266*fq[77]+0.1097393689986283*fq[76]+0.06858710562414266*fq[75]+0.04286694101508916*fq[74]+0.06858710562414266*fq[73]+0.04286694101508916*fq[72]-0.04286694101508916*fq[62]-0.06858710562414266*fq[61]-0.04286694101508916*fq[60]-0.06858710562414266*fq[59]-0.1097393689986283*fq[58]-0.06858710562414266*fq[57]-0.04286694101508916*fq[56]-0.06858710562414266*fq[55]-0.04286694101508916*fq[54]-0.04286694101508916*fq[26]-0.06858710562414266*fq[25]-0.04286694101508916*fq[24]-0.06858710562414266*fq[23]-0.1097393689986283*fq[22]-0.06858710562414266*fq[21]-0.04286694101508916*fq[20]-0.06858710562414266*fq[19]-0.04286694101508916*fq[18]+0.04286694101508916*fq[8]+0.06858710562414266*fq[7]+0.04286694101508916*fq[6]+0.06858710562414266*fq[5]+0.1097393689986283*fq[4]+0.06858710562414266*fq[3]+0.04286694101508916*fq[2]+0.06858710562414266*fq[1]+0.04286694101508916*fq[0]; 
  if(linc2 == 6) f_lte_d[6] = 0.04286694101508916*fq[80]+0.06858710562414266*fq[79]+0.04286694101508916*fq[78]-0.04286694101508916*fq[74]-0.06858710562414266*fq[73]-0.04286694101508916*fq[72]+0.06858710562414266*fq[71]+0.1097393689986283*fq[70]+0.06858710562414266*fq[69]-0.06858710562414266*fq[65]-0.1097393689986283*fq[64]-0.06858710562414266*fq[63]+0.04286694101508916*fq[62]+0.06858710562414266*fq[61]+0.04286694101508916*fq[60]-0.04286694101508916*fq[56]-0.06858710562414266*fq[55]-0.04286694101508916*fq[54]-0.04286694101508916*fq[26]-0.06858710562414266*fq[25]-0.04286694101508916*fq[24]+0.04286694101508916*fq[20]+0.06858710562414266*fq[19]+0.04286694101508916*fq[18]-0.06858710562414266*fq[17]-0.1097393689986283*fq[16]-0.06858710562414266*fq[15]+0.06858710562414266*fq[11]+0.1097393689986283*fq[10]+0.06858710562414266*fq[9]-0.04286694101508916*fq[8]-0.06858710562414266*fq[7]-0.04286694101508916*fq[6]+0.04286694101508916*fq[2]+0.06858710562414266*fq[1]+0.04286694101508916*fq[0]; 
  if(linc2 == 7) f_lte_d[7] = 0.04286694101508916*fq[80]+0.06858710562414266*fq[79]+0.04286694101508916*fq[78]-0.04286694101508916*fq[74]-0.06858710562414266*fq[73]-0.04286694101508916*fq[72]-0.04286694101508916*fq[62]-0.06858710562414266*fq[61]-0.04286694101508916*fq[60]+0.04286694101508916*fq[56]+0.06858710562414266*fq[55]+0.04286694101508916*fq[54]+0.06858710562414266*fq[53]+0.1097393689986283*fq[52]+0.06858710562414266*fq[51]-0.06858710562414266*fq[47]-0.1097393689986283*fq[46]-0.06858710562414266*fq[45]-0.06858710562414266*fq[35]-0.1097393689986283*fq[34]-0.06858710562414266*fq[33]+0.06858710562414266*fq[29]+0.1097393689986283*fq[28]+0.06858710562414266*fq[27]+0.04286694101508916*fq[26]+0.06858710562414266*fq[25]+0.04286694101508916*fq[24]-0.04286694101508916*fq[20]-0.06858710562414266*fq[19]-0.04286694101508916*fq[18]-0.04286694101508916*fq[8]-0.06858710562414266*fq[7]-0.04286694101508916*fq[6]+0.04286694101508916*fq[2]+0.06858710562414266*fq[1]+0.04286694101508916*fq[0]; 
  if(linc2 == 8) f_lte_d[8] = 0.04286694101508916*fq[80]-0.04286694101508916*fq[78]+0.06858710562414266*fq[77]-0.06858710562414266*fq[75]+0.04286694101508916*fq[74]-0.04286694101508916*fq[72]+0.06858710562414266*fq[71]-0.06858710562414266*fq[69]+0.1097393689986283*fq[68]-0.1097393689986283*fq[66]+0.06858710562414266*fq[65]-0.06858710562414266*fq[63]+0.04286694101508916*fq[62]-0.04286694101508916*fq[60]+0.06858710562414266*fq[59]-0.06858710562414266*fq[57]+0.04286694101508916*fq[56]-0.04286694101508916*fq[54]-0.04286694101508916*fq[26]+0.04286694101508916*fq[24]-0.06858710562414266*fq[23]+0.06858710562414266*fq[21]-0.04286694101508916*fq[20]+0.04286694101508916*fq[18]-0.06858710562414266*fq[17]+0.06858710562414266*fq[15]-0.1097393689986283*fq[14]+0.1097393689986283*fq[12]-0.06858710562414266*fq[11]+0.06858710562414266*fq[9]-0.04286694101508916*fq[8]+0.04286694101508916*fq[6]-0.06858710562414266*fq[5]+0.06858710562414266*fq[3]-0.04286694101508916*fq[2]+0.04286694101508916*fq[0]; 
  if(linc2 == 9) f_lte_d[9] = 0.04286694101508916*fq[80]-0.04286694101508916*fq[78]+0.06858710562414266*fq[77]-0.06858710562414266*fq[75]+0.04286694101508916*fq[74]-0.04286694101508916*fq[72]-0.04286694101508916*fq[62]+0.04286694101508916*fq[60]-0.06858710562414266*fq[59]+0.06858710562414266*fq[57]-0.04286694101508916*fq[56]+0.04286694101508916*fq[54]+0.06858710562414266*fq[53]-0.06858710562414266*fq[51]+0.1097393689986283*fq[50]-0.1097393689986283*fq[48]+0.06858710562414266*fq[47]-0.06858710562414266*fq[45]-0.06858710562414266*fq[35]+0.06858710562414266*fq[33]-0.1097393689986283*fq[32]+0.1097393689986283*fq[30]-0.06858710562414266*fq[29]+0.06858710562414266*fq[27]+0.04286694101508916*fq[26]-0.04286694101508916*fq[24]+0.06858710562414266*fq[23]-0.06858710562414266*fq[21]+0.04286694101508916*fq[20]-0.04286694101508916*fq[18]-0.04286694101508916*fq[8]+0.04286694101508916*fq[6]-0.06858710562414266*fq[5]+0.06858710562414266*fq[3]-0.04286694101508916*fq[2]+0.04286694101508916*fq[0]; 
  if(linc2 == 10) f_lte_d[10] = 0.04286694101508916*fq[80]-0.04286694101508916*fq[78]-0.04286694101508916*fq[74]+0.04286694101508916*fq[72]+0.06858710562414266*fq[71]-0.06858710562414266*fq[69]-0.06858710562414266*fq[65]+0.06858710562414266*fq[63]+0.04286694101508916*fq[62]-0.04286694101508916*fq[60]-0.04286694101508916*fq[56]+0.04286694101508916*fq[54]+0.06858710562414266*fq[53]-0.06858710562414266*fq[51]-0.06858710562414266*fq[47]+0.06858710562414266*fq[45]+0.1097393689986283*fq[44]-0.1097393689986283*fq[42]-0.1097393689986283*fq[38]+0.1097393689986283*fq[36]+0.06858710562414266*fq[35]-0.06858710562414266*fq[33]-0.06858710562414266*fq[29]+0.06858710562414266*fq[27]+0.04286694101508916*fq[26]-0.04286694101508916*fq[24]-0.04286694101508916*fq[20]+0.04286694101508916*fq[18]+0.06858710562414266*fq[17]-0.06858710562414266*fq[15]-0.06858710562414266*fq[11]+0.06858710562414266*fq[9]+0.04286694101508916*fq[8]-0.04286694101508916*fq[6]-0.04286694101508916*fq[2]+0.04286694101508916*fq[0]; 
  if(linc2 == 11) f_lte_d[11] = 0.02130075424382516*fq[80]+0.03408120679012026*fq[79]+0.02130075424382516*fq[78]+0.03408120679012026*fq[77]+0.05452993086419242*fq[76]+0.03408120679012026*fq[75]+0.02130075424382516*fq[74]+0.03408120679012026*fq[73]+0.02130075424382516*fq[72]+0.03408120679012026*fq[71]+0.05452993086419242*fq[70]+0.03408120679012026*fq[69]+0.05452993086419242*fq[68]+0.08724788938270785*fq[67]+0.05452993086419242*fq[66]+0.03408120679012026*fq[65]+0.05452993086419242*fq[64]+0.03408120679012026*fq[63]+0.02130075424382516*fq[62]+0.03408120679012026*fq[61]+0.02130075424382516*fq[60]+0.03408120679012026*fq[59]+0.05452993086419242*fq[58]+0.03408120679012026*fq[57]+0.02130075424382516*fq[56]+0.03408120679012026*fq[55]+0.02130075424382516*fq[54]-0.04260150848765033*fq[53]-0.06816241358024053*fq[52]-0.04260150848765033*fq[51]-0.06816241358024053*fq[50]-0.1090598617283848*fq[49]-0.06816241358024053*fq[48]-0.04260150848765033*fq[47]-0.06816241358024053*fq[46]-0.04260150848765033*fq[45]-0.06816241358024053*fq[44]-0.1090598617283848*fq[43]-0.06816241358024053*fq[42]-0.1090598617283848*fq[41]-0.1744957787654157*fq[40]-0.1090598617283848*fq[39]-0.06816241358024053*fq[38]-0.1090598617283848*fq[37]-0.06816241358024053*fq[36]-0.04260150848765033*fq[35]-0.06816241358024053*fq[34]-0.04260150848765033*fq[33]-0.06816241358024053*fq[32]-0.1090598617283848*fq[31]-0.06816241358024053*fq[30]-0.04260150848765033*fq[29]-0.06816241358024053*fq[28]-0.04260150848765033*fq[27]+0.02130075424382516*fq[26]+0.03408120679012026*fq[25]+0.02130075424382516*fq[24]+0.03408120679012026*fq[23]+0.05452993086419242*fq[22]+0.03408120679012026*fq[21]+0.02130075424382516*fq[20]+0.03408120679012026*fq[19]+0.02130075424382516*fq[18]+0.03408120679012026*fq[17]+0.05452993086419242*fq[16]+0.03408120679012026*fq[15]+0.05452993086419242*fq[14]+0.08724788938270785*fq[13]+0.05452993086419242*fq[12]+0.03408120679012026*fq[11]+0.05452993086419242*fq[10]+0.03408120679012026*fq[9]+0.02130075424382516*fq[8]+0.03408120679012026*fq[7]+0.02130075424382516*fq[6]+0.03408120679012026*fq[5]+0.05452993086419242*fq[4]+0.03408120679012026*fq[3]+0.02130075424382516*fq[2]+0.03408120679012026*fq[1]+0.02130075424382516*fq[0]; 
  if(linc2 == 12) f_lte_d[12] = 0.02130075424382516*fq[80]+0.03408120679012026*fq[79]+0.02130075424382516*fq[78]+0.03408120679012026*fq[77]+0.05452993086419242*fq[76]+0.03408120679012026*fq[75]+0.02130075424382516*fq[74]+0.03408120679012026*fq[73]+0.02130075424382516*fq[72]-0.04260150848765033*fq[71]-0.06816241358024053*fq[70]-0.04260150848765033*fq[69]-0.06816241358024053*fq[68]-0.1090598617283848*fq[67]-0.06816241358024053*fq[66]-0.04260150848765033*fq[65]-0.06816241358024053*fq[64]-0.04260150848765033*fq[63]+0.02130075424382516*fq[62]+0.03408120679012026*fq[61]+0.02130075424382516*fq[60]+0.03408120679012026*fq[59]+0.05452993086419242*fq[58]+0.03408120679012026*fq[57]+0.02130075424382516*fq[56]+0.03408120679012026*fq[55]+0.02130075424382516*fq[54]+0.03408120679012026*fq[53]+0.05452993086419242*fq[52]+0.03408120679012026*fq[51]+0.05452993086419242*fq[50]+0.08724788938270785*fq[49]+0.05452993086419242*fq[48]+0.03408120679012026*fq[47]+0.05452993086419242*fq[46]+0.03408120679012026*fq[45]-0.06816241358024053*fq[44]-0.1090598617283848*fq[43]-0.06816241358024053*fq[42]-0.1090598617283848*fq[41]-0.1744957787654157*fq[40]-0.1090598617283848*fq[39]-0.06816241358024053*fq[38]-0.1090598617283848*fq[37]-0.06816241358024053*fq[36]+0.03408120679012026*fq[35]+0.05452993086419242*fq[34]+0.03408120679012026*fq[33]+0.05452993086419242*fq[32]+0.08724788938270785*fq[31]+0.05452993086419242*fq[30]+0.03408120679012026*fq[29]+0.05452993086419242*fq[28]+0.03408120679012026*fq[27]+0.02130075424382516*fq[26]+0.03408120679012026*fq[25]+0.02130075424382516*fq[24]+0.03408120679012026*fq[23]+0.05452993086419242*fq[22]+0.03408120679012026*fq[21]+0.02130075424382516*fq[20]+0.03408120679012026*fq[19]+0.02130075424382516*fq[18]-0.04260150848765033*fq[17]-0.06816241358024053*fq[16]-0.04260150848765033*fq[15]-0.06816241358024053*fq[14]-0.1090598617283848*fq[13]-0.06816241358024053*fq[12]-0.04260150848765033*fq[11]-0.06816241358024053*fq[10]-0.04260150848765033*fq[9]+0.02130075424382516*fq[8]+0.03408120679012026*fq[7]+0.02130075424382516*fq[6]+0.03408120679012026*fq[5]+0.05452993086419242*fq[4]+0.03408120679012026*fq[3]+0.02130075424382516*fq[2]+0.03408120679012026*fq[1]+0.02130075424382516*fq[0]; 
  if(linc2 == 13) f_lte_d[13] = 0.02130075424382516*fq[80]+0.03408120679012026*fq[79]+0.02130075424382516*fq[78]-0.04260150848765033*fq[77]-0.06816241358024053*fq[76]-0.04260150848765033*fq[75]+0.02130075424382516*fq[74]+0.03408120679012026*fq[73]+0.02130075424382516*fq[72]+0.03408120679012026*fq[71]+0.05452993086419242*fq[70]+0.03408120679012026*fq[69]-0.06816241358024053*fq[68]-0.1090598617283848*fq[67]-0.06816241358024053*fq[66]+0.03408120679012026*fq[65]+0.05452993086419242*fq[64]+0.03408120679012026*fq[63]+0.02130075424382516*fq[62]+0.03408120679012026*fq[61]+0.02130075424382516*fq[60]-0.04260150848765033*fq[59]-0.06816241358024053*fq[58]-0.04260150848765033*fq[57]+0.02130075424382516*fq[56]+0.03408120679012026*fq[55]+0.02130075424382516*fq[54]+0.03408120679012026*fq[53]+0.05452993086419242*fq[52]+0.03408120679012026*fq[51]-0.06816241358024053*fq[50]-0.1090598617283848*fq[49]-0.06816241358024053*fq[48]+0.03408120679012026*fq[47]+0.05452993086419242*fq[46]+0.03408120679012026*fq[45]+0.05452993086419242*fq[44]+0.08724788938270785*fq[43]+0.05452993086419242*fq[42]-0.1090598617283848*fq[41]-0.1744957787654157*fq[40]-0.1090598617283848*fq[39]+0.05452993086419242*fq[38]+0.08724788938270785*fq[37]+0.05452993086419242*fq[36]+0.03408120679012026*fq[35]+0.05452993086419242*fq[34]+0.03408120679012026*fq[33]-0.06816241358024053*fq[32]-0.1090598617283848*fq[31]-0.06816241358024053*fq[30]+0.03408120679012026*fq[29]+0.05452993086419242*fq[28]+0.03408120679012026*fq[27]+0.02130075424382516*fq[26]+0.03408120679012026*fq[25]+0.02130075424382516*fq[24]-0.04260150848765033*fq[23]-0.06816241358024053*fq[22]-0.04260150848765033*fq[21]+0.02130075424382516*fq[20]+0.03408120679012026*fq[19]+0.02130075424382516*fq[18]+0.03408120679012026*fq[17]+0.05452993086419242*fq[16]+0.03408120679012026*fq[15]-0.06816241358024053*fq[14]-0.1090598617283848*fq[13]-0.06816241358024053*fq[12]+0.03408120679012026*fq[11]+0.05452993086419242*fq[10]+0.03408120679012026*fq[9]+0.02130075424382516*fq[8]+0.03408120679012026*fq[7]+0.02130075424382516*fq[6]-0.04260150848765033*fq[5]-0.06816241358024053*fq[4]-0.04260150848765033*fq[3]+0.02130075424382516*fq[2]+0.03408120679012026*fq[1]+0.02130075424382516*fq[0]; 
  if(linc2 == 14) f_lte_d[14] = 0.02130075424382516*fq[80]-0.04260150848765033*fq[79]+0.02130075424382516*fq[78]+0.03408120679012026*fq[77]-0.06816241358024053*fq[76]+0.03408120679012026*fq[75]+0.02130075424382516*fq[74]-0.04260150848765033*fq[73]+0.02130075424382516*fq[72]+0.03408120679012026*fq[71]-0.06816241358024053*fq[70]+0.03408120679012026*fq[69]+0.05452993086419242*fq[68]-0.1090598617283848*fq[67]+0.05452993086419242*fq[66]+0.03408120679012026*fq[65]-0.06816241358024053*fq[64]+0.03408120679012026*fq[63]+0.02130075424382516*fq[62]-0.04260150848765033*fq[61]+0.02130075424382516*fq[60]+0.03408120679012026*fq[59]-0.06816241358024053*fq[58]+0.03408120679012026*fq[57]+0.02130075424382516*fq[56]-0.04260150848765033*fq[55]+0.02130075424382516*fq[54]+0.03408120679012026*fq[53]-0.06816241358024053*fq[52]+0.03408120679012026*fq[51]+0.05452993086419242*fq[50]-0.1090598617283848*fq[49]+0.05452993086419242*fq[48]+0.03408120679012026*fq[47]-0.06816241358024053*fq[46]+0.03408120679012026*fq[45]+0.05452993086419242*fq[44]-0.1090598617283848*fq[43]+0.05452993086419242*fq[42]+0.08724788938270785*fq[41]-0.1744957787654157*fq[40]+0.08724788938270785*fq[39]+0.05452993086419242*fq[38]-0.1090598617283848*fq[37]+0.05452993086419242*fq[36]+0.03408120679012026*fq[35]-0.06816241358024053*fq[34]+0.03408120679012026*fq[33]+0.05452993086419242*fq[32]-0.1090598617283848*fq[31]+0.05452993086419242*fq[30]+0.03408120679012026*fq[29]-0.06816241358024053*fq[28]+0.03408120679012026*fq[27]+0.02130075424382516*fq[26]-0.04260150848765033*fq[25]+0.02130075424382516*fq[24]+0.03408120679012026*fq[23]-0.06816241358024053*fq[22]+0.03408120679012026*fq[21]+0.02130075424382516*fq[20]-0.04260150848765033*fq[19]+0.02130075424382516*fq[18]+0.03408120679012026*fq[17]-0.06816241358024053*fq[16]+0.03408120679012026*fq[15]+0.05452993086419242*fq[14]-0.1090598617283848*fq[13]+0.05452993086419242*fq[12]+0.03408120679012026*fq[11]-0.06816241358024053*fq[10]+0.03408120679012026*fq[9]+0.02130075424382516*fq[8]-0.04260150848765033*fq[7]+0.02130075424382516*fq[6]+0.03408120679012026*fq[5]-0.06816241358024053*fq[4]+0.03408120679012026*fq[3]+0.02130075424382516*fq[2]-0.04260150848765033*fq[1]+0.02130075424382516*fq[0]; 
  if(linc2 == 15) f_lte_d[15] = 0.05751203645832794*fq[80]+0.09201925833332471*fq[79]+0.05751203645832794*fq[78]-0.05751203645832794*fq[74]-0.09201925833332471*fq[73]-0.05751203645832794*fq[72]-0.05751203645832794*fq[62]-0.09201925833332471*fq[61]-0.05751203645832794*fq[60]+0.05751203645832794*fq[56]+0.09201925833332471*fq[55]+0.05751203645832794*fq[54]-0.05751203645832794*fq[26]-0.09201925833332471*fq[25]-0.05751203645832794*fq[24]+0.05751203645832794*fq[20]+0.09201925833332471*fq[19]+0.05751203645832794*fq[18]+0.05751203645832794*fq[8]+0.09201925833332471*fq[7]+0.05751203645832794*fq[6]-0.05751203645832794*fq[2]-0.09201925833332471*fq[1]-0.05751203645832794*fq[0]; 
  if(linc2 == 16) f_lte_d[16] = 0.05751203645832794*fq[80]-0.05751203645832794*fq[78]+0.09201925833332471*fq[77]-0.09201925833332471*fq[75]+0.05751203645832794*fq[74]-0.05751203645832794*fq[72]-0.05751203645832794*fq[62]+0.05751203645832794*fq[60]-0.09201925833332471*fq[59]+0.09201925833332471*fq[57]-0.05751203645832794*fq[56]+0.05751203645832794*fq[54]-0.05751203645832794*fq[26]+0.05751203645832794*fq[24]-0.09201925833332471*fq[23]+0.09201925833332471*fq[21]-0.05751203645832794*fq[20]+0.05751203645832794*fq[18]+0.05751203645832794*fq[8]-0.05751203645832794*fq[6]+0.09201925833332471*fq[5]-0.09201925833332471*fq[3]+0.05751203645832794*fq[2]-0.05751203645832794*fq[0]; 
  if(linc2 == 17) f_lte_d[17] = 0.05751203645832794*fq[80]-0.05751203645832794*fq[78]-0.05751203645832794*fq[74]+0.05751203645832794*fq[72]+0.09201925833332471*fq[71]-0.09201925833332471*fq[69]-0.09201925833332471*fq[65]+0.09201925833332471*fq[63]+0.05751203645832794*fq[62]-0.05751203645832794*fq[60]-0.05751203645832794*fq[56]+0.05751203645832794*fq[54]-0.05751203645832794*fq[26]+0.05751203645832794*fq[24]+0.05751203645832794*fq[20]-0.05751203645832794*fq[18]-0.09201925833332471*fq[17]+0.09201925833332471*fq[15]+0.09201925833332471*fq[11]-0.09201925833332471*fq[9]-0.05751203645832794*fq[8]+0.05751203645832794*fq[6]+0.05751203645832794*fq[2]-0.05751203645832794*fq[0]; 
  if(linc2 == 18) f_lte_d[18] = 0.05751203645832794*fq[80]-0.05751203645832794*fq[78]-0.05751203645832794*fq[74]+0.05751203645832794*fq[72]-0.05751203645832794*fq[62]+0.05751203645832794*fq[60]+0.05751203645832794*fq[56]-0.05751203645832794*fq[54]+0.09201925833332471*fq[53]-0.09201925833332471*fq[51]-0.09201925833332471*fq[47]+0.09201925833332471*fq[45]-0.09201925833332471*fq[35]+0.09201925833332471*fq[33]+0.09201925833332471*fq[29]-0.09201925833332471*fq[27]+0.05751203645832794*fq[26]-0.05751203645832794*fq[24]-0.05751203645832794*fq[20]+0.05751203645832794*fq[18]-0.05751203645832794*fq[8]+0.05751203645832794*fq[6]+0.05751203645832794*fq[2]-0.05751203645832794*fq[0]; 
  if(linc2 == 19) f_lte_d[19] = 0.02857796067672614*fq[80]+0.04572473708276183*fq[79]+0.02857796067672614*fq[78]+0.04572473708276183*fq[77]+0.0731595793324189*fq[76]+0.04572473708276183*fq[75]+0.02857796067672614*fq[74]+0.04572473708276183*fq[73]+0.02857796067672614*fq[72]-0.02857796067672614*fq[62]-0.04572473708276183*fq[61]-0.02857796067672614*fq[60]-0.04572473708276183*fq[59]-0.0731595793324189*fq[58]-0.04572473708276183*fq[57]-0.02857796067672614*fq[56]-0.04572473708276183*fq[55]-0.02857796067672614*fq[54]-0.05715592135345229*fq[53]-0.09144947416552365*fq[52]-0.05715592135345229*fq[51]-0.09144947416552365*fq[50]-0.1463191586648378*fq[49]-0.09144947416552365*fq[48]-0.05715592135345229*fq[47]-0.09144947416552365*fq[46]-0.05715592135345229*fq[45]+0.05715592135345229*fq[35]+0.09144947416552365*fq[34]+0.05715592135345229*fq[33]+0.09144947416552365*fq[32]+0.1463191586648378*fq[31]+0.09144947416552365*fq[30]+0.05715592135345229*fq[29]+0.09144947416552365*fq[28]+0.05715592135345229*fq[27]+0.02857796067672614*fq[26]+0.04572473708276183*fq[25]+0.02857796067672614*fq[24]+0.04572473708276183*fq[23]+0.0731595793324189*fq[22]+0.04572473708276183*fq[21]+0.02857796067672614*fq[20]+0.04572473708276183*fq[19]+0.02857796067672614*fq[18]-0.02857796067672614*fq[8]-0.04572473708276183*fq[7]-0.02857796067672614*fq[6]-0.04572473708276183*fq[5]-0.0731595793324189*fq[4]-0.04572473708276183*fq[3]-0.02857796067672614*fq[2]-0.04572473708276183*fq[1]-0.02857796067672614*fq[0]; 
  if(linc2 == 20) f_lte_d[20] = 0.02857796067672614*fq[80]+0.04572473708276183*fq[79]+0.02857796067672614*fq[78]+0.04572473708276183*fq[77]+0.0731595793324189*fq[76]+0.04572473708276183*fq[75]+0.02857796067672614*fq[74]+0.04572473708276183*fq[73]+0.02857796067672614*fq[72]-0.05715592135345229*fq[71]-0.09144947416552365*fq[70]-0.05715592135345229*fq[69]-0.09144947416552365*fq[68]-0.1463191586648378*fq[67]-0.09144947416552365*fq[66]-0.05715592135345229*fq[65]-0.09144947416552365*fq[64]-0.05715592135345229*fq[63]+0.02857796067672614*fq[62]+0.04572473708276183*fq[61]+0.02857796067672614*fq[60]+0.04572473708276183*fq[59]+0.0731595793324189*fq[58]+0.04572473708276183*fq[57]+0.02857796067672614*fq[56]+0.04572473708276183*fq[55]+0.02857796067672614*fq[54]-0.02857796067672614*fq[26]-0.04572473708276183*fq[25]-0.02857796067672614*fq[24]-0.04572473708276183*fq[23]-0.0731595793324189*fq[22]-0.04572473708276183*fq[21]-0.02857796067672614*fq[20]-0.04572473708276183*fq[19]-0.02857796067672614*fq[18]+0.05715592135345229*fq[17]+0.09144947416552365*fq[16]+0.05715592135345229*fq[15]+0.09144947416552365*fq[14]+0.1463191586648378*fq[13]+0.09144947416552365*fq[12]+0.05715592135345229*fq[11]+0.09144947416552365*fq[10]+0.05715592135345229*fq[9]-0.02857796067672614*fq[8]-0.04572473708276183*fq[7]-0.02857796067672614*fq[6]-0.04572473708276183*fq[5]-0.0731595793324189*fq[4]-0.04572473708276183*fq[3]-0.02857796067672614*fq[2]-0.04572473708276183*fq[1]-0.02857796067672614*fq[0]; 
  if(linc2 == 21) f_lte_d[21] = 0.02857796067672614*fq[80]+0.04572473708276183*fq[79]+0.02857796067672614*fq[78]-0.02857796067672614*fq[74]-0.04572473708276183*fq[73]-0.02857796067672614*fq[72]+0.04572473708276183*fq[71]+0.0731595793324189*fq[70]+0.04572473708276183*fq[69]-0.04572473708276183*fq[65]-0.0731595793324189*fq[64]-0.04572473708276183*fq[63]+0.02857796067672614*fq[62]+0.04572473708276183*fq[61]+0.02857796067672614*fq[60]-0.02857796067672614*fq[56]-0.04572473708276183*fq[55]-0.02857796067672614*fq[54]-0.05715592135345229*fq[53]-0.09144947416552365*fq[52]-0.05715592135345229*fq[51]+0.05715592135345229*fq[47]+0.09144947416552365*fq[46]+0.05715592135345229*fq[45]-0.09144947416552365*fq[44]-0.1463191586648378*fq[43]-0.09144947416552365*fq[42]+0.09144947416552365*fq[38]+0.1463191586648378*fq[37]+0.09144947416552365*fq[36]-0.05715592135345229*fq[35]-0.09144947416552365*fq[34]-0.05715592135345229*fq[33]+0.05715592135345229*fq[29]+0.09144947416552365*fq[28]+0.05715592135345229*fq[27]+0.02857796067672614*fq[26]+0.04572473708276183*fq[25]+0.02857796067672614*fq[24]-0.02857796067672614*fq[20]-0.04572473708276183*fq[19]-0.02857796067672614*fq[18]+0.04572473708276183*fq[17]+0.0731595793324189*fq[16]+0.04572473708276183*fq[15]-0.04572473708276183*fq[11]-0.0731595793324189*fq[10]-0.04572473708276183*fq[9]+0.02857796067672614*fq[8]+0.04572473708276183*fq[7]+0.02857796067672614*fq[6]-0.02857796067672614*fq[2]-0.04572473708276183*fq[1]-0.02857796067672614*fq[0]; 
  if(linc2 == 22) f_lte_d[22] = 0.02857796067672614*fq[80]+0.04572473708276183*fq[79]+0.02857796067672614*fq[78]-0.02857796067672614*fq[74]-0.04572473708276183*fq[73]-0.02857796067672614*fq[72]-0.05715592135345229*fq[71]-0.09144947416552365*fq[70]-0.05715592135345229*fq[69]+0.05715592135345229*fq[65]+0.09144947416552365*fq[64]+0.05715592135345229*fq[63]+0.02857796067672614*fq[62]+0.04572473708276183*fq[61]+0.02857796067672614*fq[60]-0.02857796067672614*fq[56]-0.04572473708276183*fq[55]-0.02857796067672614*fq[54]+0.04572473708276183*fq[53]+0.0731595793324189*fq[52]+0.04572473708276183*fq[51]-0.04572473708276183*fq[47]-0.0731595793324189*fq[46]-0.04572473708276183*fq[45]-0.09144947416552365*fq[44]-0.1463191586648378*fq[43]-0.09144947416552365*fq[42]+0.09144947416552365*fq[38]+0.1463191586648378*fq[37]+0.09144947416552365*fq[36]+0.04572473708276183*fq[35]+0.0731595793324189*fq[34]+0.04572473708276183*fq[33]-0.04572473708276183*fq[29]-0.0731595793324189*fq[28]-0.04572473708276183*fq[27]+0.02857796067672614*fq[26]+0.04572473708276183*fq[25]+0.02857796067672614*fq[24]-0.02857796067672614*fq[20]-0.04572473708276183*fq[19]-0.02857796067672614*fq[18]-0.05715592135345229*fq[17]-0.09144947416552365*fq[16]-0.05715592135345229*fq[15]+0.05715592135345229*fq[11]+0.09144947416552365*fq[10]+0.05715592135345229*fq[9]+0.02857796067672614*fq[8]+0.04572473708276183*fq[7]+0.02857796067672614*fq[6]-0.02857796067672614*fq[2]-0.04572473708276183*fq[1]-0.02857796067672614*fq[0]; 
  if(linc2 == 23) f_lte_d[23] = 0.02857796067672614*fq[80]+0.04572473708276183*fq[79]+0.02857796067672614*fq[78]-0.05715592135345229*fq[77]-0.09144947416552365*fq[76]-0.05715592135345229*fq[75]+0.02857796067672614*fq[74]+0.04572473708276183*fq[73]+0.02857796067672614*fq[72]+0.04572473708276183*fq[71]+0.0731595793324189*fq[70]+0.04572473708276183*fq[69]-0.09144947416552365*fq[68]-0.1463191586648378*fq[67]-0.09144947416552365*fq[66]+0.04572473708276183*fq[65]+0.0731595793324189*fq[64]+0.04572473708276183*fq[63]+0.02857796067672614*fq[62]+0.04572473708276183*fq[61]+0.02857796067672614*fq[60]-0.05715592135345229*fq[59]-0.09144947416552365*fq[58]-0.05715592135345229*fq[57]+0.02857796067672614*fq[56]+0.04572473708276183*fq[55]+0.02857796067672614*fq[54]-0.02857796067672614*fq[26]-0.04572473708276183*fq[25]-0.02857796067672614*fq[24]+0.05715592135345229*fq[23]+0.09144947416552365*fq[22]+0.05715592135345229*fq[21]-0.02857796067672614*fq[20]-0.04572473708276183*fq[19]-0.02857796067672614*fq[18]-0.04572473708276183*fq[17]-0.0731595793324189*fq[16]-0.04572473708276183*fq[15]+0.09144947416552365*fq[14]+0.1463191586648378*fq[13]+0.09144947416552365*fq[12]-0.04572473708276183*fq[11]-0.0731595793324189*fq[10]-0.04572473708276183*fq[9]-0.02857796067672614*fq[8]-0.04572473708276183*fq[7]-0.02857796067672614*fq[6]+0.05715592135345229*fq[5]+0.09144947416552365*fq[4]+0.05715592135345229*fq[3]-0.02857796067672614*fq[2]-0.04572473708276183*fq[1]-0.02857796067672614*fq[0]; 
  if(linc2 == 24) f_lte_d[24] = 0.02857796067672614*fq[80]+0.04572473708276183*fq[79]+0.02857796067672614*fq[78]-0.05715592135345229*fq[77]-0.09144947416552365*fq[76]-0.05715592135345229*fq[75]+0.02857796067672614*fq[74]+0.04572473708276183*fq[73]+0.02857796067672614*fq[72]-0.02857796067672614*fq[62]-0.04572473708276183*fq[61]-0.02857796067672614*fq[60]+0.05715592135345229*fq[59]+0.09144947416552365*fq[58]+0.05715592135345229*fq[57]-0.02857796067672614*fq[56]-0.04572473708276183*fq[55]-0.02857796067672614*fq[54]+0.04572473708276183*fq[53]+0.0731595793324189*fq[52]+0.04572473708276183*fq[51]-0.09144947416552365*fq[50]-0.1463191586648378*fq[49]-0.09144947416552365*fq[48]+0.04572473708276183*fq[47]+0.0731595793324189*fq[46]+0.04572473708276183*fq[45]-0.04572473708276183*fq[35]-0.0731595793324189*fq[34]-0.04572473708276183*fq[33]+0.09144947416552365*fq[32]+0.1463191586648378*fq[31]+0.09144947416552365*fq[30]-0.04572473708276183*fq[29]-0.0731595793324189*fq[28]-0.04572473708276183*fq[27]+0.02857796067672614*fq[26]+0.04572473708276183*fq[25]+0.02857796067672614*fq[24]-0.05715592135345229*fq[23]-0.09144947416552365*fq[22]-0.05715592135345229*fq[21]+0.02857796067672614*fq[20]+0.04572473708276183*fq[19]+0.02857796067672614*fq[18]-0.02857796067672614*fq[8]-0.04572473708276183*fq[7]-0.02857796067672614*fq[6]+0.05715592135345229*fq[5]+0.09144947416552365*fq[4]+0.05715592135345229*fq[3]-0.02857796067672614*fq[2]-0.04572473708276183*fq[1]-0.02857796067672614*fq[0]; 
  if(linc2 == 25) f_lte_d[25] = 0.02857796067672614*fq[80]-0.02857796067672614*fq[78]+0.04572473708276183*fq[77]-0.04572473708276183*fq[75]+0.02857796067672614*fq[74]-0.02857796067672614*fq[72]+0.04572473708276183*fq[71]-0.04572473708276183*fq[69]+0.0731595793324189*fq[68]-0.0731595793324189*fq[66]+0.04572473708276183*fq[65]-0.04572473708276183*fq[63]+0.02857796067672614*fq[62]-0.02857796067672614*fq[60]+0.04572473708276183*fq[59]-0.04572473708276183*fq[57]+0.02857796067672614*fq[56]-0.02857796067672614*fq[54]-0.05715592135345229*fq[53]+0.05715592135345229*fq[51]-0.09144947416552365*fq[50]+0.09144947416552365*fq[48]-0.05715592135345229*fq[47]+0.05715592135345229*fq[45]-0.09144947416552365*fq[44]+0.09144947416552365*fq[42]-0.1463191586648378*fq[41]+0.1463191586648378*fq[39]-0.09144947416552365*fq[38]+0.09144947416552365*fq[36]-0.05715592135345229*fq[35]+0.05715592135345229*fq[33]-0.09144947416552365*fq[32]+0.09144947416552365*fq[30]-0.05715592135345229*fq[29]+0.05715592135345229*fq[27]+0.02857796067672614*fq[26]-0.02857796067672614*fq[24]+0.04572473708276183*fq[23]-0.04572473708276183*fq[21]+0.02857796067672614*fq[20]-0.02857796067672614*fq[18]+0.04572473708276183*fq[17]-0.04572473708276183*fq[15]+0.0731595793324189*fq[14]-0.0731595793324189*fq[12]+0.04572473708276183*fq[11]-0.04572473708276183*fq[9]+0.02857796067672614*fq[8]-0.02857796067672614*fq[6]+0.04572473708276183*fq[5]-0.04572473708276183*fq[3]+0.02857796067672614*fq[2]-0.02857796067672614*fq[0]; 
  if(linc2 == 26) f_lte_d[26] = 0.02857796067672614*fq[80]-0.02857796067672614*fq[78]+0.04572473708276183*fq[77]-0.04572473708276183*fq[75]+0.02857796067672614*fq[74]-0.02857796067672614*fq[72]-0.05715592135345229*fq[71]+0.05715592135345229*fq[69]-0.09144947416552365*fq[68]+0.09144947416552365*fq[66]-0.05715592135345229*fq[65]+0.05715592135345229*fq[63]+0.02857796067672614*fq[62]-0.02857796067672614*fq[60]+0.04572473708276183*fq[59]-0.04572473708276183*fq[57]+0.02857796067672614*fq[56]-0.02857796067672614*fq[54]+0.04572473708276183*fq[53]-0.04572473708276183*fq[51]+0.0731595793324189*fq[50]-0.0731595793324189*fq[48]+0.04572473708276183*fq[47]-0.04572473708276183*fq[45]-0.09144947416552365*fq[44]+0.09144947416552365*fq[42]-0.1463191586648378*fq[41]+0.1463191586648378*fq[39]-0.09144947416552365*fq[38]+0.09144947416552365*fq[36]+0.04572473708276183*fq[35]-0.04572473708276183*fq[33]+0.0731595793324189*fq[32]-0.0731595793324189*fq[30]+0.04572473708276183*fq[29]-0.04572473708276183*fq[27]+0.02857796067672614*fq[26]-0.02857796067672614*fq[24]+0.04572473708276183*fq[23]-0.04572473708276183*fq[21]+0.02857796067672614*fq[20]-0.02857796067672614*fq[18]-0.05715592135345229*fq[17]+0.05715592135345229*fq[15]-0.09144947416552365*fq[14]+0.09144947416552365*fq[12]-0.05715592135345229*fq[11]+0.05715592135345229*fq[9]+0.02857796067672614*fq[8]-0.02857796067672614*fq[6]+0.04572473708276183*fq[5]-0.04572473708276183*fq[3]+0.02857796067672614*fq[2]-0.02857796067672614*fq[0]; 
  if(linc2 == 27) f_lte_d[27] = 0.02857796067672614*fq[80]-0.02857796067672614*fq[78]-0.05715592135345229*fq[77]+0.05715592135345229*fq[75]+0.02857796067672614*fq[74]-0.02857796067672614*fq[72]+0.04572473708276183*fq[71]-0.04572473708276183*fq[69]-0.09144947416552365*fq[68]+0.09144947416552365*fq[66]+0.04572473708276183*fq[65]-0.04572473708276183*fq[63]+0.02857796067672614*fq[62]-0.02857796067672614*fq[60]-0.05715592135345229*fq[59]+0.05715592135345229*fq[57]+0.02857796067672614*fq[56]-0.02857796067672614*fq[54]+0.04572473708276183*fq[53]-0.04572473708276183*fq[51]-0.09144947416552365*fq[50]+0.09144947416552365*fq[48]+0.04572473708276183*fq[47]-0.04572473708276183*fq[45]+0.0731595793324189*fq[44]-0.0731595793324189*fq[42]-0.1463191586648378*fq[41]+0.1463191586648378*fq[39]+0.0731595793324189*fq[38]-0.0731595793324189*fq[36]+0.04572473708276183*fq[35]-0.04572473708276183*fq[33]-0.09144947416552365*fq[32]+0.09144947416552365*fq[30]+0.04572473708276183*fq[29]-0.04572473708276183*fq[27]+0.02857796067672614*fq[26]-0.02857796067672614*fq[24]-0.05715592135345229*fq[23]+0.05715592135345229*fq[21]+0.02857796067672614*fq[20]-0.02857796067672614*fq[18]+0.04572473708276183*fq[17]-0.04572473708276183*fq[15]-0.09144947416552365*fq[14]+0.09144947416552365*fq[12]+0.04572473708276183*fq[11]-0.04572473708276183*fq[9]+0.02857796067672614*fq[8]-0.02857796067672614*fq[6]-0.05715592135345229*fq[5]+0.05715592135345229*fq[3]+0.02857796067672614*fq[2]-0.02857796067672614*fq[0]; 
  if(linc2 == 28) f_lte_d[28] = 0.02857796067672614*fq[80]-0.05715592135345229*fq[79]+0.02857796067672614*fq[78]+0.04572473708276183*fq[77]-0.09144947416552365*fq[76]+0.04572473708276183*fq[75]+0.02857796067672614*fq[74]-0.05715592135345229*fq[73]+0.02857796067672614*fq[72]+0.04572473708276183*fq[71]-0.09144947416552365*fq[70]+0.04572473708276183*fq[69]+0.0731595793324189*fq[68]-0.1463191586648378*fq[67]+0.0731595793324189*fq[66]+0.04572473708276183*fq[65]-0.09144947416552365*fq[64]+0.04572473708276183*fq[63]+0.02857796067672614*fq[62]-0.05715592135345229*fq[61]+0.02857796067672614*fq[60]+0.04572473708276183*fq[59]-0.09144947416552365*fq[58]+0.04572473708276183*fq[57]+0.02857796067672614*fq[56]-0.05715592135345229*fq[55]+0.02857796067672614*fq[54]-0.02857796067672614*fq[26]+0.05715592135345229*fq[25]-0.02857796067672614*fq[24]-0.04572473708276183*fq[23]+0.09144947416552365*fq[22]-0.04572473708276183*fq[21]-0.02857796067672614*fq[20]+0.05715592135345229*fq[19]-0.02857796067672614*fq[18]-0.04572473708276183*fq[17]+0.09144947416552365*fq[16]-0.04572473708276183*fq[15]-0.0731595793324189*fq[14]+0.1463191586648378*fq[13]-0.0731595793324189*fq[12]-0.04572473708276183*fq[11]+0.09144947416552365*fq[10]-0.04572473708276183*fq[9]-0.02857796067672614*fq[8]+0.05715592135345229*fq[7]-0.02857796067672614*fq[6]-0.04572473708276183*fq[5]+0.09144947416552365*fq[4]-0.04572473708276183*fq[3]-0.02857796067672614*fq[2]+0.05715592135345229*fq[1]-0.02857796067672614*fq[0]; 
  if(linc2 == 29) f_lte_d[29] = 0.02857796067672614*fq[80]-0.05715592135345229*fq[79]+0.02857796067672614*fq[78]+0.04572473708276183*fq[77]-0.09144947416552365*fq[76]+0.04572473708276183*fq[75]+0.02857796067672614*fq[74]-0.05715592135345229*fq[73]+0.02857796067672614*fq[72]-0.02857796067672614*fq[62]+0.05715592135345229*fq[61]-0.02857796067672614*fq[60]-0.04572473708276183*fq[59]+0.09144947416552365*fq[58]-0.04572473708276183*fq[57]-0.02857796067672614*fq[56]+0.05715592135345229*fq[55]-0.02857796067672614*fq[54]+0.04572473708276183*fq[53]-0.09144947416552365*fq[52]+0.04572473708276183*fq[51]+0.0731595793324189*fq[50]-0.1463191586648378*fq[49]+0.0731595793324189*fq[48]+0.04572473708276183*fq[47]-0.09144947416552365*fq[46]+0.04572473708276183*fq[45]-0.04572473708276183*fq[35]+0.09144947416552365*fq[34]-0.04572473708276183*fq[33]-0.0731595793324189*fq[32]+0.1463191586648378*fq[31]-0.0731595793324189*fq[30]-0.04572473708276183*fq[29]+0.09144947416552365*fq[28]-0.04572473708276183*fq[27]+0.02857796067672614*fq[26]-0.05715592135345229*fq[25]+0.02857796067672614*fq[24]+0.04572473708276183*fq[23]-0.09144947416552365*fq[22]+0.04572473708276183*fq[21]+0.02857796067672614*fq[20]-0.05715592135345229*fq[19]+0.02857796067672614*fq[18]-0.02857796067672614*fq[8]+0.05715592135345229*fq[7]-0.02857796067672614*fq[6]-0.04572473708276183*fq[5]+0.09144947416552365*fq[4]-0.04572473708276183*fq[3]-0.02857796067672614*fq[2]+0.05715592135345229*fq[1]-0.02857796067672614*fq[0]; 
  if(linc2 == 30) f_lte_d[30] = 0.02857796067672614*fq[80]-0.05715592135345229*fq[79]+0.02857796067672614*fq[78]-0.02857796067672614*fq[74]+0.05715592135345229*fq[73]-0.02857796067672614*fq[72]+0.04572473708276183*fq[71]-0.09144947416552365*fq[70]+0.04572473708276183*fq[69]-0.04572473708276183*fq[65]+0.09144947416552365*fq[64]-0.04572473708276183*fq[63]+0.02857796067672614*fq[62]-0.05715592135345229*fq[61]+0.02857796067672614*fq[60]-0.02857796067672614*fq[56]+0.05715592135345229*fq[55]-0.02857796067672614*fq[54]+0.04572473708276183*fq[53]-0.09144947416552365*fq[52]+0.04572473708276183*fq[51]-0.04572473708276183*fq[47]+0.09144947416552365*fq[46]-0.04572473708276183*fq[45]+0.0731595793324189*fq[44]-0.1463191586648378*fq[43]+0.0731595793324189*fq[42]-0.0731595793324189*fq[38]+0.1463191586648378*fq[37]-0.0731595793324189*fq[36]+0.04572473708276183*fq[35]-0.09144947416552365*fq[34]+0.04572473708276183*fq[33]-0.04572473708276183*fq[29]+0.09144947416552365*fq[28]-0.04572473708276183*fq[27]+0.02857796067672614*fq[26]-0.05715592135345229*fq[25]+0.02857796067672614*fq[24]-0.02857796067672614*fq[20]+0.05715592135345229*fq[19]-0.02857796067672614*fq[18]+0.04572473708276183*fq[17]-0.09144947416552365*fq[16]+0.04572473708276183*fq[15]-0.04572473708276183*fq[11]+0.09144947416552365*fq[10]-0.04572473708276183*fq[9]+0.02857796067672614*fq[8]-0.05715592135345229*fq[7]+0.02857796067672614*fq[6]-0.02857796067672614*fq[2]+0.05715592135345229*fq[1]-0.02857796067672614*fq[0]; 
  if(linc2 == 31) f_lte_d[31] = 0.07716049382716049*fq[80]-0.07716049382716049*fq[78]-0.07716049382716049*fq[74]+0.07716049382716049*fq[72]-0.07716049382716049*fq[62]+0.07716049382716049*fq[60]+0.07716049382716049*fq[56]-0.07716049382716049*fq[54]-0.07716049382716049*fq[26]+0.07716049382716049*fq[24]+0.07716049382716049*fq[20]-0.07716049382716049*fq[18]+0.07716049382716049*fq[8]-0.07716049382716049*fq[6]-0.07716049382716049*fq[2]+0.07716049382716049*fq[0]; 
  if(linc2 == 32) f_lte_d[32] = 0.03834135763888529*fq[80]+0.06134617222221646*fq[79]+0.03834135763888529*fq[78]-0.03834135763888529*fq[74]-0.06134617222221646*fq[73]-0.03834135763888529*fq[72]-0.03834135763888529*fq[62]-0.06134617222221646*fq[61]-0.03834135763888529*fq[60]+0.03834135763888529*fq[56]+0.06134617222221646*fq[55]+0.03834135763888529*fq[54]-0.07668271527777058*fq[53]-0.1226923444444329*fq[52]-0.07668271527777058*fq[51]+0.07668271527777058*fq[47]+0.1226923444444329*fq[46]+0.07668271527777058*fq[45]+0.07668271527777058*fq[35]+0.1226923444444329*fq[34]+0.07668271527777058*fq[33]-0.07668271527777058*fq[29]-0.1226923444444329*fq[28]-0.07668271527777058*fq[27]+0.03834135763888529*fq[26]+0.06134617222221646*fq[25]+0.03834135763888529*fq[24]-0.03834135763888529*fq[20]-0.06134617222221646*fq[19]-0.03834135763888529*fq[18]-0.03834135763888529*fq[8]-0.06134617222221646*fq[7]-0.03834135763888529*fq[6]+0.03834135763888529*fq[2]+0.06134617222221646*fq[1]+0.03834135763888529*fq[0]; 
  if(linc2 == 33) f_lte_d[33] = 0.03834135763888529*fq[80]+0.06134617222221646*fq[79]+0.03834135763888529*fq[78]-0.03834135763888529*fq[74]-0.06134617222221646*fq[73]-0.03834135763888529*fq[72]-0.07668271527777058*fq[71]-0.1226923444444329*fq[70]-0.07668271527777058*fq[69]+0.07668271527777058*fq[65]+0.1226923444444329*fq[64]+0.07668271527777058*fq[63]+0.03834135763888529*fq[62]+0.06134617222221646*fq[61]+0.03834135763888529*fq[60]-0.03834135763888529*fq[56]-0.06134617222221646*fq[55]-0.03834135763888529*fq[54]-0.03834135763888529*fq[26]-0.06134617222221646*fq[25]-0.03834135763888529*fq[24]+0.03834135763888529*fq[20]+0.06134617222221646*fq[19]+0.03834135763888529*fq[18]+0.07668271527777058*fq[17]+0.1226923444444329*fq[16]+0.07668271527777058*fq[15]-0.07668271527777058*fq[11]-0.1226923444444329*fq[10]-0.07668271527777058*fq[9]-0.03834135763888529*fq[8]-0.06134617222221646*fq[7]-0.03834135763888529*fq[6]+0.03834135763888529*fq[2]+0.06134617222221646*fq[1]+0.03834135763888529*fq[0]; 
  if(linc2 == 34) f_lte_d[34] = 0.03834135763888529*fq[80]+0.06134617222221646*fq[79]+0.03834135763888529*fq[78]-0.07668271527777058*fq[77]-0.1226923444444329*fq[76]-0.07668271527777058*fq[75]+0.03834135763888529*fq[74]+0.06134617222221646*fq[73]+0.03834135763888529*fq[72]-0.03834135763888529*fq[62]-0.06134617222221646*fq[61]-0.03834135763888529*fq[60]+0.07668271527777058*fq[59]+0.1226923444444329*fq[58]+0.07668271527777058*fq[57]-0.03834135763888529*fq[56]-0.06134617222221646*fq[55]-0.03834135763888529*fq[54]-0.03834135763888529*fq[26]-0.06134617222221646*fq[25]-0.03834135763888529*fq[24]+0.07668271527777058*fq[23]+0.1226923444444329*fq[22]+0.07668271527777058*fq[21]-0.03834135763888529*fq[20]-0.06134617222221646*fq[19]-0.03834135763888529*fq[18]+0.03834135763888529*fq[8]+0.06134617222221646*fq[7]+0.03834135763888529*fq[6]-0.07668271527777058*fq[5]-0.1226923444444329*fq[4]-0.07668271527777058*fq[3]+0.03834135763888529*fq[2]+0.06134617222221646*fq[1]+0.03834135763888529*fq[0]; 
  if(linc2 == 35) f_lte_d[35] = 0.03834135763888529*fq[80]-0.03834135763888529*fq[78]+0.06134617222221646*fq[77]-0.06134617222221646*fq[75]+0.03834135763888529*fq[74]-0.03834135763888529*fq[72]-0.03834135763888529*fq[62]+0.03834135763888529*fq[60]-0.06134617222221646*fq[59]+0.06134617222221646*fq[57]-0.03834135763888529*fq[56]+0.03834135763888529*fq[54]-0.07668271527777058*fq[53]+0.07668271527777058*fq[51]-0.1226923444444329*fq[50]+0.1226923444444329*fq[48]-0.07668271527777058*fq[47]+0.07668271527777058*fq[45]+0.07668271527777058*fq[35]-0.07668271527777058*fq[33]+0.1226923444444329*fq[32]-0.1226923444444329*fq[30]+0.07668271527777058*fq[29]-0.07668271527777058*fq[27]+0.03834135763888529*fq[26]-0.03834135763888529*fq[24]+0.06134617222221646*fq[23]-0.06134617222221646*fq[21]+0.03834135763888529*fq[20]-0.03834135763888529*fq[18]-0.03834135763888529*fq[8]+0.03834135763888529*fq[6]-0.06134617222221646*fq[5]+0.06134617222221646*fq[3]-0.03834135763888529*fq[2]+0.03834135763888529*fq[0]; 
  if(linc2 == 36) f_lte_d[36] = 0.03834135763888529*fq[80]-0.03834135763888529*fq[78]+0.06134617222221646*fq[77]-0.06134617222221646*fq[75]+0.03834135763888529*fq[74]-0.03834135763888529*fq[72]-0.07668271527777058*fq[71]+0.07668271527777058*fq[69]-0.1226923444444329*fq[68]+0.1226923444444329*fq[66]-0.07668271527777058*fq[65]+0.07668271527777058*fq[63]+0.03834135763888529*fq[62]-0.03834135763888529*fq[60]+0.06134617222221646*fq[59]-0.06134617222221646*fq[57]+0.03834135763888529*fq[56]-0.03834135763888529*fq[54]-0.03834135763888529*fq[26]+0.03834135763888529*fq[24]-0.06134617222221646*fq[23]+0.06134617222221646*fq[21]-0.03834135763888529*fq[20]+0.03834135763888529*fq[18]+0.07668271527777058*fq[17]-0.07668271527777058*fq[15]+0.1226923444444329*fq[14]-0.1226923444444329*fq[12]+0.07668271527777058*fq[11]-0.07668271527777058*fq[9]-0.03834135763888529*fq[8]+0.03834135763888529*fq[6]-0.06134617222221646*fq[5]+0.06134617222221646*fq[3]-0.03834135763888529*fq[2]+0.03834135763888529*fq[0]; 
  if(linc2 == 37) f_lte_d[37] = 0.03834135763888529*fq[80]-0.03834135763888529*fq[78]-0.03834135763888529*fq[74]+0.03834135763888529*fq[72]+0.06134617222221646*fq[71]-0.06134617222221646*fq[69]-0.06134617222221646*fq[65]+0.06134617222221646*fq[63]+0.03834135763888529*fq[62]-0.03834135763888529*fq[60]-0.03834135763888529*fq[56]+0.03834135763888529*fq[54]-0.07668271527777058*fq[53]+0.07668271527777058*fq[51]+0.07668271527777058*fq[47]-0.07668271527777058*fq[45]-0.1226923444444329*fq[44]+0.1226923444444329*fq[42]+0.1226923444444329*fq[38]-0.1226923444444329*fq[36]-0.07668271527777058*fq[35]+0.07668271527777058*fq[33]+0.07668271527777058*fq[29]-0.07668271527777058*fq[27]+0.03834135763888529*fq[26]-0.03834135763888529*fq[24]-0.03834135763888529*fq[20]+0.03834135763888529*fq[18]+0.06134617222221646*fq[17]-0.06134617222221646*fq[15]-0.06134617222221646*fq[11]+0.06134617222221646*fq[9]+0.03834135763888529*fq[8]-0.03834135763888529*fq[6]-0.03834135763888529*fq[2]+0.03834135763888529*fq[0]; 
  if(linc2 == 38) f_lte_d[38] = 0.03834135763888529*fq[80]-0.03834135763888529*fq[78]-0.03834135763888529*fq[74]+0.03834135763888529*fq[72]-0.07668271527777058*fq[71]+0.07668271527777058*fq[69]+0.07668271527777058*fq[65]-0.07668271527777058*fq[63]+0.03834135763888529*fq[62]-0.03834135763888529*fq[60]-0.03834135763888529*fq[56]+0.03834135763888529*fq[54]+0.06134617222221646*fq[53]-0.06134617222221646*fq[51]-0.06134617222221646*fq[47]+0.06134617222221646*fq[45]-0.1226923444444329*fq[44]+0.1226923444444329*fq[42]+0.1226923444444329*fq[38]-0.1226923444444329*fq[36]+0.06134617222221646*fq[35]-0.06134617222221646*fq[33]-0.06134617222221646*fq[29]+0.06134617222221646*fq[27]+0.03834135763888529*fq[26]-0.03834135763888529*fq[24]-0.03834135763888529*fq[20]+0.03834135763888529*fq[18]-0.07668271527777058*fq[17]+0.07668271527777058*fq[15]+0.07668271527777058*fq[11]-0.07668271527777058*fq[9]+0.03834135763888529*fq[8]-0.03834135763888529*fq[6]-0.03834135763888529*fq[2]+0.03834135763888529*fq[0]; 
  if(linc2 == 39) f_lte_d[39] = 0.03834135763888529*fq[80]-0.03834135763888529*fq[78]-0.07668271527777058*fq[77]+0.07668271527777058*fq[75]+0.03834135763888529*fq[74]-0.03834135763888529*fq[72]+0.06134617222221646*fq[71]-0.06134617222221646*fq[69]-0.1226923444444329*fq[68]+0.1226923444444329*fq[66]+0.06134617222221646*fq[65]-0.06134617222221646*fq[63]+0.03834135763888529*fq[62]-0.03834135763888529*fq[60]-0.07668271527777058*fq[59]+0.07668271527777058*fq[57]+0.03834135763888529*fq[56]-0.03834135763888529*fq[54]-0.03834135763888529*fq[26]+0.03834135763888529*fq[24]+0.07668271527777058*fq[23]-0.07668271527777058*fq[21]-0.03834135763888529*fq[20]+0.03834135763888529*fq[18]-0.06134617222221646*fq[17]+0.06134617222221646*fq[15]+0.1226923444444329*fq[14]-0.1226923444444329*fq[12]-0.06134617222221646*fq[11]+0.06134617222221646*fq[9]-0.03834135763888529*fq[8]+0.03834135763888529*fq[6]+0.07668271527777058*fq[5]-0.07668271527777058*fq[3]-0.03834135763888529*fq[2]+0.03834135763888529*fq[0]; 
  if(linc2 == 40) f_lte_d[40] = 0.03834135763888529*fq[80]-0.03834135763888529*fq[78]-0.07668271527777058*fq[77]+0.07668271527777058*fq[75]+0.03834135763888529*fq[74]-0.03834135763888529*fq[72]-0.03834135763888529*fq[62]+0.03834135763888529*fq[60]+0.07668271527777058*fq[59]-0.07668271527777058*fq[57]-0.03834135763888529*fq[56]+0.03834135763888529*fq[54]+0.06134617222221646*fq[53]-0.06134617222221646*fq[51]-0.1226923444444329*fq[50]+0.1226923444444329*fq[48]+0.06134617222221646*fq[47]-0.06134617222221646*fq[45]-0.06134617222221646*fq[35]+0.06134617222221646*fq[33]+0.1226923444444329*fq[32]-0.1226923444444329*fq[30]-0.06134617222221646*fq[29]+0.06134617222221646*fq[27]+0.03834135763888529*fq[26]-0.03834135763888529*fq[24]-0.07668271527777058*fq[23]+0.07668271527777058*fq[21]+0.03834135763888529*fq[20]-0.03834135763888529*fq[18]-0.03834135763888529*fq[8]+0.03834135763888529*fq[6]+0.07668271527777058*fq[5]-0.07668271527777058*fq[3]-0.03834135763888529*fq[2]+0.03834135763888529*fq[0]; 
  if(linc2 == 41) f_lte_d[41] = 0.03834135763888529*fq[80]-0.07668271527777058*fq[79]+0.03834135763888529*fq[78]+0.06134617222221646*fq[77]-0.1226923444444329*fq[76]+0.06134617222221646*fq[75]+0.03834135763888529*fq[74]-0.07668271527777058*fq[73]+0.03834135763888529*fq[72]-0.03834135763888529*fq[62]+0.07668271527777058*fq[61]-0.03834135763888529*fq[60]-0.06134617222221646*fq[59]+0.1226923444444329*fq[58]-0.06134617222221646*fq[57]-0.03834135763888529*fq[56]+0.07668271527777058*fq[55]-0.03834135763888529*fq[54]-0.03834135763888529*fq[26]+0.07668271527777058*fq[25]-0.03834135763888529*fq[24]-0.06134617222221646*fq[23]+0.1226923444444329*fq[22]-0.06134617222221646*fq[21]-0.03834135763888529*fq[20]+0.07668271527777058*fq[19]-0.03834135763888529*fq[18]+0.03834135763888529*fq[8]-0.07668271527777058*fq[7]+0.03834135763888529*fq[6]+0.06134617222221646*fq[5]-0.1226923444444329*fq[4]+0.06134617222221646*fq[3]+0.03834135763888529*fq[2]-0.07668271527777058*fq[1]+0.03834135763888529*fq[0]; 
  if(linc2 == 42) f_lte_d[42] = 0.03834135763888529*fq[80]-0.07668271527777058*fq[79]+0.03834135763888529*fq[78]-0.03834135763888529*fq[74]+0.07668271527777058*fq[73]-0.03834135763888529*fq[72]+0.06134617222221646*fq[71]-0.1226923444444329*fq[70]+0.06134617222221646*fq[69]-0.06134617222221646*fq[65]+0.1226923444444329*fq[64]-0.06134617222221646*fq[63]+0.03834135763888529*fq[62]-0.07668271527777058*fq[61]+0.03834135763888529*fq[60]-0.03834135763888529*fq[56]+0.07668271527777058*fq[55]-0.03834135763888529*fq[54]-0.03834135763888529*fq[26]+0.07668271527777058*fq[25]-0.03834135763888529*fq[24]+0.03834135763888529*fq[20]-0.07668271527777058*fq[19]+0.03834135763888529*fq[18]-0.06134617222221646*fq[17]+0.1226923444444329*fq[16]-0.06134617222221646*fq[15]+0.06134617222221646*fq[11]-0.1226923444444329*fq[10]+0.06134617222221646*fq[9]-0.03834135763888529*fq[8]+0.07668271527777058*fq[7]-0.03834135763888529*fq[6]+0.03834135763888529*fq[2]-0.07668271527777058*fq[1]+0.03834135763888529*fq[0]; 
  if(linc2 == 43) f_lte_d[43] = 0.03834135763888529*fq[80]-0.07668271527777058*fq[79]+0.03834135763888529*fq[78]-0.03834135763888529*fq[74]+0.07668271527777058*fq[73]-0.03834135763888529*fq[72]-0.03834135763888529*fq[62]+0.07668271527777058*fq[61]-0.03834135763888529*fq[60]+0.03834135763888529*fq[56]-0.07668271527777058*fq[55]+0.03834135763888529*fq[54]+0.06134617222221646*fq[53]-0.1226923444444329*fq[52]+0.06134617222221646*fq[51]-0.06134617222221646*fq[47]+0.1226923444444329*fq[46]-0.06134617222221646*fq[45]-0.06134617222221646*fq[35]+0.1226923444444329*fq[34]-0.06134617222221646*fq[33]+0.06134617222221646*fq[29]-0.1226923444444329*fq[28]+0.06134617222221646*fq[27]+0.03834135763888529*fq[26]-0.07668271527777058*fq[25]+0.03834135763888529*fq[24]-0.03834135763888529*fq[20]+0.07668271527777058*fq[19]-0.03834135763888529*fq[18]-0.03834135763888529*fq[8]+0.07668271527777058*fq[7]-0.03834135763888529*fq[6]+0.03834135763888529*fq[2]-0.07668271527777058*fq[1]+0.03834135763888529*fq[0]; 
  if(linc2 == 44) f_lte_d[44] = 0.05144032921810704*fq[80]-0.05144032921810704*fq[78]-0.05144032921810704*fq[74]+0.05144032921810704*fq[72]-0.05144032921810704*fq[62]+0.05144032921810704*fq[60]+0.05144032921810704*fq[56]-0.05144032921810704*fq[54]-0.1028806584362141*fq[53]+0.1028806584362141*fq[51]+0.1028806584362141*fq[47]-0.1028806584362141*fq[45]+0.1028806584362141*fq[35]-0.1028806584362141*fq[33]-0.1028806584362141*fq[29]+0.1028806584362141*fq[27]+0.05144032921810704*fq[26]-0.05144032921810704*fq[24]-0.05144032921810704*fq[20]+0.05144032921810704*fq[18]-0.05144032921810704*fq[8]+0.05144032921810704*fq[6]+0.05144032921810704*fq[2]-0.05144032921810704*fq[0]; 
  if(linc2 == 45) f_lte_d[45] = 0.05144032921810704*fq[80]-0.05144032921810704*fq[78]-0.05144032921810704*fq[74]+0.05144032921810704*fq[72]-0.1028806584362141*fq[71]+0.1028806584362141*fq[69]+0.1028806584362141*fq[65]-0.1028806584362141*fq[63]+0.05144032921810704*fq[62]-0.05144032921810704*fq[60]-0.05144032921810704*fq[56]+0.05144032921810704*fq[54]-0.05144032921810704*fq[26]+0.05144032921810704*fq[24]+0.05144032921810704*fq[20]-0.05144032921810704*fq[18]+0.1028806584362141*fq[17]-0.1028806584362141*fq[15]-0.1028806584362141*fq[11]+0.1028806584362141*fq[9]-0.05144032921810704*fq[8]+0.05144032921810704*fq[6]+0.05144032921810704*fq[2]-0.05144032921810704*fq[0]; 
  if(linc2 == 46) f_lte_d[46] = 0.05144032921810704*fq[80]-0.05144032921810704*fq[78]-0.1028806584362141*fq[77]+0.1028806584362141*fq[75]+0.05144032921810704*fq[74]-0.05144032921810704*fq[72]-0.05144032921810704*fq[62]+0.05144032921810704*fq[60]+0.1028806584362141*fq[59]-0.1028806584362141*fq[57]-0.05144032921810704*fq[56]+0.05144032921810704*fq[54]-0.05144032921810704*fq[26]+0.05144032921810704*fq[24]+0.1028806584362141*fq[23]-0.1028806584362141*fq[21]-0.05144032921810704*fq[20]+0.05144032921810704*fq[18]+0.05144032921810704*fq[8]-0.05144032921810704*fq[6]-0.1028806584362141*fq[5]+0.1028806584362141*fq[3]+0.05144032921810704*fq[2]-0.05144032921810704*fq[0]; 
  if(linc2 == 47) f_lte_d[47] = 0.05144032921810704*fq[80]-0.1028806584362141*fq[79]+0.05144032921810704*fq[78]-0.05144032921810704*fq[74]+0.1028806584362141*fq[73]-0.05144032921810704*fq[72]-0.05144032921810704*fq[62]+0.1028806584362141*fq[61]-0.05144032921810704*fq[60]+0.05144032921810704*fq[56]-0.1028806584362141*fq[55]+0.05144032921810704*fq[54]-0.05144032921810704*fq[26]+0.1028806584362141*fq[25]-0.05144032921810704*fq[24]+0.05144032921810704*fq[20]-0.1028806584362141*fq[19]+0.05144032921810704*fq[18]+0.05144032921810704*fq[8]-0.1028806584362141*fq[7]+0.05144032921810704*fq[6]-0.05144032921810704*fq[2]+0.1028806584362141*fq[1]-0.05144032921810704*fq[0]; 



    // for (int n=0; n<tot_phase_quad; ++n) {
    //   double tmp = phase_w[n]*fq[n];
    //   for (int k=0; k<num_phase_basis; ++k) {
    //     if (linc2 == k) {
    //       f_lte_d[k] += tmp*phaseb_o[k+num_phase_basis*n];
    //     }
    //   }
    // }
  }
}

void
gkyl_vlasov_lte_proj_on_basis_advance_cu(gkyl_vlasov_lte_proj_on_basis *up,
  const struct gkyl_range *phase_range, const struct gkyl_range *conf_range,
  const struct gkyl_array *moms_lte, struct gkyl_array *f_lte)
{
  
  dim3 dimGrid, dimBlock;
  int tot_phase_quad = up->basis_at_ords->size;
  int num_phase_basis = f_lte->ncomp;
  //gkyl_parallelize_components_kernel_launch_dims(&dimGrid, &dimBlock, *phase_range, tot_phase_quad);
  int nblocks = phase_range->nblocks, nthreads = phase_range->nthreads;
  gkyl_vlasov_lte_proj_on_basis_advance_cu_ker<<<nblocks, nthreads>>>
    (up->phase_grid, *phase_range, *conf_range, up->conf_basis_at_ords->on_dev, up->basis_at_ords->on_dev,
     up->ordinates->on_dev, up->weights->on_dev, up->p2c_qidx,
     up->is_relativistic, up->is_canonical_pb, 
     up->is_canonical_pb ? up->h_ij_inv->on_dev : 0, 
     up->is_canonical_pb ? up->det_h->on_dev : 0, 
     moms_lte->on_dev, up->f_lte_at_nodes->on_dev);

  gkyl_array_clear(f_lte, 0.0);

  gkyl_parallelize_components_kernel_launch_dims(&dimGrid, &dimBlock, *phase_range, num_phase_basis);
  gkyl_proj_on_basis_cu_ker<<<dimGrid, dimBlock>>>
    (up->phase_grid, *phase_range, *conf_range, up->conf_basis_at_ords->on_dev, up->basis_at_ords->on_dev,
     up->ordinates->on_dev, up->weights->on_dev, up->p2c_qidx,
     up->is_relativistic, up->is_canonical_pb, 
     up->is_canonical_pb ? up->h_ij_inv->on_dev : 0, 
     up->is_canonical_pb ? up->det_h->on_dev : 0, 
     moms_lte->on_dev, up->f_lte_at_nodes->on_dev, f_lte->on_dev);

  // Correct the density of the projected LTE distribution function through rescaling.
  // This correction is needed especially for the relativistic LTE, whose pre-factor
  // we construct through an expansion of the Bessel functions to avoid finite 
  // precision effects in such a way that we can recover arbitrary temperature 
  // relativistic LTE distributions by rescaling the distribution to the desired density.  
  gkyl_vlasov_lte_density_moment_advance(up->moments_up, phase_range, conf_range, f_lte, up->num_ratio);

  // compute number density ratio: num_ratio = n/n0
  // 0th component of moms_target is the target density
  gkyl_dg_div_op_range(up->mem, up->conf_basis, 0, up->num_ratio,
    0, moms_lte, 0, up->num_ratio, conf_range);

  // rescale distribution function
  gkyl_dg_mul_conf_phase_op_range(&up->conf_basis, &up->phase_basis,
    f_lte, up->num_ratio, f_lte, conf_range, phase_range);  
}
