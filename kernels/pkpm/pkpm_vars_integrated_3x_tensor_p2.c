#include <gkyl_euler_pkpm_kernels.h> 
GKYL_CU_DH void pkpm_vars_integrated_3x_tensor_p2(const double *vlasov_pkpm_moms, 
  const double* pkpm_u, double* GKYL_RESTRICT int_pkpm_vars) 
{ 
  // vlasov_pkpm_moms: [rho, p_parallel, p_perp], Moments computed from kinetic equation in pkpm model.
  // pkpm_u:           [ux, uy, uz], Fluid input state vector.
  // int_pkpm_vars:    Output integrated variables.

  const double *rho = &vlasov_pkpm_moms[0]; 
  const double *p_parallel = &vlasov_pkpm_moms[27]; 
  const double *p_perp = &vlasov_pkpm_moms[54]; 

  const double *ux = &pkpm_u[0]; 
  const double *uy = &pkpm_u[8]; 
  const double *uz = &pkpm_u[16]; 

  double rhoux[8] = {0.0}; 
  double rhouy[8] = {0.0}; 
  double rhouz[8] = {0.0}; 
  rhoux[0] = 0.3535533905932737*ux[7]*rho[10]+0.3535533905932737*rho[6]*ux[6]+0.3535533905932737*rho[5]*ux[5]+0.3535533905932737*rho[4]*ux[4]+0.3535533905932737*rho[3]*ux[3]+0.3535533905932737*rho[2]*ux[2]+0.3535533905932737*rho[1]*ux[1]+0.3535533905932737*rho[0]*ux[0]; 
  rhoux[1] = 0.3162277660168379*ux[7]*rho[17]+0.3162277660168379*ux[5]*rho[13]+0.3162277660168379*ux[4]*rho[11]+0.3535533905932737*ux[6]*rho[10]+0.3535533905932737*rho[6]*ux[7]+0.3162277660168379*ux[1]*rho[7]+0.3535533905932737*rho[3]*ux[5]+0.3535533905932737*ux[3]*rho[5]+0.3535533905932737*rho[2]*ux[4]+0.3535533905932737*ux[2]*rho[4]+0.3535533905932737*rho[0]*ux[1]+0.3535533905932737*ux[0]*rho[1]; 
  rhoux[2] = 0.3162277660168379*ux[7]*rho[18]+0.3162277660168379*ux[6]*rho[14]+0.3162277660168379*ux[4]*rho[12]+0.3535533905932737*ux[5]*rho[10]+0.3162277660168379*ux[2]*rho[8]+0.3535533905932737*rho[5]*ux[7]+0.3535533905932737*rho[3]*ux[6]+0.3535533905932737*ux[3]*rho[6]+0.3535533905932737*rho[1]*ux[4]+0.3535533905932737*ux[1]*rho[4]+0.3535533905932737*rho[0]*ux[2]+0.3535533905932737*ux[0]*rho[2]; 
  rhoux[3] = 0.3162277660168379*ux[7]*rho[19]+0.3162277660168379*ux[6]*rho[16]+0.3162277660168379*ux[5]*rho[15]+0.3535533905932737*ux[4]*rho[10]+0.3162277660168379*ux[3]*rho[9]+0.3535533905932737*rho[4]*ux[7]+0.3535533905932737*rho[2]*ux[6]+0.3535533905932737*ux[2]*rho[6]+0.3535533905932737*rho[1]*ux[5]+0.3535533905932737*ux[1]*rho[5]+0.3535533905932737*rho[0]*ux[3]+0.3535533905932737*ux[0]*rho[3]; 
  rhoux[4] = 0.2828427124746191*ux[7]*rho[23]+0.2828427124746191*ux[4]*rho[20]+0.3162277660168379*ux[6]*rho[18]+0.3162277660168379*ux[5]*rho[17]+0.3162277660168379*ux[7]*rho[14]+0.3162277660168379*ux[7]*rho[13]+0.3162277660168379*ux[2]*rho[12]+0.3162277660168379*ux[1]*rho[11]+0.3535533905932737*ux[3]*rho[10]+0.3162277660168379*ux[4]*rho[8]+0.3535533905932737*rho[3]*ux[7]+0.3162277660168379*ux[4]*rho[7]+0.3535533905932737*rho[5]*ux[6]+0.3535533905932737*ux[5]*rho[6]+0.3535533905932737*rho[0]*ux[4]+0.3535533905932737*ux[0]*rho[4]+0.3535533905932737*rho[1]*ux[2]+0.3535533905932737*ux[1]*rho[2]; 
  rhoux[5] = 0.2828427124746191*ux[7]*rho[24]+0.2828427124746191*ux[5]*rho[21]+0.3162277660168379*ux[6]*rho[19]+0.3162277660168379*ux[4]*rho[17]+0.3162277660168379*ux[7]*rho[16]+0.3162277660168379*ux[3]*rho[15]+0.3162277660168379*ux[1]*rho[13]+0.3162277660168379*ux[7]*rho[11]+0.3535533905932737*ux[2]*rho[10]+0.3162277660168379*ux[5]*rho[9]+0.3535533905932737*rho[2]*ux[7]+0.3162277660168379*ux[5]*rho[7]+0.3535533905932737*rho[4]*ux[6]+0.3535533905932737*ux[4]*rho[6]+0.3535533905932737*rho[0]*ux[5]+0.3535533905932737*ux[0]*rho[5]+0.3535533905932737*rho[1]*ux[3]+0.3535533905932737*ux[1]*rho[3]; 
  rhoux[6] = 0.2828427124746191*ux[7]*rho[25]+0.2828427124746191*ux[6]*rho[22]+0.3162277660168379*ux[5]*rho[19]+0.3162277660168379*ux[4]*rho[18]+0.3162277660168379*ux[3]*rho[16]+0.3162277660168379*ux[7]*rho[15]+0.3162277660168379*ux[2]*rho[14]+0.3162277660168379*ux[7]*rho[12]+0.3535533905932737*ux[1]*rho[10]+0.3162277660168379*ux[6]*rho[9]+0.3162277660168379*ux[6]*rho[8]+0.3535533905932737*rho[1]*ux[7]+0.3535533905932737*rho[0]*ux[6]+0.3535533905932737*ux[0]*rho[6]+0.3535533905932737*rho[4]*ux[5]+0.3535533905932737*ux[4]*rho[5]+0.3535533905932737*rho[2]*ux[3]+0.3535533905932737*ux[2]*rho[3]; 
  rhoux[7] = 0.2529822128134704*ux[7]*rho[26]+0.2828427124746191*ux[6]*rho[25]+0.2828427124746191*ux[5]*rho[24]+0.2828427124746191*ux[4]*rho[23]+0.2828427124746191*ux[7]*rho[22]+0.2828427124746191*ux[7]*rho[21]+0.2828427124746191*ux[7]*rho[20]+0.3162277660168379*ux[3]*rho[19]+0.3162277660168379*ux[2]*rho[18]+0.3162277660168379*ux[1]*rho[17]+0.3162277660168379*ux[5]*rho[16]+0.3162277660168379*ux[6]*rho[15]+0.3162277660168379*ux[4]*rho[14]+0.3162277660168379*ux[4]*rho[13]+0.3162277660168379*ux[6]*rho[12]+0.3162277660168379*ux[5]*rho[11]+0.3535533905932737*ux[0]*rho[10]+0.3162277660168379*ux[7]*rho[9]+0.3162277660168379*ux[7]*rho[8]+0.3162277660168379*rho[7]*ux[7]+0.3535533905932737*rho[0]*ux[7]+0.3535533905932737*rho[1]*ux[6]+0.3535533905932737*ux[1]*rho[6]+0.3535533905932737*rho[2]*ux[5]+0.3535533905932737*ux[2]*rho[5]+0.3535533905932737*rho[3]*ux[4]+0.3535533905932737*ux[3]*rho[4]; 
  rhouy[0] = 0.3535533905932737*uy[7]*rho[10]+0.3535533905932737*rho[6]*uy[6]+0.3535533905932737*rho[5]*uy[5]+0.3535533905932737*rho[4]*uy[4]+0.3535533905932737*rho[3]*uy[3]+0.3535533905932737*rho[2]*uy[2]+0.3535533905932737*rho[1]*uy[1]+0.3535533905932737*rho[0]*uy[0]; 
  rhouy[1] = 0.3162277660168379*uy[7]*rho[17]+0.3162277660168379*uy[5]*rho[13]+0.3162277660168379*uy[4]*rho[11]+0.3535533905932737*uy[6]*rho[10]+0.3535533905932737*rho[6]*uy[7]+0.3162277660168379*uy[1]*rho[7]+0.3535533905932737*rho[3]*uy[5]+0.3535533905932737*uy[3]*rho[5]+0.3535533905932737*rho[2]*uy[4]+0.3535533905932737*uy[2]*rho[4]+0.3535533905932737*rho[0]*uy[1]+0.3535533905932737*uy[0]*rho[1]; 
  rhouy[2] = 0.3162277660168379*uy[7]*rho[18]+0.3162277660168379*uy[6]*rho[14]+0.3162277660168379*uy[4]*rho[12]+0.3535533905932737*uy[5]*rho[10]+0.3162277660168379*uy[2]*rho[8]+0.3535533905932737*rho[5]*uy[7]+0.3535533905932737*rho[3]*uy[6]+0.3535533905932737*uy[3]*rho[6]+0.3535533905932737*rho[1]*uy[4]+0.3535533905932737*uy[1]*rho[4]+0.3535533905932737*rho[0]*uy[2]+0.3535533905932737*uy[0]*rho[2]; 
  rhouy[3] = 0.3162277660168379*uy[7]*rho[19]+0.3162277660168379*uy[6]*rho[16]+0.3162277660168379*uy[5]*rho[15]+0.3535533905932737*uy[4]*rho[10]+0.3162277660168379*uy[3]*rho[9]+0.3535533905932737*rho[4]*uy[7]+0.3535533905932737*rho[2]*uy[6]+0.3535533905932737*uy[2]*rho[6]+0.3535533905932737*rho[1]*uy[5]+0.3535533905932737*uy[1]*rho[5]+0.3535533905932737*rho[0]*uy[3]+0.3535533905932737*uy[0]*rho[3]; 
  rhouy[4] = 0.2828427124746191*uy[7]*rho[23]+0.2828427124746191*uy[4]*rho[20]+0.3162277660168379*uy[6]*rho[18]+0.3162277660168379*uy[5]*rho[17]+0.3162277660168379*uy[7]*rho[14]+0.3162277660168379*uy[7]*rho[13]+0.3162277660168379*uy[2]*rho[12]+0.3162277660168379*uy[1]*rho[11]+0.3535533905932737*uy[3]*rho[10]+0.3162277660168379*uy[4]*rho[8]+0.3535533905932737*rho[3]*uy[7]+0.3162277660168379*uy[4]*rho[7]+0.3535533905932737*rho[5]*uy[6]+0.3535533905932737*uy[5]*rho[6]+0.3535533905932737*rho[0]*uy[4]+0.3535533905932737*uy[0]*rho[4]+0.3535533905932737*rho[1]*uy[2]+0.3535533905932737*uy[1]*rho[2]; 
  rhouy[5] = 0.2828427124746191*uy[7]*rho[24]+0.2828427124746191*uy[5]*rho[21]+0.3162277660168379*uy[6]*rho[19]+0.3162277660168379*uy[4]*rho[17]+0.3162277660168379*uy[7]*rho[16]+0.3162277660168379*uy[3]*rho[15]+0.3162277660168379*uy[1]*rho[13]+0.3162277660168379*uy[7]*rho[11]+0.3535533905932737*uy[2]*rho[10]+0.3162277660168379*uy[5]*rho[9]+0.3535533905932737*rho[2]*uy[7]+0.3162277660168379*uy[5]*rho[7]+0.3535533905932737*rho[4]*uy[6]+0.3535533905932737*uy[4]*rho[6]+0.3535533905932737*rho[0]*uy[5]+0.3535533905932737*uy[0]*rho[5]+0.3535533905932737*rho[1]*uy[3]+0.3535533905932737*uy[1]*rho[3]; 
  rhouy[6] = 0.2828427124746191*uy[7]*rho[25]+0.2828427124746191*uy[6]*rho[22]+0.3162277660168379*uy[5]*rho[19]+0.3162277660168379*uy[4]*rho[18]+0.3162277660168379*uy[3]*rho[16]+0.3162277660168379*uy[7]*rho[15]+0.3162277660168379*uy[2]*rho[14]+0.3162277660168379*uy[7]*rho[12]+0.3535533905932737*uy[1]*rho[10]+0.3162277660168379*uy[6]*rho[9]+0.3162277660168379*uy[6]*rho[8]+0.3535533905932737*rho[1]*uy[7]+0.3535533905932737*rho[0]*uy[6]+0.3535533905932737*uy[0]*rho[6]+0.3535533905932737*rho[4]*uy[5]+0.3535533905932737*uy[4]*rho[5]+0.3535533905932737*rho[2]*uy[3]+0.3535533905932737*uy[2]*rho[3]; 
  rhouy[7] = 0.2529822128134704*uy[7]*rho[26]+0.2828427124746191*uy[6]*rho[25]+0.2828427124746191*uy[5]*rho[24]+0.2828427124746191*uy[4]*rho[23]+0.2828427124746191*uy[7]*rho[22]+0.2828427124746191*uy[7]*rho[21]+0.2828427124746191*uy[7]*rho[20]+0.3162277660168379*uy[3]*rho[19]+0.3162277660168379*uy[2]*rho[18]+0.3162277660168379*uy[1]*rho[17]+0.3162277660168379*uy[5]*rho[16]+0.3162277660168379*uy[6]*rho[15]+0.3162277660168379*uy[4]*rho[14]+0.3162277660168379*uy[4]*rho[13]+0.3162277660168379*uy[6]*rho[12]+0.3162277660168379*uy[5]*rho[11]+0.3535533905932737*uy[0]*rho[10]+0.3162277660168379*uy[7]*rho[9]+0.3162277660168379*uy[7]*rho[8]+0.3162277660168379*rho[7]*uy[7]+0.3535533905932737*rho[0]*uy[7]+0.3535533905932737*rho[1]*uy[6]+0.3535533905932737*uy[1]*rho[6]+0.3535533905932737*rho[2]*uy[5]+0.3535533905932737*uy[2]*rho[5]+0.3535533905932737*rho[3]*uy[4]+0.3535533905932737*uy[3]*rho[4]; 
  rhouz[0] = 0.3535533905932737*uz[7]*rho[10]+0.3535533905932737*rho[6]*uz[6]+0.3535533905932737*rho[5]*uz[5]+0.3535533905932737*rho[4]*uz[4]+0.3535533905932737*rho[3]*uz[3]+0.3535533905932737*rho[2]*uz[2]+0.3535533905932737*rho[1]*uz[1]+0.3535533905932737*rho[0]*uz[0]; 
  rhouz[1] = 0.3162277660168379*uz[7]*rho[17]+0.3162277660168379*uz[5]*rho[13]+0.3162277660168379*uz[4]*rho[11]+0.3535533905932737*uz[6]*rho[10]+0.3535533905932737*rho[6]*uz[7]+0.3162277660168379*uz[1]*rho[7]+0.3535533905932737*rho[3]*uz[5]+0.3535533905932737*uz[3]*rho[5]+0.3535533905932737*rho[2]*uz[4]+0.3535533905932737*uz[2]*rho[4]+0.3535533905932737*rho[0]*uz[1]+0.3535533905932737*uz[0]*rho[1]; 
  rhouz[2] = 0.3162277660168379*uz[7]*rho[18]+0.3162277660168379*uz[6]*rho[14]+0.3162277660168379*uz[4]*rho[12]+0.3535533905932737*uz[5]*rho[10]+0.3162277660168379*uz[2]*rho[8]+0.3535533905932737*rho[5]*uz[7]+0.3535533905932737*rho[3]*uz[6]+0.3535533905932737*uz[3]*rho[6]+0.3535533905932737*rho[1]*uz[4]+0.3535533905932737*uz[1]*rho[4]+0.3535533905932737*rho[0]*uz[2]+0.3535533905932737*uz[0]*rho[2]; 
  rhouz[3] = 0.3162277660168379*uz[7]*rho[19]+0.3162277660168379*uz[6]*rho[16]+0.3162277660168379*uz[5]*rho[15]+0.3535533905932737*uz[4]*rho[10]+0.3162277660168379*uz[3]*rho[9]+0.3535533905932737*rho[4]*uz[7]+0.3535533905932737*rho[2]*uz[6]+0.3535533905932737*uz[2]*rho[6]+0.3535533905932737*rho[1]*uz[5]+0.3535533905932737*uz[1]*rho[5]+0.3535533905932737*rho[0]*uz[3]+0.3535533905932737*uz[0]*rho[3]; 
  rhouz[4] = 0.2828427124746191*uz[7]*rho[23]+0.2828427124746191*uz[4]*rho[20]+0.3162277660168379*uz[6]*rho[18]+0.3162277660168379*uz[5]*rho[17]+0.3162277660168379*uz[7]*rho[14]+0.3162277660168379*uz[7]*rho[13]+0.3162277660168379*uz[2]*rho[12]+0.3162277660168379*uz[1]*rho[11]+0.3535533905932737*uz[3]*rho[10]+0.3162277660168379*uz[4]*rho[8]+0.3535533905932737*rho[3]*uz[7]+0.3162277660168379*uz[4]*rho[7]+0.3535533905932737*rho[5]*uz[6]+0.3535533905932737*uz[5]*rho[6]+0.3535533905932737*rho[0]*uz[4]+0.3535533905932737*uz[0]*rho[4]+0.3535533905932737*rho[1]*uz[2]+0.3535533905932737*uz[1]*rho[2]; 
  rhouz[5] = 0.2828427124746191*uz[7]*rho[24]+0.2828427124746191*uz[5]*rho[21]+0.3162277660168379*uz[6]*rho[19]+0.3162277660168379*uz[4]*rho[17]+0.3162277660168379*uz[7]*rho[16]+0.3162277660168379*uz[3]*rho[15]+0.3162277660168379*uz[1]*rho[13]+0.3162277660168379*uz[7]*rho[11]+0.3535533905932737*uz[2]*rho[10]+0.3162277660168379*uz[5]*rho[9]+0.3535533905932737*rho[2]*uz[7]+0.3162277660168379*uz[5]*rho[7]+0.3535533905932737*rho[4]*uz[6]+0.3535533905932737*uz[4]*rho[6]+0.3535533905932737*rho[0]*uz[5]+0.3535533905932737*uz[0]*rho[5]+0.3535533905932737*rho[1]*uz[3]+0.3535533905932737*uz[1]*rho[3]; 
  rhouz[6] = 0.2828427124746191*uz[7]*rho[25]+0.2828427124746191*uz[6]*rho[22]+0.3162277660168379*uz[5]*rho[19]+0.3162277660168379*uz[4]*rho[18]+0.3162277660168379*uz[3]*rho[16]+0.3162277660168379*uz[7]*rho[15]+0.3162277660168379*uz[2]*rho[14]+0.3162277660168379*uz[7]*rho[12]+0.3535533905932737*uz[1]*rho[10]+0.3162277660168379*uz[6]*rho[9]+0.3162277660168379*uz[6]*rho[8]+0.3535533905932737*rho[1]*uz[7]+0.3535533905932737*rho[0]*uz[6]+0.3535533905932737*uz[0]*rho[6]+0.3535533905932737*rho[4]*uz[5]+0.3535533905932737*uz[4]*rho[5]+0.3535533905932737*rho[2]*uz[3]+0.3535533905932737*uz[2]*rho[3]; 
  rhouz[7] = 0.2529822128134704*uz[7]*rho[26]+0.2828427124746191*uz[6]*rho[25]+0.2828427124746191*uz[5]*rho[24]+0.2828427124746191*uz[4]*rho[23]+0.2828427124746191*uz[7]*rho[22]+0.2828427124746191*uz[7]*rho[21]+0.2828427124746191*uz[7]*rho[20]+0.3162277660168379*uz[3]*rho[19]+0.3162277660168379*uz[2]*rho[18]+0.3162277660168379*uz[1]*rho[17]+0.3162277660168379*uz[5]*rho[16]+0.3162277660168379*uz[6]*rho[15]+0.3162277660168379*uz[4]*rho[14]+0.3162277660168379*uz[4]*rho[13]+0.3162277660168379*uz[6]*rho[12]+0.3162277660168379*uz[5]*rho[11]+0.3535533905932737*uz[0]*rho[10]+0.3162277660168379*uz[7]*rho[9]+0.3162277660168379*uz[7]*rho[8]+0.3162277660168379*rho[7]*uz[7]+0.3535533905932737*rho[0]*uz[7]+0.3535533905932737*rho[1]*uz[6]+0.3535533905932737*uz[1]*rho[6]+0.3535533905932737*rho[2]*uz[5]+0.3535533905932737*uz[2]*rho[5]+0.3535533905932737*rho[3]*uz[4]+0.3535533905932737*uz[3]*rho[4]; 

  // Order of integrated variables is (rho, rhoux, rhouy, rhouz, rho ux^2, rho uy^2, rho uz^2, p_parallel, p_perp) 
  int_pkpm_vars[0] += 2.828427124746191*rho[0]; 
  int_pkpm_vars[1] += 2.828427124746191*rhoux[0]; 
  int_pkpm_vars[2] += 2.828427124746191*rhouy[0]; 
  int_pkpm_vars[3] += 2.828427124746191*rhouz[0]; 
  int_pkpm_vars[4] += rhoux[7]*ux[7]+rhoux[6]*ux[6]+rhoux[5]*ux[5]+rhoux[4]*ux[4]+rhoux[3]*ux[3]+rhoux[2]*ux[2]+rhoux[1]*ux[1]+rhoux[0]*ux[0]; 
  int_pkpm_vars[5] += rhouy[7]*uy[7]+rhouy[6]*uy[6]+rhouy[5]*uy[5]+rhouy[4]*uy[4]+rhouy[3]*uy[3]+rhouy[2]*uy[2]+rhouy[1]*uy[1]+rhouy[0]*uy[0]; 
  int_pkpm_vars[6] += rhouz[7]*uz[7]+rhouz[6]*uz[6]+rhouz[5]*uz[5]+rhouz[4]*uz[4]+rhouz[3]*uz[3]+rhouz[2]*uz[2]+rhouz[1]*uz[1]+rhouz[0]*uz[0]; 
  int_pkpm_vars[7] += 2.828427124746191*p_parallel[0]; 
  int_pkpm_vars[8] += 2.828427124746191*p_perp[0]; 
} 
