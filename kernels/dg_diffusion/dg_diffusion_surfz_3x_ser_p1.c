#include <gkyl_dg_diffusion_kernels.h>

GKYL_CU_DH double
dg_diffusion_surfz_3x_ser_p1(const double* w, const double* dx,
  const double* D,
  const double* ql, const double* qc, const double* qr,
  double* GKYL_RESTRICT out) 
{
  // w[NDIM]: Cell-center coordinates
  // dxv[NDIM]: Cell spacing
  // D: Diffusion coefficient in the center cell
  // ql: Input field in the left cell
  // qc: Input field in the center cell
  // qr: Input field in the right cell
  // out: Incremented output

  const double J = 4/dx[2]/dx[2];

  out[0] += J*((-0.3314563036811939*qr[7]*D[23])-0.3314563036811939*ql[7]*D[23]-0.6629126073623879*qc[7]*D[23]+0.3444594950788841*qr[4]*D[23]-0.3444594950788841*ql[4]*D[23]-0.3314563036811939*qr[6]*D[22]-0.3314563036811939*ql[6]*D[22]-0.6629126073623879*qc[6]*D[22]+0.3444594950788841*qr[2]*D[22]-0.3444594950788841*ql[2]*D[22]-0.3314563036811939*qr[5]*D[21]-0.3314563036811939*ql[5]*D[21]-0.6629126073623879*qc[5]*D[21]+0.3444594950788841*qr[1]*D[21]-0.3444594950788841*ql[1]*D[21]-0.1913663861549356*qr[7]*D[20]+0.1913663861549356*ql[7]*D[20]+0.1988737822087163*qr[4]*D[20]+0.1988737822087163*ql[4]*D[20]-0.3977475644174328*qc[4]*D[20]-0.3314563036811939*qr[3]*D[19]-0.3314563036811939*ql[3]*D[19]-0.6629126073623879*qc[3]*D[19]+0.3444594950788841*qr[0]*D[19]-0.3444594950788841*ql[0]*D[19]-0.1913663861549356*qr[6]*D[18]+0.1913663861549356*ql[6]*D[18]+0.1988737822087163*qr[2]*D[18]+0.1988737822087163*ql[2]*D[18]-0.3977475644174328*qc[2]*D[18]-0.1913663861549356*qr[5]*D[17]+0.1913663861549356*ql[5]*D[17]+0.1988737822087163*qr[1]*D[17]+0.1988737822087163*ql[1]*D[17]-0.3977475644174328*qc[1]*D[17]-0.1913663861549356*qr[3]*D[16]+0.1913663861549356*ql[3]*D[16]+0.1988737822087163*qr[0]*D[16]+0.1988737822087163*ql[0]*D[16]-0.3977475644174328*qc[0]*D[16]);
  out[1] += J*((-0.3314563036811939*qr[6]*D[23])-0.3314563036811939*ql[6]*D[23]-0.6629126073623879*qc[6]*D[23]+0.3444594950788841*qr[2]*D[23]-0.3444594950788841*ql[2]*D[23]-0.3314563036811939*qr[7]*D[22]-0.3314563036811939*ql[7]*D[22]-0.6629126073623879*qc[7]*D[22]+0.3444594950788841*qr[4]*D[22]-0.3444594950788841*ql[4]*D[22]-0.3314563036811939*qr[3]*D[21]-0.3314563036811939*ql[3]*D[21]-0.6629126073623879*qc[3]*D[21]+0.3444594950788841*qr[0]*D[21]-0.3444594950788841*ql[0]*D[21]-0.1913663861549356*qr[6]*D[20]+0.1913663861549356*ql[6]*D[20]+0.1988737822087163*qr[2]*D[20]+0.1988737822087163*ql[2]*D[20]-0.3977475644174328*qc[2]*D[20]-0.3314563036811939*qr[5]*D[19]-0.3314563036811939*ql[5]*D[19]-0.6629126073623879*qc[5]*D[19]+0.3444594950788841*qr[1]*D[19]-0.3444594950788841*ql[1]*D[19]-0.1913663861549356*qr[7]*D[18]+0.1913663861549356*ql[7]*D[18]+0.1988737822087163*qr[4]*D[18]+0.1988737822087163*ql[4]*D[18]-0.3977475644174328*qc[4]*D[18]-0.1913663861549356*qr[3]*D[17]+0.1913663861549356*ql[3]*D[17]+0.1988737822087163*qr[0]*D[17]+0.1988737822087163*ql[0]*D[17]-0.3977475644174328*qc[0]*D[17]-0.1913663861549356*qr[5]*D[16]+0.1913663861549356*ql[5]*D[16]+0.1988737822087163*qr[1]*D[16]+0.1988737822087163*ql[1]*D[16]-0.3977475644174328*qc[1]*D[16]);
  out[2] += J*((-0.3314563036811939*qr[5]*D[23])-0.3314563036811939*ql[5]*D[23]-0.6629126073623879*qc[5]*D[23]+0.3444594950788841*qr[1]*D[23]-0.3444594950788841*ql[1]*D[23]-0.3314563036811939*qr[3]*D[22]-0.3314563036811939*ql[3]*D[22]-0.6629126073623879*qc[3]*D[22]+0.3444594950788841*qr[0]*D[22]-0.3444594950788841*ql[0]*D[22]-0.3314563036811939*qr[7]*D[21]-0.3314563036811939*ql[7]*D[21]-0.6629126073623879*qc[7]*D[21]+0.3444594950788841*qr[4]*D[21]-0.3444594950788841*ql[4]*D[21]-0.1913663861549356*qr[5]*D[20]+0.1913663861549356*ql[5]*D[20]+0.1988737822087163*qr[1]*D[20]+0.1988737822087163*ql[1]*D[20]-0.3977475644174328*qc[1]*D[20]-0.3314563036811939*qr[6]*D[19]-0.3314563036811939*ql[6]*D[19]-0.6629126073623879*qc[6]*D[19]+0.3444594950788841*qr[2]*D[19]-0.3444594950788841*ql[2]*D[19]-0.1913663861549356*qr[3]*D[18]+0.1913663861549356*ql[3]*D[18]+0.1988737822087163*qr[0]*D[18]+0.1988737822087163*ql[0]*D[18]-0.3977475644174328*qc[0]*D[18]-0.1913663861549356*qr[7]*D[17]+0.1913663861549356*ql[7]*D[17]+0.1988737822087163*qr[4]*D[17]+0.1988737822087163*ql[4]*D[17]-0.3977475644174328*qc[4]*D[17]-0.1913663861549356*qr[6]*D[16]+0.1913663861549356*ql[6]*D[16]+0.1988737822087163*qr[2]*D[16]+0.1988737822087163*ql[2]*D[16]-0.3977475644174328*qc[2]*D[16]);
  out[3] += J*((-0.2679129406169099*qr[7]*D[23])+0.2679129406169099*ql[7]*D[23]+0.3314563036811939*qr[4]*D[23]+0.3314563036811939*ql[4]*D[23]-0.6629126073623879*qc[4]*D[23]-0.2679129406169099*qr[6]*D[22]+0.2679129406169099*ql[6]*D[22]+0.3314563036811939*qr[2]*D[22]+0.3314563036811939*ql[2]*D[22]-0.6629126073623879*qc[2]*D[22]-0.2679129406169099*qr[5]*D[21]+0.2679129406169099*ql[5]*D[21]+0.3314563036811939*qr[1]*D[21]+0.3314563036811939*ql[1]*D[21]-0.6629126073623879*qc[1]*D[21]-0.1546796083845572*qr[7]*D[20]-0.1546796083845572*ql[7]*D[20]-1.016465997955661*qc[7]*D[20]+0.1913663861549356*qr[4]*D[20]-0.1913663861549356*ql[4]*D[20]-0.2679129406169099*qr[3]*D[19]+0.2679129406169099*ql[3]*D[19]+0.3314563036811939*qr[0]*D[19]+0.3314563036811939*ql[0]*D[19]-0.6629126073623879*qc[0]*D[19]-0.1546796083845572*qr[6]*D[18]-0.1546796083845572*ql[6]*D[18]-1.016465997955661*qc[6]*D[18]+0.1913663861549356*qr[2]*D[18]-0.1913663861549356*ql[2]*D[18]-0.1546796083845572*qr[5]*D[17]-0.1546796083845572*ql[5]*D[17]-1.016465997955661*qc[5]*D[17]+0.1913663861549356*qr[1]*D[17]-0.1913663861549356*ql[1]*D[17]-0.1546796083845572*qr[3]*D[16]-0.1546796083845572*ql[3]*D[16]-1.016465997955661*qc[3]*D[16]+0.1913663861549356*qr[0]*D[16]-0.1913663861549356*ql[0]*D[16]);
  out[4] += J*((-0.3314563036811939*qr[3]*D[23])-0.3314563036811939*ql[3]*D[23]-0.6629126073623879*qc[3]*D[23]+0.3444594950788841*qr[0]*D[23]-0.3444594950788841*ql[0]*D[23]-0.3314563036811939*qr[5]*D[22]-0.3314563036811939*ql[5]*D[22]-0.6629126073623879*qc[5]*D[22]+0.3444594950788841*qr[1]*D[22]-0.3444594950788841*ql[1]*D[22]-0.3314563036811939*qr[6]*D[21]-0.3314563036811939*ql[6]*D[21]-0.6629126073623879*qc[6]*D[21]+0.3444594950788841*qr[2]*D[21]-0.3444594950788841*ql[2]*D[21]-0.1913663861549356*qr[3]*D[20]+0.1913663861549356*ql[3]*D[20]+0.1988737822087163*qr[0]*D[20]+0.1988737822087163*ql[0]*D[20]-0.3977475644174328*qc[0]*D[20]-0.3314563036811939*qr[7]*D[19]-0.3314563036811939*ql[7]*D[19]-0.6629126073623879*qc[7]*D[19]+0.3444594950788841*qr[4]*D[19]-0.3444594950788841*ql[4]*D[19]-0.1913663861549356*qr[5]*D[18]+0.1913663861549356*ql[5]*D[18]+0.1988737822087163*qr[1]*D[18]+0.1988737822087163*ql[1]*D[18]-0.3977475644174328*qc[1]*D[18]-0.1913663861549356*qr[6]*D[17]+0.1913663861549356*ql[6]*D[17]+0.1988737822087163*qr[2]*D[17]+0.1988737822087163*ql[2]*D[17]-0.3977475644174328*qc[2]*D[17]-0.1913663861549356*qr[7]*D[16]+0.1913663861549356*ql[7]*D[16]+0.1988737822087163*qr[4]*D[16]+0.1988737822087163*ql[4]*D[16]-0.3977475644174328*qc[4]*D[16]);
  out[5] += J*((-0.2679129406169099*qr[6]*D[23])+0.2679129406169099*ql[6]*D[23]+0.3314563036811939*qr[2]*D[23]+0.3314563036811939*ql[2]*D[23]-0.6629126073623879*qc[2]*D[23]-0.2679129406169099*qr[7]*D[22]+0.2679129406169099*ql[7]*D[22]+0.3314563036811939*qr[4]*D[22]+0.3314563036811939*ql[4]*D[22]-0.6629126073623879*qc[4]*D[22]-0.2679129406169099*qr[3]*D[21]+0.2679129406169099*ql[3]*D[21]+0.3314563036811939*qr[0]*D[21]+0.3314563036811939*ql[0]*D[21]-0.6629126073623879*qc[0]*D[21]-0.1546796083845572*qr[6]*D[20]-0.1546796083845572*ql[6]*D[20]-1.016465997955661*qc[6]*D[20]+0.1913663861549356*qr[2]*D[20]-0.1913663861549356*ql[2]*D[20]-0.2679129406169099*qr[5]*D[19]+0.2679129406169099*ql[5]*D[19]+0.3314563036811939*qr[1]*D[19]+0.3314563036811939*ql[1]*D[19]-0.6629126073623879*qc[1]*D[19]-0.1546796083845572*qr[7]*D[18]-0.1546796083845572*ql[7]*D[18]-1.016465997955661*qc[7]*D[18]+0.1913663861549356*qr[4]*D[18]-0.1913663861549356*ql[4]*D[18]-0.1546796083845572*qr[3]*D[17]-0.1546796083845572*ql[3]*D[17]-1.016465997955661*qc[3]*D[17]+0.1913663861549356*qr[0]*D[17]-0.1913663861549356*ql[0]*D[17]-0.1546796083845572*qr[5]*D[16]-0.1546796083845572*ql[5]*D[16]-1.016465997955661*qc[5]*D[16]+0.1913663861549356*qr[1]*D[16]-0.1913663861549356*ql[1]*D[16]);
  out[6] += J*((-0.2679129406169099*qr[5]*D[23])+0.2679129406169099*ql[5]*D[23]+0.3314563036811939*qr[1]*D[23]+0.3314563036811939*ql[1]*D[23]-0.6629126073623879*qc[1]*D[23]-0.2679129406169099*qr[3]*D[22]+0.2679129406169099*ql[3]*D[22]+0.3314563036811939*qr[0]*D[22]+0.3314563036811939*ql[0]*D[22]-0.6629126073623879*qc[0]*D[22]-0.2679129406169099*qr[7]*D[21]+0.2679129406169099*ql[7]*D[21]+0.3314563036811939*qr[4]*D[21]+0.3314563036811939*ql[4]*D[21]-0.6629126073623879*qc[4]*D[21]-0.1546796083845572*qr[5]*D[20]-0.1546796083845572*ql[5]*D[20]-1.016465997955661*qc[5]*D[20]+0.1913663861549356*qr[1]*D[20]-0.1913663861549356*ql[1]*D[20]-0.2679129406169099*qr[6]*D[19]+0.2679129406169099*ql[6]*D[19]+0.3314563036811939*qr[2]*D[19]+0.3314563036811939*ql[2]*D[19]-0.6629126073623879*qc[2]*D[19]-0.1546796083845572*qr[3]*D[18]-0.1546796083845572*ql[3]*D[18]-1.016465997955661*qc[3]*D[18]+0.1913663861549356*qr[0]*D[18]-0.1913663861549356*ql[0]*D[18]-0.1546796083845572*qr[7]*D[17]-0.1546796083845572*ql[7]*D[17]-1.016465997955661*qc[7]*D[17]+0.1913663861549356*qr[4]*D[17]-0.1913663861549356*ql[4]*D[17]-0.1546796083845572*qr[6]*D[16]-0.1546796083845572*ql[6]*D[16]-1.016465997955661*qc[6]*D[16]+0.1913663861549356*qr[2]*D[16]-0.1913663861549356*ql[2]*D[16]);
  out[7] += J*((-0.2679129406169099*qr[3]*D[23])+0.2679129406169099*ql[3]*D[23]+0.3314563036811939*qr[0]*D[23]+0.3314563036811939*ql[0]*D[23]-0.6629126073623879*qc[0]*D[23]-0.2679129406169099*qr[5]*D[22]+0.2679129406169099*ql[5]*D[22]+0.3314563036811939*qr[1]*D[22]+0.3314563036811939*ql[1]*D[22]-0.6629126073623879*qc[1]*D[22]-0.2679129406169099*qr[6]*D[21]+0.2679129406169099*ql[6]*D[21]+0.3314563036811939*qr[2]*D[21]+0.3314563036811939*ql[2]*D[21]-0.6629126073623879*qc[2]*D[21]-0.1546796083845572*qr[3]*D[20]-0.1546796083845572*ql[3]*D[20]-1.016465997955661*qc[3]*D[20]+0.1913663861549356*qr[0]*D[20]-0.1913663861549356*ql[0]*D[20]-0.2679129406169099*qr[7]*D[19]+0.2679129406169099*ql[7]*D[19]+0.3314563036811939*qr[4]*D[19]+0.3314563036811939*ql[4]*D[19]-0.6629126073623879*qc[4]*D[19]-0.1546796083845572*qr[5]*D[18]-0.1546796083845572*ql[5]*D[18]-1.016465997955661*qc[5]*D[18]+0.1913663861549356*qr[1]*D[18]-0.1913663861549356*ql[1]*D[18]-0.1546796083845572*qr[6]*D[17]-0.1546796083845572*ql[6]*D[17]-1.016465997955661*qc[6]*D[17]+0.1913663861549356*qr[2]*D[17]-0.1913663861549356*ql[2]*D[17]-0.1546796083845572*qr[7]*D[16]-0.1546796083845572*ql[7]*D[16]-1.016465997955661*qc[7]*D[16]+0.1913663861549356*qr[4]*D[16]-0.1913663861549356*ql[4]*D[16]);

  return 0.;

}
