#include <gkyl_bc_twistshift_gyrokinetic_kernels.h> 
 
GKYL_CU_DH void twistShift_xlimdg_2x_ser_p1yshift_p1(double sFac, const double *xLimLo, const double *xLimUp, double yLimLo, double yLimUp, double dyDo, double yOff, const double *ySh, struct gkyl_mat *tsmat) 
{ 
  // sFac:   scale factor, typically +/- 1.0.
  // xLimUp: 1D DG expansion of the function xLimLo(y) giving the lower limit of the x integral.
  // xLimLo: 1D DG expansion of the function xLimUp(y) giving the upper limit of the x integral.
  // yLimLo: lower limit of the y integral in [-1,1] logical space.
  // yLimUp: upper limit of the y integral in [-1,1] logical space.
  // dyDo:   y cell length of the donor cell.
  // yOff:   yOffset between the donor and target cells (in the direction of the shift).
  // ySh:    yShift translated to [-1,1] logical space.
  // tsmat: twist-shift matrices.

  // Length of the subregion in which the DG expansion of the yLimLo/yLimUp functions are defined.
  double dyLim = yLimUp-yLimLo;

  // Logical center of the subregion in which the DG expansion of the yLimLo/yLimUp functions are defined.
  double ycLim = 0.5*(yLimUp+yLimLo);

  double yLimLoR2 = pow(yLimLo,2);
  double yLimLoR3 = pow(yLimLo,3);
  double yLimLoR4 = pow(yLimLo,4);
  double yLimLoR5 = pow(yLimLo,5);
  double yLimLoR6 = pow(yLimLo,6);
  double yLimUpR2 = pow(yLimUp,2);
  double yLimUpR3 = pow(yLimUp,3);
  double yLimUpR4 = pow(yLimUp,4);
  double yLimUpR5 = pow(yLimUp,5);
  double yLimUpR6 = pow(yLimUp,6);
  double dyLimR2 = pow(dyLim,2);
  double dyLimR3 = pow(dyLim,3);
  double dyLimR4 = pow(dyLim,4);
  double ycLimR2 = pow(ycLim,2);
  double ycLimR3 = pow(ycLim,3);
  double ycLimR4 = pow(ycLim,4);
  double xLimLo0R2 = pow(xLimLo[0],2);
  double xLimLo1R2 = pow(xLimLo[1],2);
  double xLimLo0R3 = pow(xLimLo[0],3);
  double xLimLo1R3 = pow(xLimLo[1],3);
  double xLimLo0R4 = pow(xLimLo[0],4);
  double xLimLo1R4 = pow(xLimLo[1],4);
  double xLimUp0R2 = pow(xLimUp[0],2);
  double xLimUp1R2 = pow(xLimUp[1],2);
  double xLimUp0R3 = pow(xLimUp[0],3);
  double xLimUp1R3 = pow(xLimUp[1],3);
  double xLimUp0R4 = pow(xLimUp[0],4);
  double xLimUp1R4 = pow(xLimUp[1],4);

  gkyl_mat_inc(tsmat, 0,0, -((0.125*(((4.898979485566357*xLimUp[1]-4.898979485566357*xLimLo[1])*sFac*yLimUp+(4.898979485566357*xLimLo[1]-4.898979485566357*xLimUp[1])*sFac*yLimLo)*ycLim+(2.4494897427831783*xLimLo[1]-2.4494897427831783*xLimUp[1])*sFac*yLimUpR2+(1.4142135623730951*xLimLo[0]-1.4142135623730951*xLimUp[0])*dyLim*sFac*yLimUp+(2.4494897427831783*xLimUp[1]-2.4494897427831783*xLimLo[1])*sFac*yLimLoR2+(1.4142135623730951*xLimUp[0]-1.4142135623730951*xLimLo[0])*dyLim*sFac*yLimLo))/dyLim)); 
  gkyl_mat_inc(tsmat, 0,1, (0.0625*(((20.784609690826525*xLimUp1R2-20.784609690826525*xLimLo1R2)*sFac*yLimUp+(20.784609690826525*xLimLo1R2-20.784609690826525*xLimUp1R2)*sFac*yLimLo)*ycLimR2+((20.784609690826525*xLimLo1R2-20.784609690826525*xLimUp1R2)*sFac*yLimUpR2+(12.0*xLimLo[0]*xLimLo[1]-12.0*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimUp+(20.784609690826525*xLimUp1R2-20.784609690826525*xLimLo1R2)*sFac*yLimLoR2+(12.0*xLimUp[0]*xLimUp[1]-12.0*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimLo)*ycLim+(6.928203230275509*xLimUp1R2-6.928203230275509*xLimLo1R2)*sFac*yLimUpR3+(6.0*xLimUp[0]*xLimUp[1]-6.0*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimUpR2+(1.7320508075688772*xLimUp0R2-1.7320508075688772*xLimLo0R2)*dyLimR2*sFac*yLimUp+(6.928203230275509*xLimLo1R2-6.928203230275509*xLimUp1R2)*sFac*yLimLoR3+(6.0*xLimLo[0]*xLimLo[1]-6.0*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimLoR2+(1.7320508075688772*xLimLo0R2-1.7320508075688772*xLimUp0R2)*dyLimR2*sFac*yLimLo))/dyLimR2); 
  gkyl_mat_inc(tsmat, 0,2, -((0.0625*(((8.485281374238571*xLimUp[1]-8.485281374238571*xLimLo[1])*sFac*yLimUpR2+(8.485281374238571*xLimLo[1]-8.485281374238571*xLimUp[1])*sFac*yLimLoR2)*ycLim+(5.656854249492383*xLimLo[1]-5.656854249492383*xLimUp[1])*sFac*yLimUpR3+(2.4494897427831783*xLimLo[0]-2.4494897427831783*xLimUp[0])*dyLim*sFac*yLimUpR2+(5.656854249492383*xLimUp[1]-5.656854249492383*xLimLo[1])*sFac*yLimLoR3+(2.4494897427831783*xLimUp[0]-2.4494897427831783*xLimLo[0])*dyLim*sFac*yLimLoR2))/dyLim)); 
  gkyl_mat_inc(tsmat, 0,3, (0.03125*(((36.0*xLimUp1R2-36.0*xLimLo1R2)*sFac*yLimUpR2+(36.0*xLimLo1R2-36.0*xLimUp1R2)*sFac*yLimLoR2)*ycLimR2+((48.0*xLimLo1R2-48.0*xLimUp1R2)*sFac*yLimUpR3+(20.784609690826525*xLimLo[0]*xLimLo[1]-20.784609690826525*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimUpR2+(48.0*xLimUp1R2-48.0*xLimLo1R2)*sFac*yLimLoR3+(20.784609690826525*xLimUp[0]*xLimUp[1]-20.784609690826525*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimLoR2)*ycLim+(18.0*xLimUp1R2-18.0*xLimLo1R2)*sFac*yLimUpR4+(13.856406460551018*xLimUp[0]*xLimUp[1]-13.856406460551018*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimUpR3+(3.0*xLimUp0R2-3.0*xLimLo0R2)*dyLimR2*sFac*yLimUpR2+(18.0*xLimLo1R2-18.0*xLimUp1R2)*sFac*yLimLoR4+(13.856406460551018*xLimLo[0]*xLimLo[1]-13.856406460551018*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimLoR3+(3.0*xLimLo0R2-3.0*xLimUp0R2)*dyLimR2*sFac*yLimLoR2))/dyLimR2); 
  gkyl_mat_inc(tsmat, 1,0, (0.0625*(((20.784609690826525*xLimUp1R2-20.784609690826525*xLimLo1R2)*sFac*yLimUp+(20.784609690826525*xLimLo1R2-20.784609690826525*xLimUp1R2)*sFac*yLimLo)*ycLimR2+((20.784609690826525*xLimLo1R2-20.784609690826525*xLimUp1R2)*sFac*yLimUpR2+(12.0*xLimLo[0]*xLimLo[1]-12.0*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimUp+(20.784609690826525*xLimUp1R2-20.784609690826525*xLimLo1R2)*sFac*yLimLoR2+(12.0*xLimUp[0]*xLimUp[1]-12.0*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimLo)*ycLim+(6.928203230275509*xLimUp1R2-6.928203230275509*xLimLo1R2)*sFac*yLimUpR3+(6.0*xLimUp[0]*xLimUp[1]-6.0*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimUpR2+(1.7320508075688772*xLimUp0R2-1.7320508075688772*xLimLo0R2)*dyLimR2*sFac*yLimUp+(6.928203230275509*xLimLo1R2-6.928203230275509*xLimUp1R2)*sFac*yLimLoR3+(6.0*xLimLo[0]*xLimLo[1]-6.0*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimLoR2+(1.7320508075688772*xLimLo0R2-1.7320508075688772*xLimUp0R2)*dyLimR2*sFac*yLimLo))/dyLimR2); 
  gkyl_mat_inc(tsmat, 1,1, -((0.0625*(((58.787753826796305*xLimUp1R3-58.787753826796305*xLimLo1R3)*sFac*yLimUp+(58.787753826796305*xLimLo1R3-58.787753826796305*xLimUp1R3)*sFac*yLimLo)*ycLimR3+((88.18163074019444*xLimLo1R3-88.18163074019444*xLimUp1R3)*sFac*yLimUpR2+(50.91168824543145*xLimLo[0]*xLimLo1R2-50.91168824543145*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimUp+(88.18163074019444*xLimUp1R3-88.18163074019444*xLimLo1R3)*sFac*yLimLoR2+(50.91168824543145*xLimUp[0]*xLimUp1R2-50.91168824543145*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimLo)*ycLimR2+((58.787753826796305*xLimUp1R3-58.787753826796305*xLimLo1R3)*sFac*yLimUpR3+(50.91168824543145*xLimUp[0]*xLimUp1R2-50.91168824543145*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimUpR2+(14.696938456699069*xLimUp0R2*xLimUp[1]-14.696938456699069*xLimLo0R2*xLimLo[1])*dyLimR2*sFac*yLimUp+(58.787753826796305*xLimLo1R3-58.787753826796305*xLimUp1R3)*sFac*yLimLoR3+(50.91168824543145*xLimLo[0]*xLimLo1R2-50.91168824543145*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimLoR2+(14.696938456699069*xLimLo0R2*xLimLo[1]-14.696938456699069*xLimUp0R2*xLimUp[1])*dyLimR2*sFac*yLimLo)*ycLim+(14.696938456699069*xLimLo1R3-14.696938456699069*xLimUp1R3)*sFac*yLimUpR4+(16.97056274847715*xLimLo[0]*xLimLo1R2-16.97056274847715*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimUpR3+(7.348469228349534*xLimLo0R2*xLimLo[1]-7.348469228349534*xLimUp0R2*xLimUp[1])*dyLimR2*sFac*yLimUpR2+(1.4142135623730951*xLimLo0R3-1.4142135623730951*xLimUp0R3)*dyLimR3*sFac*yLimUp+(14.696938456699069*xLimUp1R3-14.696938456699069*xLimLo1R3)*sFac*yLimLoR4+(16.97056274847715*xLimUp[0]*xLimUp1R2-16.97056274847715*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimLoR3+(7.348469228349534*xLimUp0R2*xLimUp[1]-7.348469228349534*xLimLo0R2*xLimLo[1])*dyLimR2*sFac*yLimLoR2+(1.4142135623730951*xLimUp0R3-1.4142135623730951*xLimLo0R3)*dyLimR3*sFac*yLimLo))/dyLimR3)); 
  gkyl_mat_inc(tsmat, 1,2, (0.03125*(((36.0*xLimUp1R2-36.0*xLimLo1R2)*sFac*yLimUpR2+(36.0*xLimLo1R2-36.0*xLimUp1R2)*sFac*yLimLoR2)*ycLimR2+((48.0*xLimLo1R2-48.0*xLimUp1R2)*sFac*yLimUpR3+(20.784609690826525*xLimLo[0]*xLimLo[1]-20.784609690826525*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimUpR2+(48.0*xLimUp1R2-48.0*xLimLo1R2)*sFac*yLimLoR3+(20.784609690826525*xLimUp[0]*xLimUp[1]-20.784609690826525*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimLoR2)*ycLim+(18.0*xLimUp1R2-18.0*xLimLo1R2)*sFac*yLimUpR4+(13.856406460551018*xLimUp[0]*xLimUp[1]-13.856406460551018*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimUpR3+(3.0*xLimUp0R2-3.0*xLimLo0R2)*dyLimR2*sFac*yLimUpR2+(18.0*xLimLo1R2-18.0*xLimUp1R2)*sFac*yLimLoR4+(13.856406460551018*xLimLo[0]*xLimLo[1]-13.856406460551018*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimLoR3+(3.0*xLimLo0R2-3.0*xLimUp0R2)*dyLimR2*sFac*yLimLoR2))/dyLimR2); 
  gkyl_mat_inc(tsmat, 1,3, -((0.00625*(((509.1168824543146*xLimUp1R3-509.1168824543146*xLimLo1R3)*sFac*yLimUpR2+(509.1168824543146*xLimLo1R3-509.1168824543146*xLimUp1R3)*sFac*yLimLoR2)*ycLimR3+((1018.2337649086295*xLimLo1R3-1018.2337649086295*xLimUp1R3)*sFac*yLimUpR3+(440.9081537009722*xLimLo[0]*xLimLo1R2-440.9081537009722*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimUpR2+(1018.2337649086295*xLimUp1R3-1018.2337649086295*xLimLo1R3)*sFac*yLimLoR3+(440.9081537009722*xLimUp[0]*xLimUp1R2-440.9081537009722*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimLoR2)*ycLimR2+((763.6753236814717*xLimUp1R3-763.6753236814717*xLimLo1R3)*sFac*yLimUpR4+(587.8775382679632*xLimUp[0]*xLimUp1R2-587.8775382679632*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimUpR3+(127.27922061357859*xLimUp0R2*xLimUp[1]-127.27922061357859*xLimLo0R2*xLimLo[1])*dyLimR2*sFac*yLimUpR2+(763.6753236814717*xLimLo1R3-763.6753236814717*xLimUp1R3)*sFac*yLimLoR4+(587.8775382679632*xLimLo[0]*xLimLo1R2-587.8775382679632*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimLoR3+(127.27922061357859*xLimLo0R2*xLimLo[1]-127.27922061357859*xLimUp0R2*xLimUp[1])*dyLimR2*sFac*yLimLoR2)*ycLim+(203.64675298172588*xLimLo1R3-203.64675298172588*xLimUp1R3)*sFac*yLimUpR5+(220.45407685048605*xLimLo[0]*xLimLo1R2-220.45407685048605*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimUpR4+(84.85281374238575*xLimLo0R2*xLimLo[1]-84.85281374238575*xLimUp0R2*xLimUp[1])*dyLimR2*sFac*yLimUpR3+(12.24744871391589*xLimLo0R3-12.24744871391589*xLimUp0R3)*dyLimR3*sFac*yLimUpR2+(203.64675298172588*xLimUp1R3-203.64675298172588*xLimLo1R3)*sFac*yLimLoR5+(220.45407685048605*xLimUp[0]*xLimUp1R2-220.45407685048605*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimLoR4+(84.85281374238575*xLimUp0R2*xLimUp[1]-84.85281374238575*xLimLo0R2*xLimLo[1])*dyLimR2*sFac*yLimLoR3+(12.24744871391589*xLimUp0R3-12.24744871391589*xLimLo0R3)*dyLimR3*sFac*yLimLoR2))/dyLimR3)); 
  gkyl_mat_inc(tsmat, 2,0, (0.0625*(((50.91168824543145*xLimUp1R2-50.91168824543145*xLimLo1R2)*ySh[1]*sFac*yLimUp+(50.91168824543145*xLimLo1R2-50.91168824543145*xLimUp1R2)*ySh[1]*sFac*yLimLo)*ycLimR2+(((33.94112549695431*xLimUp[1]-33.94112549695431*xLimLo[1])*dyLim*sFac*yLimUp+(33.94112549695431*xLimLo[1]-33.94112549695431*xLimUp[1])*dyLim*sFac*yLimLo)*yOff+((8.485281374238571*xLimLo[1]-8.485281374238571*xLimUp[1])*dyDo*dyLim+(50.91168824543145*xLimLo1R2-50.91168824543145*xLimUp1R2)*ySh[1])*sFac*yLimUpR2+((29.39387691339815*xLimLo[0]*xLimLo[1]-29.39387691339815*xLimUp[0]*xLimUp[1])*ySh[1]-24.0*ySh[0]*xLimUp[1]+24.0*ySh[0]*xLimLo[1])*dyLim*sFac*yLimUp+((8.485281374238571*xLimUp[1]-8.485281374238571*xLimLo[1])*dyDo*dyLim+(50.91168824543145*xLimUp1R2-50.91168824543145*xLimLo1R2)*ySh[1])*sFac*yLimLoR2+((29.39387691339815*xLimUp[0]*xLimUp[1]-29.39387691339815*xLimLo[0]*xLimLo[1])*ySh[1]+24.0*ySh[0]*xLimUp[1]-24.0*ySh[0]*xLimLo[1])*dyLim*sFac*yLimLo)*ycLim+((16.97056274847715*xLimLo[1]-16.97056274847715*xLimUp[1])*dyLim*sFac*yLimUpR2+(9.797958971132717*xLimLo[0]-9.797958971132717*xLimUp[0])*dyLimR2*sFac*yLimUp+(16.97056274847715*xLimUp[1]-16.97056274847715*xLimLo[1])*dyLim*sFac*yLimLoR2+(9.797958971132717*xLimUp[0]-9.797958971132717*xLimLo[0])*dyLimR2*sFac*yLimLo)*yOff+((5.656854249492383*xLimUp[1]-5.656854249492383*xLimLo[1])*dyDo*dyLim+(16.97056274847715*xLimUp1R2-16.97056274847715*xLimLo1R2)*ySh[1])*sFac*yLimUpR3+((2.4494897427831783*xLimUp[0]-2.4494897427831783*xLimLo[0])*dyDo*dyLimR2+((14.696938456699069*xLimUp[0]*xLimUp[1]-14.696938456699069*xLimLo[0]*xLimLo[1])*ySh[1]+12.0*ySh[0]*xLimUp[1]-12.0*ySh[0]*xLimLo[1])*dyLim)*sFac*yLimUpR2+((4.242640687119286*xLimUp0R2-4.242640687119286*xLimLo0R2)*ySh[1]+(6.928203230275509*xLimUp[0]-6.928203230275509*xLimLo[0])*ySh[0])*dyLimR2*sFac*yLimUp+((5.656854249492383*xLimLo[1]-5.656854249492383*xLimUp[1])*dyDo*dyLim+(16.97056274847715*xLimLo1R2-16.97056274847715*xLimUp1R2)*ySh[1])*sFac*yLimLoR3+((2.4494897427831783*xLimLo[0]-2.4494897427831783*xLimUp[0])*dyDo*dyLimR2+((14.696938456699069*xLimLo[0]*xLimLo[1]-14.696938456699069*xLimUp[0]*xLimUp[1])*ySh[1]-12.0*ySh[0]*xLimUp[1]+12.0*ySh[0]*xLimLo[1])*dyLim)*sFac*yLimLoR2+((4.242640687119286*xLimLo0R2-4.242640687119286*xLimUp0R2)*ySh[1]+(6.928203230275509*xLimLo[0]-6.928203230275509*xLimUp[0])*ySh[0])*dyLimR2*sFac*yLimLo))/(dyDo*dyLimR2)); 
  gkyl_mat_inc(tsmat, 2,1, -((0.03125*(((288.0*xLimUp1R3-288.0*xLimLo1R3)*ySh[1]*sFac*yLimUp+(288.0*xLimLo1R3-288.0*xLimUp1R3)*ySh[1]*sFac*yLimLo)*ycLimR3+(((144.0*xLimUp1R2-144.0*xLimLo1R2)*dyLim*sFac*yLimUp+(144.0*xLimLo1R2-144.0*xLimUp1R2)*dyLim*sFac*yLimLo)*yOff+((36.0*xLimLo1R2-36.0*xLimUp1R2)*dyDo*dyLim+(432.0*xLimLo1R3-432.0*xLimUp1R3)*ySh[1])*sFac*yLimUpR2+((249.41531628991828*xLimLo[0]*xLimLo1R2-249.41531628991828*xLimUp[0]*xLimUp1R2)*ySh[1]-101.82337649086291*ySh[0]*xLimUp1R2+101.82337649086291*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimUp+((36.0*xLimUp1R2-36.0*xLimLo1R2)*dyDo*dyLim+(432.0*xLimUp1R3-432.0*xLimLo1R3)*ySh[1])*sFac*yLimLoR2+((249.41531628991828*xLimUp[0]*xLimUp1R2-249.41531628991828*xLimLo[0]*xLimLo1R2)*ySh[1]+101.82337649086291*ySh[0]*xLimUp1R2-101.82337649086291*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimLo)*ycLimR2+(((144.0*xLimLo1R2-144.0*xLimUp1R2)*dyLim*sFac*yLimUpR2+(83.1384387633061*xLimLo[0]*xLimLo[1]-83.1384387633061*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimUp+(144.0*xLimUp1R2-144.0*xLimLo1R2)*dyLim*sFac*yLimLoR2+(83.1384387633061*xLimUp[0]*xLimUp[1]-83.1384387633061*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimLo)*yOff+((48.0*xLimUp1R2-48.0*xLimLo1R2)*dyDo*dyLim+(288.0*xLimUp1R3-288.0*xLimLo1R3)*ySh[1])*sFac*yLimUpR3+((20.784609690826525*xLimUp[0]*xLimUp[1]-20.784609690826525*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((249.41531628991828*xLimUp[0]*xLimUp1R2-249.41531628991828*xLimLo[0]*xLimLo1R2)*ySh[1]+101.82337649086291*ySh[0]*xLimUp1R2-101.82337649086291*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR2+((72.0*xLimUp0R2*xLimUp[1]-72.0*xLimLo0R2*xLimLo[1])*ySh[1]+58.787753826796305*xLimUp[0]*ySh[0]*xLimUp[1]-58.787753826796305*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimUp+((48.0*xLimLo1R2-48.0*xLimUp1R2)*dyDo*dyLim+(288.0*xLimLo1R3-288.0*xLimUp1R3)*ySh[1])*sFac*yLimLoR3+((20.784609690826525*xLimLo[0]*xLimLo[1]-20.784609690826525*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((249.41531628991828*xLimLo[0]*xLimLo1R2-249.41531628991828*xLimUp[0]*xLimUp1R2)*ySh[1]-101.82337649086291*ySh[0]*xLimUp1R2+101.82337649086291*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR2+((72.0*xLimLo0R2*xLimLo[1]-72.0*xLimUp0R2*xLimUp[1])*ySh[1]-58.787753826796305*xLimUp[0]*ySh[0]*xLimUp[1]+58.787753826796305*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimLo)*ycLim+((48.0*xLimUp1R2-48.0*xLimLo1R2)*dyLim*sFac*yLimUpR3+(41.56921938165305*xLimUp[0]*xLimUp[1]-41.56921938165305*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR2+(12.0*xLimUp0R2-12.0*xLimLo0R2)*dyLimR3*sFac*yLimUp+(48.0*xLimLo1R2-48.0*xLimUp1R2)*dyLim*sFac*yLimLoR3+(41.56921938165305*xLimLo[0]*xLimLo[1]-41.56921938165305*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimLoR2+(12.0*xLimLo0R2-12.0*xLimUp0R2)*dyLimR3*sFac*yLimLo)*yOff+((18.0*xLimLo1R2-18.0*xLimUp1R2)*dyDo*dyLim+(72.0*xLimLo1R3-72.0*xLimUp1R3)*ySh[1])*sFac*yLimUpR4+((13.856406460551018*xLimLo[0]*xLimLo[1]-13.856406460551018*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((83.1384387633061*xLimLo[0]*xLimLo1R2-83.1384387633061*xLimUp[0]*xLimUp1R2)*ySh[1]-33.94112549695431*ySh[0]*xLimUp1R2+33.94112549695431*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR3+((3.0*xLimLo0R2-3.0*xLimUp0R2)*dyDo*dyLimR3+((36.0*xLimLo0R2*xLimLo[1]-36.0*xLimUp0R2*xLimUp[1])*ySh[1]-29.39387691339815*xLimUp[0]*ySh[0]*xLimUp[1]+29.39387691339815*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimUpR2+((6.928203230275509*xLimLo0R3-6.928203230275509*xLimUp0R3)*ySh[1]+(8.485281374238571*xLimLo0R2-8.485281374238571*xLimUp0R2)*ySh[0])*dyLimR3*sFac*yLimUp+((18.0*xLimUp1R2-18.0*xLimLo1R2)*dyDo*dyLim+(72.0*xLimUp1R3-72.0*xLimLo1R3)*ySh[1])*sFac*yLimLoR4+((13.856406460551018*xLimUp[0]*xLimUp[1]-13.856406460551018*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((83.1384387633061*xLimUp[0]*xLimUp1R2-83.1384387633061*xLimLo[0]*xLimLo1R2)*ySh[1]+33.94112549695431*ySh[0]*xLimUp1R2-33.94112549695431*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR3+((3.0*xLimUp0R2-3.0*xLimLo0R2)*dyDo*dyLimR3+((36.0*xLimUp0R2*xLimUp[1]-36.0*xLimLo0R2*xLimLo[1])*ySh[1]+29.39387691339815*xLimUp[0]*ySh[0]*xLimUp[1]-29.39387691339815*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimLoR2+((6.928203230275509*xLimUp0R3-6.928203230275509*xLimLo0R3)*ySh[1]+(8.485281374238571*xLimUp0R2-8.485281374238571*xLimLo0R2)*ySh[0])*dyLimR3*sFac*yLimLo))/(dyDo*dyLimR3))); 
  gkyl_mat_inc(tsmat, 2,2, (0.03125*(((88.18163074019444*xLimUp1R2-88.18163074019444*xLimLo1R2)*ySh[1]*sFac*yLimUpR2+(88.18163074019444*xLimLo1R2-88.18163074019444*xLimUp1R2)*ySh[1]*sFac*yLimLoR2)*ycLimR2+(((58.787753826796305*xLimUp[1]-58.787753826796305*xLimLo[1])*dyLim*sFac*yLimUpR2+(58.787753826796305*xLimLo[1]-58.787753826796305*xLimUp[1])*dyLim*sFac*yLimLoR2)*yOff+((19.595917942265437*xLimLo[1]-19.595917942265437*xLimUp[1])*dyDo*dyLim+(117.57550765359265*xLimLo1R2-117.57550765359265*xLimUp1R2)*ySh[1])*sFac*yLimUpR3+((50.91168824543145*xLimLo[0]*xLimLo[1]-50.91168824543145*xLimUp[0]*xLimUp[1])*ySh[1]-41.56921938165305*ySh[0]*xLimUp[1]+41.56921938165305*ySh[0]*xLimLo[1])*dyLim*sFac*yLimUpR2+((19.595917942265437*xLimUp[1]-19.595917942265437*xLimLo[1])*dyDo*dyLim+(117.57550765359265*xLimUp1R2-117.57550765359265*xLimLo1R2)*ySh[1])*sFac*yLimLoR3+((50.91168824543145*xLimUp[0]*xLimUp[1]-50.91168824543145*xLimLo[0]*xLimLo[1])*ySh[1]+41.56921938165305*ySh[0]*xLimUp[1]-41.56921938165305*ySh[0]*xLimLo[1])*dyLim*sFac*yLimLoR2)*ycLim+((39.19183588453089*xLimLo[1]-39.19183588453089*xLimUp[1])*dyLim*sFac*yLimUpR3+(16.97056274847715*xLimLo[0]-16.97056274847715*xLimUp[0])*dyLimR2*sFac*yLimUpR2+(39.19183588453089*xLimUp[1]-39.19183588453089*xLimLo[1])*dyLim*sFac*yLimLoR3+(16.97056274847715*xLimUp[0]-16.97056274847715*xLimLo[0])*dyLimR2*sFac*yLimLoR2)*yOff+((14.696938456699069*xLimUp[1]-14.696938456699069*xLimLo[1])*dyDo*dyLim+(44.090815370097204*xLimUp1R2-44.090815370097204*xLimLo1R2)*ySh[1])*sFac*yLimUpR4+((5.656854249492383*xLimUp[0]-5.656854249492383*xLimLo[0])*dyDo*dyLimR2+((33.94112549695431*xLimUp[0]*xLimUp[1]-33.94112549695431*xLimLo[0]*xLimLo[1])*ySh[1]+27.712812921102035*ySh[0]*xLimUp[1]-27.712812921102035*ySh[0]*xLimLo[1])*dyLim)*sFac*yLimUpR3+((7.348469228349534*xLimUp0R2-7.348469228349534*xLimLo0R2)*ySh[1]+(12.0*xLimUp[0]-12.0*xLimLo[0])*ySh[0])*dyLimR2*sFac*yLimUpR2+((14.696938456699069*xLimLo[1]-14.696938456699069*xLimUp[1])*dyDo*dyLim+(44.090815370097204*xLimLo1R2-44.090815370097204*xLimUp1R2)*ySh[1])*sFac*yLimLoR4+((5.656854249492383*xLimLo[0]-5.656854249492383*xLimUp[0])*dyDo*dyLimR2+((33.94112549695431*xLimLo[0]*xLimLo[1]-33.94112549695431*xLimUp[0]*xLimUp[1])*ySh[1]-27.712812921102035*ySh[0]*xLimUp[1]+27.712812921102035*ySh[0]*xLimLo[1])*dyLim)*sFac*yLimLoR3+((7.348469228349534*xLimLo0R2-7.348469228349534*xLimUp0R2)*ySh[1]+(12.0*xLimLo[0]-12.0*xLimUp[0])*ySh[0])*dyLimR2*sFac*yLimLoR2))/(dyDo*dyLimR2)); 
  gkyl_mat_inc(tsmat, 2,3, -((0.00625*(((1247.0765814495915*xLimUp1R3-1247.0765814495915*xLimLo1R3)*ySh[1]*sFac*yLimUpR2+(1247.0765814495915*xLimLo1R3-1247.0765814495915*xLimUp1R3)*ySh[1]*sFac*yLimLoR2)*ycLimR3+(((623.5382907247957*xLimUp1R2-623.5382907247957*xLimLo1R2)*dyLim*sFac*yLimUpR2+(623.5382907247957*xLimLo1R2-623.5382907247957*xLimUp1R2)*dyLim*sFac*yLimLoR2)*yOff+((207.84609690826525*xLimLo1R2-207.84609690826525*xLimUp1R2)*dyDo*dyLim+(2494.153162899183*xLimLo1R3-2494.153162899183*xLimUp1R3)*ySh[1])*sFac*yLimUpR3+((1080.0*xLimLo[0]*xLimLo1R2-1080.0*xLimUp[0]*xLimUp1R2)*ySh[1]-440.9081537009722*ySh[0]*xLimUp1R2+440.9081537009722*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimUpR2+((207.84609690826525*xLimUp1R2-207.84609690826525*xLimLo1R2)*dyDo*dyLim+(2494.153162899183*xLimUp1R3-2494.153162899183*xLimLo1R3)*ySh[1])*sFac*yLimLoR3+((1080.0*xLimUp[0]*xLimUp1R2-1080.0*xLimLo[0]*xLimLo1R2)*ySh[1]+440.9081537009722*ySh[0]*xLimUp1R2-440.9081537009722*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimLoR2)*ycLimR2+(((831.384387633061*xLimLo1R2-831.384387633061*xLimUp1R2)*dyLim*sFac*yLimUpR3+(360.0*xLimLo[0]*xLimLo[1]-360.0*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimUpR2+(831.384387633061*xLimUp1R2-831.384387633061*xLimLo1R2)*dyLim*sFac*yLimLoR3+(360.0*xLimUp[0]*xLimUp[1]-360.0*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimLoR2)*yOff+((311.76914536239786*xLimUp1R2-311.76914536239786*xLimLo1R2)*dyDo*dyLim+(1870.614872174387*xLimUp1R3-1870.614872174387*xLimLo1R3)*ySh[1])*sFac*yLimUpR4+((120.0*xLimUp[0]*xLimUp[1]-120.0*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((1440.0*xLimUp[0]*xLimUp1R2-1440.0*xLimLo[0]*xLimLo1R2)*ySh[1]+587.8775382679632*ySh[0]*xLimUp1R2-587.8775382679632*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR3+((311.76914536239786*xLimUp0R2*xLimUp[1]-311.76914536239786*xLimLo0R2*xLimLo[1])*ySh[1]+254.55844122715723*xLimUp[0]*ySh[0]*xLimUp[1]-254.55844122715723*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR2+((311.76914536239786*xLimLo1R2-311.76914536239786*xLimUp1R2)*dyDo*dyLim+(1870.614872174387*xLimLo1R3-1870.614872174387*xLimUp1R3)*ySh[1])*sFac*yLimLoR4+((120.0*xLimLo[0]*xLimLo[1]-120.0*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((1440.0*xLimLo[0]*xLimLo1R2-1440.0*xLimUp[0]*xLimUp1R2)*ySh[1]-587.8775382679632*ySh[0]*xLimUp1R2+587.8775382679632*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR3+((311.76914536239786*xLimLo0R2*xLimLo[1]-311.76914536239786*xLimUp0R2*xLimUp[1])*ySh[1]-254.55844122715723*xLimUp[0]*ySh[0]*xLimUp[1]+254.55844122715723*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimLoR2)*ycLim+((311.76914536239786*xLimUp1R2-311.76914536239786*xLimLo1R2)*dyLim*sFac*yLimUpR4+(240.0*xLimUp[0]*xLimUp[1]-240.0*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR3+(51.96152422706631*xLimUp0R2-51.96152422706631*xLimLo0R2)*dyLimR3*sFac*yLimUpR2+(311.76914536239786*xLimLo1R2-311.76914536239786*xLimUp1R2)*dyLim*sFac*yLimLoR4+(240.0*xLimLo[0]*xLimLo[1]-240.0*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimLoR3+(51.96152422706631*xLimLo0R2-51.96152422706631*xLimUp0R2)*dyLimR3*sFac*yLimLoR2)*yOff+((124.70765814495914*xLimLo1R2-124.70765814495914*xLimUp1R2)*dyDo*dyLim+(498.83063257983656*xLimLo1R3-498.83063257983656*xLimUp1R3)*ySh[1])*sFac*yLimUpR5+((90.0*xLimLo[0]*xLimLo[1]-90.0*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((540.0*xLimLo[0]*xLimLo1R2-540.0*xLimUp[0]*xLimUp1R2)*ySh[1]-220.45407685048605*ySh[0]*xLimUp1R2+220.45407685048605*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR4+((17.32050807568877*xLimLo0R2-17.32050807568877*xLimUp0R2)*dyDo*dyLimR3+((207.84609690826525*xLimLo0R2*xLimLo[1]-207.84609690826525*xLimUp0R2*xLimUp[1])*ySh[1]-169.70562748477153*xLimUp[0]*ySh[0]*xLimUp[1]+169.70562748477153*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimUpR3+((30.0*xLimLo0R3-30.0*xLimUp0R3)*ySh[1]+(36.74234614174767*xLimLo0R2-36.74234614174767*xLimUp0R2)*ySh[0])*dyLimR3*sFac*yLimUpR2+((124.70765814495914*xLimUp1R2-124.70765814495914*xLimLo1R2)*dyDo*dyLim+(498.83063257983656*xLimUp1R3-498.83063257983656*xLimLo1R3)*ySh[1])*sFac*yLimLoR5+((90.0*xLimUp[0]*xLimUp[1]-90.0*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((540.0*xLimUp[0]*xLimUp1R2-540.0*xLimLo[0]*xLimLo1R2)*ySh[1]+220.45407685048605*ySh[0]*xLimUp1R2-220.45407685048605*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR4+((17.32050807568877*xLimUp0R2-17.32050807568877*xLimLo0R2)*dyDo*dyLimR3+((207.84609690826525*xLimUp0R2*xLimUp[1]-207.84609690826525*xLimLo0R2*xLimLo[1])*ySh[1]+169.70562748477153*xLimUp[0]*ySh[0]*xLimUp[1]-169.70562748477153*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimLoR3+((30.0*xLimUp0R3-30.0*xLimLo0R3)*ySh[1]+(36.74234614174767*xLimUp0R2-36.74234614174767*xLimLo0R2)*ySh[0])*dyLimR3*sFac*yLimLoR2))/(dyDo*dyLimR3))); 
  gkyl_mat_inc(tsmat, 3,0, -((0.03125*(((288.0*xLimUp1R3-288.0*xLimLo1R3)*ySh[1]*sFac*yLimUp+(288.0*xLimLo1R3-288.0*xLimUp1R3)*ySh[1]*sFac*yLimLo)*ycLimR3+(((144.0*xLimUp1R2-144.0*xLimLo1R2)*dyLim*sFac*yLimUp+(144.0*xLimLo1R2-144.0*xLimUp1R2)*dyLim*sFac*yLimLo)*yOff+((36.0*xLimLo1R2-36.0*xLimUp1R2)*dyDo*dyLim+(432.0*xLimLo1R3-432.0*xLimUp1R3)*ySh[1])*sFac*yLimUpR2+((249.41531628991828*xLimLo[0]*xLimLo1R2-249.41531628991828*xLimUp[0]*xLimUp1R2)*ySh[1]-101.82337649086291*ySh[0]*xLimUp1R2+101.82337649086291*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimUp+((36.0*xLimUp1R2-36.0*xLimLo1R2)*dyDo*dyLim+(432.0*xLimUp1R3-432.0*xLimLo1R3)*ySh[1])*sFac*yLimLoR2+((249.41531628991828*xLimUp[0]*xLimUp1R2-249.41531628991828*xLimLo[0]*xLimLo1R2)*ySh[1]+101.82337649086291*ySh[0]*xLimUp1R2-101.82337649086291*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimLo)*ycLimR2+(((144.0*xLimLo1R2-144.0*xLimUp1R2)*dyLim*sFac*yLimUpR2+(83.1384387633061*xLimLo[0]*xLimLo[1]-83.1384387633061*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimUp+(144.0*xLimUp1R2-144.0*xLimLo1R2)*dyLim*sFac*yLimLoR2+(83.1384387633061*xLimUp[0]*xLimUp[1]-83.1384387633061*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimLo)*yOff+((48.0*xLimUp1R2-48.0*xLimLo1R2)*dyDo*dyLim+(288.0*xLimUp1R3-288.0*xLimLo1R3)*ySh[1])*sFac*yLimUpR3+((20.784609690826525*xLimUp[0]*xLimUp[1]-20.784609690826525*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((249.41531628991828*xLimUp[0]*xLimUp1R2-249.41531628991828*xLimLo[0]*xLimLo1R2)*ySh[1]+101.82337649086291*ySh[0]*xLimUp1R2-101.82337649086291*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR2+((72.0*xLimUp0R2*xLimUp[1]-72.0*xLimLo0R2*xLimLo[1])*ySh[1]+58.787753826796305*xLimUp[0]*ySh[0]*xLimUp[1]-58.787753826796305*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimUp+((48.0*xLimLo1R2-48.0*xLimUp1R2)*dyDo*dyLim+(288.0*xLimLo1R3-288.0*xLimUp1R3)*ySh[1])*sFac*yLimLoR3+((20.784609690826525*xLimLo[0]*xLimLo[1]-20.784609690826525*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((249.41531628991828*xLimLo[0]*xLimLo1R2-249.41531628991828*xLimUp[0]*xLimUp1R2)*ySh[1]-101.82337649086291*ySh[0]*xLimUp1R2+101.82337649086291*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR2+((72.0*xLimLo0R2*xLimLo[1]-72.0*xLimUp0R2*xLimUp[1])*ySh[1]-58.787753826796305*xLimUp[0]*ySh[0]*xLimUp[1]+58.787753826796305*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimLo)*ycLim+((48.0*xLimUp1R2-48.0*xLimLo1R2)*dyLim*sFac*yLimUpR3+(41.56921938165305*xLimUp[0]*xLimUp[1]-41.56921938165305*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR2+(12.0*xLimUp0R2-12.0*xLimLo0R2)*dyLimR3*sFac*yLimUp+(48.0*xLimLo1R2-48.0*xLimUp1R2)*dyLim*sFac*yLimLoR3+(41.56921938165305*xLimLo[0]*xLimLo[1]-41.56921938165305*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimLoR2+(12.0*xLimLo0R2-12.0*xLimUp0R2)*dyLimR3*sFac*yLimLo)*yOff+((18.0*xLimLo1R2-18.0*xLimUp1R2)*dyDo*dyLim+(72.0*xLimLo1R3-72.0*xLimUp1R3)*ySh[1])*sFac*yLimUpR4+((13.856406460551018*xLimLo[0]*xLimLo[1]-13.856406460551018*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((83.1384387633061*xLimLo[0]*xLimLo1R2-83.1384387633061*xLimUp[0]*xLimUp1R2)*ySh[1]-33.94112549695431*ySh[0]*xLimUp1R2+33.94112549695431*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR3+((3.0*xLimLo0R2-3.0*xLimUp0R2)*dyDo*dyLimR3+((36.0*xLimLo0R2*xLimLo[1]-36.0*xLimUp0R2*xLimUp[1])*ySh[1]-29.39387691339815*xLimUp[0]*ySh[0]*xLimUp[1]+29.39387691339815*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimUpR2+((6.928203230275509*xLimLo0R3-6.928203230275509*xLimUp0R3)*ySh[1]+(8.485281374238571*xLimLo0R2-8.485281374238571*xLimUp0R2)*ySh[0])*dyLimR3*sFac*yLimUp+((18.0*xLimUp1R2-18.0*xLimLo1R2)*dyDo*dyLim+(72.0*xLimUp1R3-72.0*xLimLo1R3)*ySh[1])*sFac*yLimLoR4+((13.856406460551018*xLimUp[0]*xLimUp[1]-13.856406460551018*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((83.1384387633061*xLimUp[0]*xLimUp1R2-83.1384387633061*xLimLo[0]*xLimLo1R2)*ySh[1]+33.94112549695431*ySh[0]*xLimUp1R2-33.94112549695431*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR3+((3.0*xLimUp0R2-3.0*xLimLo0R2)*dyDo*dyLimR3+((36.0*xLimUp0R2*xLimUp[1]-36.0*xLimLo0R2*xLimLo[1])*ySh[1]+29.39387691339815*xLimUp[0]*ySh[0]*xLimUp[1]-29.39387691339815*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimLoR2+((6.928203230275509*xLimUp0R3-6.928203230275509*xLimLo0R3)*ySh[1]+(8.485281374238571*xLimUp0R2-8.485281374238571*xLimLo0R2)*ySh[0])*dyLimR3*sFac*yLimLo))/(dyDo*dyLimR3))); 
  gkyl_mat_inc(tsmat, 3,1, (0.003125*(((9164.103884177664*xLimUp1R4-9164.103884177664*xLimLo1R4)*ySh[1]*sFac*yLimUp+(9164.103884177664*xLimLo1R4-9164.103884177664*xLimUp1R4)*ySh[1]*sFac*yLimLo)*ycLimR4+(((4072.93505963452*xLimUp1R3-4072.93505963452*xLimLo1R3)*dyLim*sFac*yLimUp+(4072.93505963452*xLimLo1R3-4072.93505963452*xLimUp1R3)*dyLim*sFac*yLimLo)*yOff+((1018.2337649086295*xLimLo1R3-1018.2337649086295*xLimUp1R3)*dyDo*dyLim+(18328.207768355333*xLimLo1R4-18328.207768355333*xLimUp1R4)*ySh[1])*sFac*yLimUpR2+((10581.795688823338*xLimLo[0]*xLimLo1R3-10581.795688823338*xLimUp[0]*xLimUp1R3)*ySh[1]-2880.0*ySh[0]*xLimUp1R3+2880.0*ySh[0]*xLimLo1R3)*dyLim*sFac*yLimUp+((1018.2337649086295*xLimUp1R3-1018.2337649086295*xLimLo1R3)*dyDo*dyLim+(18328.207768355333*xLimUp1R4-18328.207768355333*xLimLo1R4)*ySh[1])*sFac*yLimLoR2+((10581.795688823338*xLimUp[0]*xLimUp1R3-10581.795688823338*xLimLo[0]*xLimLo1R3)*ySh[1]+2880.0*ySh[0]*xLimUp1R3-2880.0*ySh[0]*xLimLo1R3)*dyLim*sFac*yLimLo)*ycLimR3+(((6109.402589451778*xLimLo1R3-6109.402589451778*xLimUp1R3)*dyLim*sFac*yLimUpR2+(3527.26522960778*xLimLo[0]*xLimLo1R2-3527.26522960778*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimUp+(6109.402589451778*xLimUp1R3-6109.402589451778*xLimLo1R3)*dyLim*sFac*yLimLoR2+(3527.26522960778*xLimUp[0]*xLimUp1R2-3527.26522960778*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimLo)*yOff+((2036.4675298172592*xLimUp1R3-2036.4675298172592*xLimLo1R3)*dyDo*dyLim+(18328.207768355333*xLimUp1R4-18328.207768355333*xLimLo1R4)*ySh[1])*sFac*yLimUpR3+((881.8163074019445*xLimUp[0]*xLimUp1R2-881.8163074019445*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((15872.693533235004*xLimUp[0]*xLimUp1R3-15872.693533235004*xLimLo[0]*xLimLo1R3)*ySh[1]+4320.0*ySh[0]*xLimUp1R3-4320.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR2+((4582.051942088831*xLimUp0R2*xLimUp1R2-4582.051942088831*xLimLo0R2*xLimLo1R2)*ySh[1]+2494.153162899183*xLimUp[0]*ySh[0]*xLimUp1R2-2494.153162899183*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2*sFac*yLimUp+((2036.4675298172592*xLimLo1R3-2036.4675298172592*xLimUp1R3)*dyDo*dyLim+(18328.207768355333*xLimLo1R4-18328.207768355333*xLimUp1R4)*ySh[1])*sFac*yLimLoR3+((881.8163074019445*xLimLo[0]*xLimLo1R2-881.8163074019445*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((15872.693533235004*xLimLo[0]*xLimLo1R3-15872.693533235004*xLimUp[0]*xLimUp1R3)*ySh[1]-4320.0*ySh[0]*xLimUp1R3+4320.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR2+((4582.051942088831*xLimLo0R2*xLimLo1R2-4582.051942088831*xLimUp0R2*xLimUp1R2)*ySh[1]-2494.153162899183*xLimUp[0]*ySh[0]*xLimUp1R2+2494.153162899183*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2*sFac*yLimLo)*ycLimR2+(((4072.93505963452*xLimUp1R3-4072.93505963452*xLimLo1R3)*dyLim*sFac*yLimUpR3+(3527.26522960778*xLimUp[0]*xLimUp1R2-3527.26522960778*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimUpR2+(1018.2337649086295*xLimUp0R2*xLimUp[1]-1018.2337649086295*xLimLo0R2*xLimLo[1])*dyLimR3*sFac*yLimUp+(4072.93505963452*xLimLo1R3-4072.93505963452*xLimUp1R3)*dyLim*sFac*yLimLoR3+(3527.26522960778*xLimLo[0]*xLimLo1R2-3527.26522960778*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimLoR2+(1018.2337649086295*xLimLo0R2*xLimLo[1]-1018.2337649086295*xLimUp0R2*xLimUp[1])*dyLimR3*sFac*yLimLo)*yOff+((1527.3506473629436*xLimLo1R3-1527.3506473629436*xLimUp1R3)*dyDo*dyLim+(9164.103884177664*xLimLo1R4-9164.103884177664*xLimUp1R4)*ySh[1])*sFac*yLimUpR4+((1175.7550765359267*xLimLo[0]*xLimLo1R2-1175.7550765359267*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((10581.795688823338*xLimLo[0]*xLimLo1R3-10581.795688823338*xLimUp[0]*xLimUp1R3)*ySh[1]-2880.0*ySh[0]*xLimUp1R3+2880.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR3+((254.55844122715723*xLimLo0R2*xLimLo[1]-254.55844122715723*xLimUp0R2*xLimUp[1])*dyDo*dyLimR3+((4582.051942088831*xLimLo0R2*xLimLo1R2-4582.051942088831*xLimUp0R2*xLimUp1R2)*ySh[1]-2494.153162899183*xLimUp[0]*ySh[0]*xLimUp1R2+2494.153162899183*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimUpR2+((881.8163074019445*xLimLo0R3*xLimLo[1]-881.8163074019445*xLimUp0R3*xLimUp[1])*ySh[1]-720.0*xLimUp0R2*ySh[0]*xLimUp[1]+720.0*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3*sFac*yLimUp+((1527.3506473629436*xLimUp1R3-1527.3506473629436*xLimLo1R3)*dyDo*dyLim+(9164.103884177664*xLimUp1R4-9164.103884177664*xLimLo1R4)*ySh[1])*sFac*yLimLoR4+((1175.7550765359267*xLimUp[0]*xLimUp1R2-1175.7550765359267*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((10581.795688823338*xLimUp[0]*xLimUp1R3-10581.795688823338*xLimLo[0]*xLimLo1R3)*ySh[1]+2880.0*ySh[0]*xLimUp1R3-2880.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR3+((254.55844122715723*xLimUp0R2*xLimUp[1]-254.55844122715723*xLimLo0R2*xLimLo[1])*dyDo*dyLimR3+((4582.051942088831*xLimUp0R2*xLimUp1R2-4582.051942088831*xLimLo0R2*xLimLo1R2)*ySh[1]+2494.153162899183*xLimUp[0]*ySh[0]*xLimUp1R2-2494.153162899183*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimLoR2+((881.8163074019445*xLimUp0R3*xLimUp[1]-881.8163074019445*xLimLo0R3*xLimLo[1])*ySh[1]+720.0*xLimUp0R2*ySh[0]*xLimUp[1]-720.0*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3*sFac*yLimLo)*ycLim+((1018.2337649086295*xLimLo1R3-1018.2337649086295*xLimUp1R3)*dyLim*sFac*yLimUpR4+(1175.7550765359267*xLimLo[0]*xLimLo1R2-1175.7550765359267*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimUpR3+(509.1168824543146*xLimLo0R2*xLimLo[1]-509.1168824543146*xLimUp0R2*xLimUp[1])*dyLimR3*sFac*yLimUpR2+(97.97958971132718*xLimLo0R3-97.97958971132718*xLimUp0R3)*dyLimR4*sFac*yLimUp+(1018.2337649086295*xLimUp1R3-1018.2337649086295*xLimLo1R3)*dyLim*sFac*yLimLoR4+(1175.7550765359267*xLimUp[0]*xLimUp1R2-1175.7550765359267*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimLoR3+(509.1168824543146*xLimUp0R2*xLimUp[1]-509.1168824543146*xLimLo0R2*xLimLo[1])*dyLimR3*sFac*yLimLoR2+(97.97958971132718*xLimUp0R3-97.97958971132718*xLimLo0R3)*dyLimR4*sFac*yLimLo)*yOff+((407.2935059634518*xLimUp1R3-407.2935059634518*xLimLo1R3)*dyDo*dyLim+(1832.820776835533*xLimUp1R4-1832.820776835533*xLimLo1R4)*ySh[1])*sFac*yLimUpR5+((440.9081537009722*xLimUp[0]*xLimUp1R2-440.9081537009722*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((2645.4489222058332*xLimUp[0]*xLimUp1R3-2645.4489222058332*xLimLo[0]*xLimLo1R3)*ySh[1]+720.0*ySh[0]*xLimUp1R3-720.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR4+((169.70562748477153*xLimUp0R2*xLimUp[1]-169.70562748477153*xLimLo0R2*xLimLo[1])*dyDo*dyLimR3+((1527.3506473629436*xLimUp0R2*xLimUp1R2-1527.3506473629436*xLimLo0R2*xLimLo1R2)*ySh[1]+831.384387633061*xLimUp[0]*ySh[0]*xLimUp1R2-831.384387633061*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimUpR3+((24.494897427831788*xLimUp0R3-24.494897427831788*xLimLo0R3)*dyDo*dyLimR4+((440.9081537009722*xLimUp0R3*xLimUp[1]-440.9081537009722*xLimLo0R3*xLimLo[1])*ySh[1]+360.0*xLimUp0R2*ySh[0]*xLimUp[1]-360.0*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3)*sFac*yLimUpR2+((63.63961030678928*xLimUp0R4-63.63961030678928*xLimLo0R4)*ySh[1]+(69.28203230275508*xLimUp0R3-69.28203230275508*xLimLo0R3)*ySh[0])*dyLimR4*sFac*yLimUp+((407.2935059634518*xLimLo1R3-407.2935059634518*xLimUp1R3)*dyDo*dyLim+(1832.820776835533*xLimLo1R4-1832.820776835533*xLimUp1R4)*ySh[1])*sFac*yLimLoR5+((440.9081537009722*xLimLo[0]*xLimLo1R2-440.9081537009722*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((2645.4489222058332*xLimLo[0]*xLimLo1R3-2645.4489222058332*xLimUp[0]*xLimUp1R3)*ySh[1]-720.0*ySh[0]*xLimUp1R3+720.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR4+((169.70562748477153*xLimLo0R2*xLimLo[1]-169.70562748477153*xLimUp0R2*xLimUp[1])*dyDo*dyLimR3+((1527.3506473629436*xLimLo0R2*xLimLo1R2-1527.3506473629436*xLimUp0R2*xLimUp1R2)*ySh[1]-831.384387633061*xLimUp[0]*ySh[0]*xLimUp1R2+831.384387633061*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimLoR3+((24.494897427831788*xLimLo0R3-24.494897427831788*xLimUp0R3)*dyDo*dyLimR4+((440.9081537009722*xLimLo0R3*xLimLo[1]-440.9081537009722*xLimUp0R3*xLimUp[1])*ySh[1]-360.0*xLimUp0R2*ySh[0]*xLimUp[1]+360.0*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3)*sFac*yLimLoR2+((63.63961030678928*xLimLo0R4-63.63961030678928*xLimUp0R4)*ySh[1]+(69.28203230275508*xLimLo0R3-69.28203230275508*xLimUp0R3)*ySh[0])*dyLimR4*sFac*yLimLo))/(dyDo*dyLimR4)); 
  gkyl_mat_inc(tsmat, 3,2, -((0.00625*(((1247.0765814495915*xLimUp1R3-1247.0765814495915*xLimLo1R3)*ySh[1]*sFac*yLimUpR2+(1247.0765814495915*xLimLo1R3-1247.0765814495915*xLimUp1R3)*ySh[1]*sFac*yLimLoR2)*ycLimR3+(((623.5382907247957*xLimUp1R2-623.5382907247957*xLimLo1R2)*dyLim*sFac*yLimUpR2+(623.5382907247957*xLimLo1R2-623.5382907247957*xLimUp1R2)*dyLim*sFac*yLimLoR2)*yOff+((207.84609690826525*xLimLo1R2-207.84609690826525*xLimUp1R2)*dyDo*dyLim+(2494.153162899183*xLimLo1R3-2494.153162899183*xLimUp1R3)*ySh[1])*sFac*yLimUpR3+((1080.0*xLimLo[0]*xLimLo1R2-1080.0*xLimUp[0]*xLimUp1R2)*ySh[1]-440.9081537009722*ySh[0]*xLimUp1R2+440.9081537009722*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimUpR2+((207.84609690826525*xLimUp1R2-207.84609690826525*xLimLo1R2)*dyDo*dyLim+(2494.153162899183*xLimUp1R3-2494.153162899183*xLimLo1R3)*ySh[1])*sFac*yLimLoR3+((1080.0*xLimUp[0]*xLimUp1R2-1080.0*xLimLo[0]*xLimLo1R2)*ySh[1]+440.9081537009722*ySh[0]*xLimUp1R2-440.9081537009722*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimLoR2)*ycLimR2+(((831.384387633061*xLimLo1R2-831.384387633061*xLimUp1R2)*dyLim*sFac*yLimUpR3+(360.0*xLimLo[0]*xLimLo[1]-360.0*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimUpR2+(831.384387633061*xLimUp1R2-831.384387633061*xLimLo1R2)*dyLim*sFac*yLimLoR3+(360.0*xLimUp[0]*xLimUp[1]-360.0*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimLoR2)*yOff+((311.76914536239786*xLimUp1R2-311.76914536239786*xLimLo1R2)*dyDo*dyLim+(1870.614872174387*xLimUp1R3-1870.614872174387*xLimLo1R3)*ySh[1])*sFac*yLimUpR4+((120.0*xLimUp[0]*xLimUp[1]-120.0*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((1440.0*xLimUp[0]*xLimUp1R2-1440.0*xLimLo[0]*xLimLo1R2)*ySh[1]+587.8775382679632*ySh[0]*xLimUp1R2-587.8775382679632*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR3+((311.76914536239786*xLimUp0R2*xLimUp[1]-311.76914536239786*xLimLo0R2*xLimLo[1])*ySh[1]+254.55844122715723*xLimUp[0]*ySh[0]*xLimUp[1]-254.55844122715723*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR2+((311.76914536239786*xLimLo1R2-311.76914536239786*xLimUp1R2)*dyDo*dyLim+(1870.614872174387*xLimLo1R3-1870.614872174387*xLimUp1R3)*ySh[1])*sFac*yLimLoR4+((120.0*xLimLo[0]*xLimLo[1]-120.0*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((1440.0*xLimLo[0]*xLimLo1R2-1440.0*xLimUp[0]*xLimUp1R2)*ySh[1]-587.8775382679632*ySh[0]*xLimUp1R2+587.8775382679632*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR3+((311.76914536239786*xLimLo0R2*xLimLo[1]-311.76914536239786*xLimUp0R2*xLimUp[1])*ySh[1]-254.55844122715723*xLimUp[0]*ySh[0]*xLimUp[1]+254.55844122715723*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimLoR2)*ycLim+((311.76914536239786*xLimUp1R2-311.76914536239786*xLimLo1R2)*dyLim*sFac*yLimUpR4+(240.0*xLimUp[0]*xLimUp[1]-240.0*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR3+(51.96152422706631*xLimUp0R2-51.96152422706631*xLimLo0R2)*dyLimR3*sFac*yLimUpR2+(311.76914536239786*xLimLo1R2-311.76914536239786*xLimUp1R2)*dyLim*sFac*yLimLoR4+(240.0*xLimLo[0]*xLimLo[1]-240.0*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimLoR3+(51.96152422706631*xLimLo0R2-51.96152422706631*xLimUp0R2)*dyLimR3*sFac*yLimLoR2)*yOff+((124.70765814495914*xLimLo1R2-124.70765814495914*xLimUp1R2)*dyDo*dyLim+(498.83063257983656*xLimLo1R3-498.83063257983656*xLimUp1R3)*ySh[1])*sFac*yLimUpR5+((90.0*xLimLo[0]*xLimLo[1]-90.0*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((540.0*xLimLo[0]*xLimLo1R2-540.0*xLimUp[0]*xLimUp1R2)*ySh[1]-220.45407685048605*ySh[0]*xLimUp1R2+220.45407685048605*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR4+((17.32050807568877*xLimLo0R2-17.32050807568877*xLimUp0R2)*dyDo*dyLimR3+((207.84609690826525*xLimLo0R2*xLimLo[1]-207.84609690826525*xLimUp0R2*xLimUp[1])*ySh[1]-169.70562748477153*xLimUp[0]*ySh[0]*xLimUp[1]+169.70562748477153*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimUpR3+((30.0*xLimLo0R3-30.0*xLimUp0R3)*ySh[1]+(36.74234614174767*xLimLo0R2-36.74234614174767*xLimUp0R2)*ySh[0])*dyLimR3*sFac*yLimUpR2+((124.70765814495914*xLimUp1R2-124.70765814495914*xLimLo1R2)*dyDo*dyLim+(498.83063257983656*xLimUp1R3-498.83063257983656*xLimLo1R3)*ySh[1])*sFac*yLimLoR5+((90.0*xLimUp[0]*xLimUp[1]-90.0*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((540.0*xLimUp[0]*xLimUp1R2-540.0*xLimLo[0]*xLimLo1R2)*ySh[1]+220.45407685048605*ySh[0]*xLimUp1R2-220.45407685048605*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR4+((17.32050807568877*xLimUp0R2-17.32050807568877*xLimLo0R2)*dyDo*dyLimR3+((207.84609690826525*xLimUp0R2*xLimUp[1]-207.84609690826525*xLimLo0R2*xLimLo[1])*ySh[1]+169.70562748477153*xLimUp[0]*ySh[0]*xLimUp[1]-169.70562748477153*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimLoR3+((30.0*xLimUp0R3-30.0*xLimLo0R3)*ySh[1]+(36.74234614174767*xLimUp0R2-36.74234614174767*xLimLo0R2)*ySh[0])*dyLimR3*sFac*yLimLoR2))/(dyDo*dyLimR3))); 
  gkyl_mat_inc(tsmat, 3,3, (0.0015625*(((15872.693533235004*xLimUp1R4-15872.693533235004*xLimLo1R4)*ySh[1]*sFac*yLimUpR2+(15872.693533235004*xLimLo1R4-15872.693533235004*xLimUp1R4)*ySh[1]*sFac*yLimLoR2)*ycLimR4+(((7054.530459215563*xLimUp1R3-7054.530459215563*xLimLo1R3)*dyLim*sFac*yLimUpR2+(7054.530459215563*xLimLo1R3-7054.530459215563*xLimUp1R3)*dyLim*sFac*yLimLoR2)*yOff+((2351.5101530718543*xLimLo1R3-2351.5101530718543*xLimUp1R3)*dyDo*dyLim+(42327.182755293376*xLimLo1R4-42327.182755293376*xLimUp1R4)*ySh[1])*sFac*yLimUpR3+((18328.207768355333*xLimLo[0]*xLimLo1R3-18328.207768355333*xLimUp[0]*xLimUp1R3)*ySh[1]-4988.306325798366*ySh[0]*xLimUp1R3+4988.306325798366*ySh[0]*xLimLo1R3)*dyLim*sFac*yLimUpR2+((2351.5101530718543*xLimUp1R3-2351.5101530718543*xLimLo1R3)*dyDo*dyLim+(42327.182755293376*xLimUp1R4-42327.182755293376*xLimLo1R4)*ySh[1])*sFac*yLimLoR3+((18328.207768355333*xLimUp[0]*xLimUp1R3-18328.207768355333*xLimLo[0]*xLimLo1R3)*ySh[1]+4988.306325798366*ySh[0]*xLimUp1R3-4988.306325798366*ySh[0]*xLimLo1R3)*dyLim*sFac*yLimLoR2)*ycLimR3+(((14109.060918431127*xLimLo1R3-14109.060918431127*xLimUp1R3)*dyLim*sFac*yLimUpR3+(6109.402589451778*xLimLo[0]*xLimLo1R2-6109.402589451778*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimUpR2+(14109.060918431127*xLimUp1R3-14109.060918431127*xLimLo1R3)*dyLim*sFac*yLimLoR3+(6109.402589451778*xLimUp[0]*xLimUp1R2-6109.402589451778*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimLoR2)*yOff+((5290.897844411668*xLimUp1R3-5290.897844411668*xLimLo1R3)*dyDo*dyLim+(47618.080599705005*xLimUp1R4-47618.080599705005*xLimLo1R4)*ySh[1])*sFac*yLimUpR4+((2036.4675298172592*xLimUp[0]*xLimUp1R2-2036.4675298172592*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((36656.41553671068*xLimUp[0]*xLimUp1R3-36656.41553671068*xLimLo[0]*xLimLo1R3)*ySh[1]+9976.612651596732*ySh[0]*xLimUp1R3-9976.612651596732*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR3+((7936.346766617499*xLimUp0R2*xLimUp1R2-7936.346766617499*xLimLo0R2*xLimLo1R2)*ySh[1]+4320.0*xLimUp[0]*ySh[0]*xLimUp1R2-4320.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2*sFac*yLimUpR2+((5290.897844411668*xLimLo1R3-5290.897844411668*xLimUp1R3)*dyDo*dyLim+(47618.080599705005*xLimLo1R4-47618.080599705005*xLimUp1R4)*ySh[1])*sFac*yLimLoR4+((2036.4675298172592*xLimLo[0]*xLimLo1R2-2036.4675298172592*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((36656.41553671068*xLimLo[0]*xLimLo1R3-36656.41553671068*xLimUp[0]*xLimUp1R3)*ySh[1]-9976.612651596732*ySh[0]*xLimUp1R3+9976.612651596732*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR3+((7936.346766617499*xLimLo0R2*xLimLo1R2-7936.346766617499*xLimUp0R2*xLimUp1R2)*ySh[1]-4320.0*xLimUp[0]*ySh[0]*xLimUp1R2+4320.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2*sFac*yLimLoR2)*ycLimR2+(((10581.795688823338*xLimUp1R3-10581.795688823338*xLimLo1R3)*dyLim*sFac*yLimUpR4+(8145.8701192690405*xLimUp[0]*xLimUp1R2-8145.8701192690405*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimUpR3+(1763.6326148038897*xLimUp0R2*xLimUp[1]-1763.6326148038897*xLimLo0R2*xLimLo[1])*dyLimR3*sFac*yLimUpR2+(10581.795688823338*xLimLo1R3-10581.795688823338*xLimUp1R3)*dyLim*sFac*yLimLoR4+(8145.8701192690405*xLimLo[0]*xLimLo1R2-8145.8701192690405*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimLoR3+(1763.6326148038897*xLimLo0R2*xLimLo[1]-1763.6326148038897*xLimUp0R2*xLimUp[1])*dyLimR3*sFac*yLimLoR2)*yOff+((4232.718275529337*xLimLo1R3-4232.718275529337*xLimUp1R3)*dyDo*dyLim+(25396.309653176024*xLimLo1R4-25396.309653176024*xLimUp1R4)*ySh[1])*sFac*yLimUpR5+((3054.7012947258886*xLimLo[0]*xLimLo1R2-3054.7012947258886*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((27492.311652532997*xLimLo[0]*xLimLo1R3-27492.311652532997*xLimUp[0]*xLimUp1R3)*ySh[1]-7482.459488697548*ySh[0]*xLimUp1R3+7482.459488697548*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR4+((587.8775382679632*xLimLo0R2*xLimLo[1]-587.8775382679632*xLimUp0R2*xLimUp[1])*dyDo*dyLimR3+((10581.795688823338*xLimLo0R2*xLimLo1R2-10581.795688823338*xLimUp0R2*xLimUp1R2)*ySh[1]-5760.0*xLimUp[0]*ySh[0]*xLimUp1R2+5760.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimUpR3+((1527.3506473629436*xLimLo0R3*xLimLo[1]-1527.3506473629436*xLimUp0R3*xLimUp[1])*ySh[1]-1247.0765814495915*xLimUp0R2*ySh[0]*xLimUp[1]+1247.0765814495915*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3*sFac*yLimUpR2+((4232.718275529337*xLimUp1R3-4232.718275529337*xLimLo1R3)*dyDo*dyLim+(25396.309653176024*xLimUp1R4-25396.309653176024*xLimLo1R4)*ySh[1])*sFac*yLimLoR5+((3054.7012947258886*xLimUp[0]*xLimUp1R2-3054.7012947258886*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((27492.311652532997*xLimUp[0]*xLimUp1R3-27492.311652532997*xLimLo[0]*xLimLo1R3)*ySh[1]+7482.459488697548*ySh[0]*xLimUp1R3-7482.459488697548*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR4+((587.8775382679632*xLimUp0R2*xLimUp[1]-587.8775382679632*xLimLo0R2*xLimLo[1])*dyDo*dyLimR3+((10581.795688823338*xLimUp0R2*xLimUp1R2-10581.795688823338*xLimLo0R2*xLimLo1R2)*ySh[1]+5760.0*xLimUp[0]*ySh[0]*xLimUp1R2-5760.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimLoR3+((1527.3506473629436*xLimUp0R3*xLimUp[1]-1527.3506473629436*xLimLo0R3*xLimLo[1])*ySh[1]+1247.0765814495915*xLimUp0R2*ySh[0]*xLimUp[1]-1247.0765814495915*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3*sFac*yLimLoR2)*ycLim+((2821.812183686225*xLimLo1R3-2821.812183686225*xLimUp1R3)*dyLim*sFac*yLimUpR5+(3054.7012947258886*xLimLo[0]*xLimLo1R2-3054.7012947258886*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimUpR4+(1175.7550765359267*xLimLo0R2*xLimLo[1]-1175.7550765359267*xLimUp0R2*xLimUp[1])*dyLimR3*sFac*yLimUpR3+(169.70562748477153*xLimLo0R3-169.70562748477153*xLimUp0R3)*dyLimR4*sFac*yLimUpR2+(2821.812183686225*xLimUp1R3-2821.812183686225*xLimLo1R3)*dyLim*sFac*yLimLoR5+(3054.7012947258886*xLimUp[0]*xLimUp1R2-3054.7012947258886*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimLoR4+(1175.7550765359267*xLimUp0R2*xLimUp[1]-1175.7550765359267*xLimLo0R2*xLimLo[1])*dyLimR3*sFac*yLimLoR3+(169.70562748477153*xLimUp0R3-169.70562748477153*xLimLo0R3)*dyLimR4*sFac*yLimLoR2)*yOff+((1175.7550765359267*xLimUp1R3-1175.7550765359267*xLimLo1R3)*dyDo*dyLim+(5290.897844411668*xLimUp1R4-5290.897844411668*xLimLo1R4)*ySh[1])*sFac*yLimUpR6+((1221.8805178903556*xLimUp[0]*xLimUp1R2-1221.8805178903556*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((7331.283107342136*xLimUp[0]*xLimUp1R3-7331.283107342136*xLimLo[0]*xLimLo1R3)*ySh[1]+1995.3225303193462*ySh[0]*xLimUp1R3-1995.3225303193462*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR5+((440.9081537009722*xLimUp0R2*xLimUp[1]-440.9081537009722*xLimLo0R2*xLimLo[1])*dyDo*dyLimR3+((3968.173383308749*xLimUp0R2*xLimUp1R2-3968.173383308749*xLimLo0R2*xLimLo1R2)*ySh[1]+2160.0*xLimUp[0]*ySh[0]*xLimUp1R2-2160.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimUpR4+((56.56854249492384*xLimUp0R3-56.56854249492384*xLimLo0R3)*dyDo*dyLimR4+((1018.2337649086295*xLimUp0R3*xLimUp[1]-1018.2337649086295*xLimLo0R3*xLimLo[1])*ySh[1]+831.384387633061*xLimUp0R2*ySh[0]*xLimUp[1]-831.384387633061*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3)*sFac*yLimUpR3+((110.227038425243*xLimUp0R4-110.227038425243*xLimLo0R4)*ySh[1]+(120.0*xLimUp0R3-120.0*xLimLo0R3)*ySh[0])*dyLimR4*sFac*yLimUpR2+((1175.7550765359267*xLimLo1R3-1175.7550765359267*xLimUp1R3)*dyDo*dyLim+(5290.897844411668*xLimLo1R4-5290.897844411668*xLimUp1R4)*ySh[1])*sFac*yLimLoR6+((1221.8805178903556*xLimLo[0]*xLimLo1R2-1221.8805178903556*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((7331.283107342136*xLimLo[0]*xLimLo1R3-7331.283107342136*xLimUp[0]*xLimUp1R3)*ySh[1]-1995.3225303193462*ySh[0]*xLimUp1R3+1995.3225303193462*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR5+((440.9081537009722*xLimLo0R2*xLimLo[1]-440.9081537009722*xLimUp0R2*xLimUp[1])*dyDo*dyLimR3+((3968.173383308749*xLimLo0R2*xLimLo1R2-3968.173383308749*xLimUp0R2*xLimUp1R2)*ySh[1]-2160.0*xLimUp[0]*ySh[0]*xLimUp1R2+2160.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimLoR4+((56.56854249492384*xLimLo0R3-56.56854249492384*xLimUp0R3)*dyDo*dyLimR4+((1018.2337649086295*xLimLo0R3*xLimLo[1]-1018.2337649086295*xLimUp0R3*xLimUp[1])*ySh[1]-831.384387633061*xLimUp0R2*ySh[0]*xLimUp[1]+831.384387633061*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3)*sFac*yLimLoR3+((110.227038425243*xLimLo0R4-110.227038425243*xLimUp0R4)*ySh[1]+(120.0*xLimLo0R3-120.0*xLimUp0R3)*ySh[0])*dyLimR4*sFac*yLimLoR2))/(dyDo*dyLimR4)); 

}

GKYL_CU_DH void twistShift_ylimdg_2x_ser_p1yshift_p1(double sFac, double xLimLo, double xLimUp, const double *yLimLo, const double *yLimUp, double dyDo, double yOff, const double *ySh, struct gkyl_mat *tsmat) 
{ 
  // sFac:    scale factor, typically +/- 1.0.
  // xLimUp:  lower limit of the x integral in [-1,1] logical space.
  // xLimLo:  upper limit of the x integral in [-1,1] logical space.
  // yLimUp:  1D DG expansion of the function yLimLo(x) giving the lower limit of the y integral.
  // yLimLo:  1D DG expansion of the function yLimUp(x) giving the upper limit of the y integral.
  // dyDo:    y cell length of the donor cell.
  // yOff:    yOffset between the donor and target cells (in the direction of the shift).
  // ySh:     yShift translated to [-1,1] logical space.
  // tsmat: twist-shift matrix.

  // Length of the subregion in which the DG expansion of the yLimLo/yLimUp functions are defined.
  double dxLim = xLimUp-xLimLo;

  // Logical center of the subregion in which the DG expansion of the yLimLo/yLimUp functions are defined.
  double xcLim = 0.5*(xLimUp+xLimLo);

  double xLimLoR2 = pow(xLimLo,2);
  double xLimLoR3 = pow(xLimLo,3);
  double xLimLoR4 = pow(xLimLo,4);
  double xLimLoR5 = pow(xLimLo,5);
  double xLimLoR6 = pow(xLimLo,6);
  double xLimUpR2 = pow(xLimUp,2);
  double xLimUpR3 = pow(xLimUp,3);
  double xLimUpR4 = pow(xLimUp,4);
  double xLimUpR5 = pow(xLimUp,5);
  double xLimUpR6 = pow(xLimUp,6);
  double dxLimR2 = pow(dxLim,2);
  double dxLimR3 = pow(dxLim,3);
  double xcLimR2 = pow(xcLim,2);
  double xcLimR3 = pow(xcLim,3);
  double yLimLo0R2 = pow(yLimLo[0],2);
  double yLimLo1R2 = pow(yLimLo[1],2);
  double yLimLo0R3 = pow(yLimLo[0],3);
  double yLimLo1R3 = pow(yLimLo[1],3);
  double yLimUp0R2 = pow(yLimUp[0],2);
  double yLimUp1R2 = pow(yLimUp[1],2);
  double yLimUp0R3 = pow(yLimUp[0],3);
  double yLimUp1R3 = pow(yLimUp[1],3);

  gkyl_mat_inc(tsmat, 0,0, -((0.125*(((4.898979485566357*yLimUp[1]-4.898979485566357*yLimLo[1])*sFac*xLimUp+(4.898979485566357*yLimLo[1]-4.898979485566357*yLimUp[1])*sFac*xLimLo)*xcLim+(2.4494897427831783*yLimLo[1]-2.4494897427831783*yLimUp[1])*sFac*xLimUpR2+(1.4142135623730951*yLimLo[0]-1.4142135623730951*yLimUp[0])*dxLim*sFac*xLimUp+(2.4494897427831783*yLimUp[1]-2.4494897427831783*yLimLo[1])*sFac*xLimLoR2+(1.4142135623730951*yLimUp[0]-1.4142135623730951*yLimLo[0])*dxLim*sFac*xLimLo))/dxLim)); 
  gkyl_mat_inc(tsmat, 0,1, -((0.0625*(((8.485281374238571*yLimUp[1]-8.485281374238571*yLimLo[1])*sFac*xLimUpR2+(8.485281374238571*yLimLo[1]-8.485281374238571*yLimUp[1])*sFac*xLimLoR2)*xcLim+(5.656854249492383*yLimLo[1]-5.656854249492383*yLimUp[1])*sFac*xLimUpR3+(2.4494897427831783*yLimLo[0]-2.4494897427831783*yLimUp[0])*dxLim*sFac*xLimUpR2+(5.656854249492383*yLimUp[1]-5.656854249492383*yLimLo[1])*sFac*xLimLoR3+(2.4494897427831783*yLimUp[0]-2.4494897427831783*yLimLo[0])*dxLim*sFac*xLimLoR2))/dxLim)); 
  gkyl_mat_inc(tsmat, 0,2, (0.0625*(((20.784609690826525*yLimUp1R2-20.784609690826525*yLimLo1R2)*sFac*xLimUp+(20.784609690826525*yLimLo1R2-20.784609690826525*yLimUp1R2)*sFac*xLimLo)*xcLimR2+((20.784609690826525*yLimLo1R2-20.784609690826525*yLimUp1R2)*sFac*xLimUpR2+(12.0*yLimLo[0]*yLimLo[1]-12.0*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimUp+(20.784609690826525*yLimUp1R2-20.784609690826525*yLimLo1R2)*sFac*xLimLoR2+(12.0*yLimUp[0]*yLimUp[1]-12.0*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimLo)*xcLim+(6.928203230275509*yLimUp1R2-6.928203230275509*yLimLo1R2)*sFac*xLimUpR3+(6.0*yLimUp[0]*yLimUp[1]-6.0*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimUpR2+(1.7320508075688772*yLimUp0R2-1.7320508075688772*yLimLo0R2)*dxLimR2*sFac*xLimUp+(6.928203230275509*yLimLo1R2-6.928203230275509*yLimUp1R2)*sFac*xLimLoR3+(6.0*yLimLo[0]*yLimLo[1]-6.0*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimLoR2+(1.7320508075688772*yLimLo0R2-1.7320508075688772*yLimUp0R2)*dxLimR2*sFac*xLimLo))/dxLimR2); 
  gkyl_mat_inc(tsmat, 0,3, (0.03125*(((36.0*yLimUp1R2-36.0*yLimLo1R2)*sFac*xLimUpR2+(36.0*yLimLo1R2-36.0*yLimUp1R2)*sFac*xLimLoR2)*xcLimR2+((48.0*yLimLo1R2-48.0*yLimUp1R2)*sFac*xLimUpR3+(20.784609690826525*yLimLo[0]*yLimLo[1]-20.784609690826525*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimUpR2+(48.0*yLimUp1R2-48.0*yLimLo1R2)*sFac*xLimLoR3+(20.784609690826525*yLimUp[0]*yLimUp[1]-20.784609690826525*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimLoR2)*xcLim+(18.0*yLimUp1R2-18.0*yLimLo1R2)*sFac*xLimUpR4+(13.856406460551018*yLimUp[0]*yLimUp[1]-13.856406460551018*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimUpR3+(3.0*yLimUp0R2-3.0*yLimLo0R2)*dxLimR2*sFac*xLimUpR2+(18.0*yLimLo1R2-18.0*yLimUp1R2)*sFac*xLimLoR4+(13.856406460551018*yLimLo[0]*yLimLo[1]-13.856406460551018*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimLoR3+(3.0*yLimLo0R2-3.0*yLimUp0R2)*dxLimR2*sFac*xLimLoR2))/dxLimR2); 
  gkyl_mat_inc(tsmat, 1,0, -((0.0625*(((8.485281374238571*yLimUp[1]-8.485281374238571*yLimLo[1])*sFac*xLimUpR2+(8.485281374238571*yLimLo[1]-8.485281374238571*yLimUp[1])*sFac*xLimLoR2)*xcLim+(5.656854249492383*yLimLo[1]-5.656854249492383*yLimUp[1])*sFac*xLimUpR3+(2.4494897427831783*yLimLo[0]-2.4494897427831783*yLimUp[0])*dxLim*sFac*xLimUpR2+(5.656854249492383*yLimUp[1]-5.656854249492383*yLimLo[1])*sFac*xLimLoR3+(2.4494897427831783*yLimUp[0]-2.4494897427831783*yLimLo[0])*dxLim*sFac*xLimLoR2))/dxLim)); 
  gkyl_mat_inc(tsmat, 1,1, -((0.0625*(((9.797958971132717*yLimUp[1]-9.797958971132717*yLimLo[1])*sFac*xLimUpR3+(9.797958971132717*yLimLo[1]-9.797958971132717*yLimUp[1])*sFac*xLimLoR3)*xcLim+(7.348469228349534*yLimLo[1]-7.348469228349534*yLimUp[1])*sFac*xLimUpR4+(2.8284271247461907*yLimLo[0]-2.8284271247461907*yLimUp[0])*dxLim*sFac*xLimUpR3+(7.348469228349534*yLimUp[1]-7.348469228349534*yLimLo[1])*sFac*xLimLoR4+(2.8284271247461907*yLimUp[0]-2.8284271247461907*yLimLo[0])*dxLim*sFac*xLimLoR3))/dxLim)); 
  gkyl_mat_inc(tsmat, 1,2, (0.03125*(((36.0*yLimUp1R2-36.0*yLimLo1R2)*sFac*xLimUpR2+(36.0*yLimLo1R2-36.0*yLimUp1R2)*sFac*xLimLoR2)*xcLimR2+((48.0*yLimLo1R2-48.0*yLimUp1R2)*sFac*xLimUpR3+(20.784609690826525*yLimLo[0]*yLimLo[1]-20.784609690826525*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimUpR2+(48.0*yLimUp1R2-48.0*yLimLo1R2)*sFac*xLimLoR3+(20.784609690826525*yLimUp[0]*yLimUp[1]-20.784609690826525*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimLoR2)*xcLim+(18.0*yLimUp1R2-18.0*yLimLo1R2)*sFac*xLimUpR4+(13.856406460551018*yLimUp[0]*yLimUp[1]-13.856406460551018*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimUpR3+(3.0*yLimUp0R2-3.0*yLimLo0R2)*dxLimR2*sFac*xLimUpR2+(18.0*yLimLo1R2-18.0*yLimUp1R2)*sFac*xLimLoR4+(13.856406460551018*yLimLo[0]*yLimLo[1]-13.856406460551018*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimLoR3+(3.0*yLimLo0R2-3.0*yLimUp0R2)*dxLimR2*sFac*xLimLoR2))/dxLimR2); 
  gkyl_mat_inc(tsmat, 1,3, (0.0125*(((103.92304845413263*yLimUp1R2-103.92304845413263*yLimLo1R2)*sFac*xLimUpR3+(103.92304845413263*yLimLo1R2-103.92304845413263*yLimUp1R2)*sFac*xLimLoR3)*xcLimR2+((155.88457268119893*yLimLo1R2-155.88457268119893*yLimUp1R2)*sFac*xLimUpR4+(60.0*yLimLo[0]*yLimLo[1]-60.0*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimUpR3+(155.88457268119893*yLimUp1R2-155.88457268119893*yLimLo1R2)*sFac*xLimLoR4+(60.0*yLimUp[0]*yLimUp[1]-60.0*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimLoR3)*xcLim+(62.35382907247957*yLimUp1R2-62.35382907247957*yLimLo1R2)*sFac*xLimUpR5+(45.0*yLimUp[0]*yLimUp[1]-45.0*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimUpR4+(8.660254037844386*yLimUp0R2-8.660254037844386*yLimLo0R2)*dxLimR2*sFac*xLimUpR3+(62.35382907247957*yLimLo1R2-62.35382907247957*yLimUp1R2)*sFac*xLimLoR5+(45.0*yLimLo[0]*yLimLo[1]-45.0*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimLoR4+(8.660254037844386*yLimLo0R2-8.660254037844386*yLimUp0R2)*dxLimR2*sFac*xLimLoR3))/dxLimR2); 
  gkyl_mat_inc(tsmat, 2,0, (0.0625*((((33.94112549695431*yLimUp[1]-33.94112549695431*yLimLo[1])*dxLim*sFac*xLimUp+(33.94112549695431*yLimLo[1]-33.94112549695431*yLimUp[1])*dxLim*sFac*xLimLo)*xcLim+(16.97056274847715*yLimLo[1]-16.97056274847715*yLimUp[1])*dxLim*sFac*xLimUpR2+(9.797958971132717*yLimLo[0]-9.797958971132717*yLimUp[0])*dxLimR2*sFac*xLimUp+(16.97056274847715*yLimUp[1]-16.97056274847715*yLimLo[1])*dxLim*sFac*xLimLoR2+(9.797958971132717*yLimUp[0]-9.797958971132717*yLimLo[0])*dxLimR2*sFac*xLimLo)*yOff+((20.784609690826525*yLimUp1R2-20.784609690826525*yLimLo1R2)*dyDo*sFac*xLimUp+(20.784609690826525*yLimLo1R2-20.784609690826525*yLimUp1R2)*dyDo*sFac*xLimLo)*xcLimR2+(((20.784609690826525*yLimLo1R2-20.784609690826525*yLimUp1R2)*dyDo+(20.784609690826525*yLimLo[1]-20.784609690826525*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimUpR2+((12.0*yLimLo[0]*yLimLo[1]-12.0*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(24.0*ySh[0]*yLimLo[1]-24.0*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimUp+((20.784609690826525*yLimUp1R2-20.784609690826525*yLimLo1R2)*dyDo+(20.784609690826525*yLimUp[1]-20.784609690826525*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimLoR2+((12.0*yLimUp[0]*yLimUp[1]-12.0*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(24.0*ySh[0]*yLimUp[1]-24.0*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimLo)*xcLim+((6.928203230275509*yLimUp1R2-6.928203230275509*yLimLo1R2)*dyDo+(13.856406460551018*yLimUp[1]-13.856406460551018*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimUpR3+((6.0*yLimUp[0]*yLimUp[1]-6.0*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(6.0*yLimUp[0]-6.0*yLimLo[0])*ySh[1]*dxLimR2+(12.0*ySh[0]*yLimUp[1]-12.0*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimUpR2+((1.7320508075688772*yLimUp0R2-1.7320508075688772*yLimLo0R2)*dxLimR2*dyDo+(6.928203230275509*yLimUp[0]-6.928203230275509*yLimLo[0])*ySh[0]*dxLimR2)*sFac*xLimUp+((6.928203230275509*yLimLo1R2-6.928203230275509*yLimUp1R2)*dyDo+(13.856406460551018*yLimLo[1]-13.856406460551018*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimLoR3+((6.0*yLimLo[0]*yLimLo[1]-6.0*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(6.0*yLimLo[0]-6.0*yLimUp[0])*ySh[1]*dxLimR2+(12.0*ySh[0]*yLimLo[1]-12.0*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimLoR2+((1.7320508075688772*yLimLo0R2-1.7320508075688772*yLimUp0R2)*dxLimR2*dyDo+(6.928203230275509*yLimLo[0]-6.928203230275509*yLimUp[0])*ySh[0]*dxLimR2)*sFac*xLimLo))/(dxLimR2*dyDo)); 
  gkyl_mat_inc(tsmat, 2,1, (0.03125*((((58.787753826796305*yLimUp[1]-58.787753826796305*yLimLo[1])*dxLim*sFac*xLimUpR2+(58.787753826796305*yLimLo[1]-58.787753826796305*yLimUp[1])*dxLim*sFac*xLimLoR2)*xcLim+(39.19183588453089*yLimLo[1]-39.19183588453089*yLimUp[1])*dxLim*sFac*xLimUpR3+(16.97056274847715*yLimLo[0]-16.97056274847715*yLimUp[0])*dxLimR2*sFac*xLimUpR2+(39.19183588453089*yLimUp[1]-39.19183588453089*yLimLo[1])*dxLim*sFac*xLimLoR3+(16.97056274847715*yLimUp[0]-16.97056274847715*yLimLo[0])*dxLimR2*sFac*xLimLoR2)*yOff+((36.0*yLimUp1R2-36.0*yLimLo1R2)*dyDo*sFac*xLimUpR2+(36.0*yLimLo1R2-36.0*yLimUp1R2)*dyDo*sFac*xLimLoR2)*xcLimR2+(((48.0*yLimLo1R2-48.0*yLimUp1R2)*dyDo+(48.0*yLimLo[1]-48.0*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimUpR3+((20.784609690826525*yLimLo[0]*yLimLo[1]-20.784609690826525*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(41.56921938165305*ySh[0]*yLimLo[1]-41.56921938165305*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimUpR2+((48.0*yLimUp1R2-48.0*yLimLo1R2)*dyDo+(48.0*yLimUp[1]-48.0*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimLoR3+((20.784609690826525*yLimUp[0]*yLimUp[1]-20.784609690826525*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(41.56921938165305*ySh[0]*yLimUp[1]-41.56921938165305*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimLoR2)*xcLim+((18.0*yLimUp1R2-18.0*yLimLo1R2)*dyDo+(36.0*yLimUp[1]-36.0*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimUpR4+((13.856406460551018*yLimUp[0]*yLimUp[1]-13.856406460551018*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(13.856406460551018*yLimUp[0]-13.856406460551018*yLimLo[0])*ySh[1]*dxLimR2+(27.712812921102035*ySh[0]*yLimUp[1]-27.712812921102035*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimUpR3+((3.0*yLimUp0R2-3.0*yLimLo0R2)*dxLimR2*dyDo+(12.0*yLimUp[0]-12.0*yLimLo[0])*ySh[0]*dxLimR2)*sFac*xLimUpR2+((18.0*yLimLo1R2-18.0*yLimUp1R2)*dyDo+(36.0*yLimLo[1]-36.0*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimLoR4+((13.856406460551018*yLimLo[0]*yLimLo[1]-13.856406460551018*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(13.856406460551018*yLimLo[0]-13.856406460551018*yLimUp[0])*ySh[1]*dxLimR2+(27.712812921102035*ySh[0]*yLimLo[1]-27.712812921102035*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimLoR3+((3.0*yLimLo0R2-3.0*yLimUp0R2)*dxLimR2*dyDo+(12.0*yLimLo[0]-12.0*yLimUp[0])*ySh[0]*dxLimR2)*sFac*xLimLoR2))/(dxLimR2*dyDo)); 
  gkyl_mat_inc(tsmat, 2,2, -((0.03125*((((144.0*yLimUp1R2-144.0*yLimLo1R2)*dxLim*sFac*xLimUp+(144.0*yLimLo1R2-144.0*yLimUp1R2)*dxLim*sFac*xLimLo)*xcLimR2+((144.0*yLimLo1R2-144.0*yLimUp1R2)*dxLim*sFac*xLimUpR2+(83.1384387633061*yLimLo[0]*yLimLo[1]-83.1384387633061*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimUp+(144.0*yLimUp1R2-144.0*yLimLo1R2)*dxLim*sFac*xLimLoR2+(83.1384387633061*yLimUp[0]*yLimUp[1]-83.1384387633061*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimLo)*xcLim+(48.0*yLimUp1R2-48.0*yLimLo1R2)*dxLim*sFac*xLimUpR3+(41.56921938165305*yLimUp[0]*yLimUp[1]-41.56921938165305*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimUpR2+(12.0*yLimUp0R2-12.0*yLimLo0R2)*dxLimR3*sFac*xLimUp+(48.0*yLimLo1R2-48.0*yLimUp1R2)*dxLim*sFac*xLimLoR3+(41.56921938165305*yLimLo[0]*yLimLo[1]-41.56921938165305*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimLoR2+(12.0*yLimLo0R2-12.0*yLimUp0R2)*dxLimR3*sFac*xLimLo)*yOff+((117.57550765359265*yLimUp1R3-117.57550765359265*yLimLo1R3)*dyDo*sFac*xLimUp+(117.57550765359265*yLimLo1R3-117.57550765359265*yLimUp1R3)*dyDo*sFac*xLimLo)*xcLimR3+(((176.3632614803889*yLimLo1R3-176.3632614803889*yLimUp1R3)*dyDo+(88.18163074019444*yLimLo1R2-88.18163074019444*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR2+((101.82337649086291*yLimLo[0]*yLimLo1R2-101.82337649086291*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(101.82337649086291*ySh[0]*yLimLo1R2-101.82337649086291*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUp+((176.3632614803889*yLimUp1R3-176.3632614803889*yLimLo1R3)*dyDo+(88.18163074019444*yLimUp1R2-88.18163074019444*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR2+((101.82337649086291*yLimUp[0]*yLimUp1R2-101.82337649086291*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(101.82337649086291*ySh[0]*yLimUp1R2-101.82337649086291*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLo)*xcLimR2+(((117.57550765359265*yLimUp1R3-117.57550765359265*yLimLo1R3)*dyDo+(117.57550765359265*yLimUp1R2-117.57550765359265*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimUpR3+((101.82337649086291*yLimUp[0]*yLimUp1R2-101.82337649086291*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(50.91168824543145*yLimUp[0]*yLimUp[1]-50.91168824543145*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(101.82337649086291*ySh[0]*yLimUp1R2-101.82337649086291*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimUpR2+((29.39387691339815*yLimUp0R2*yLimUp[1]-29.39387691339815*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(58.787753826796305*yLimUp[0]*ySh[0]*yLimUp[1]-58.787753826796305*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimUp+((117.57550765359265*yLimLo1R3-117.57550765359265*yLimUp1R3)*dyDo+(117.57550765359265*yLimLo1R2-117.57550765359265*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimLoR3+((101.82337649086291*yLimLo[0]*yLimLo1R2-101.82337649086291*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(50.91168824543145*yLimLo[0]*yLimLo[1]-50.91168824543145*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(101.82337649086291*ySh[0]*yLimLo1R2-101.82337649086291*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimLoR2+((29.39387691339815*yLimLo0R2*yLimLo[1]-29.39387691339815*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(58.787753826796305*yLimLo[0]*ySh[0]*yLimLo[1]-58.787753826796305*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimLo)*xcLim+((29.39387691339815*yLimLo1R3-29.39387691339815*yLimUp1R3)*dyDo+(44.090815370097204*yLimLo1R2-44.090815370097204*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR4+((33.94112549695431*yLimLo[0]*yLimLo1R2-33.94112549695431*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(33.94112549695431*yLimLo[0]*yLimLo[1]-33.94112549695431*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(33.94112549695431*ySh[0]*yLimLo1R2-33.94112549695431*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR3+((14.696938456699069*yLimLo0R2*yLimLo[1]-14.696938456699069*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(7.348469228349534*yLimLo0R2-7.348469228349534*yLimUp0R2)*ySh[1]*dxLimR3+(29.39387691339815*yLimLo[0]*ySh[0]*yLimLo[1]-29.39387691339815*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimUpR2+((2.8284271247461907*yLimLo0R3-2.8284271247461907*yLimUp0R3)*dxLimR3*dyDo+(8.485281374238571*yLimLo0R2-8.485281374238571*yLimUp0R2)*ySh[0]*dxLimR3)*sFac*xLimUp+((29.39387691339815*yLimUp1R3-29.39387691339815*yLimLo1R3)*dyDo+(44.090815370097204*yLimUp1R2-44.090815370097204*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR4+((33.94112549695431*yLimUp[0]*yLimUp1R2-33.94112549695431*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(33.94112549695431*yLimUp[0]*yLimUp[1]-33.94112549695431*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(33.94112549695431*ySh[0]*yLimUp1R2-33.94112549695431*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR3+((14.696938456699069*yLimUp0R2*yLimUp[1]-14.696938456699069*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(7.348469228349534*yLimUp0R2-7.348469228349534*yLimLo0R2)*ySh[1]*dxLimR3+(29.39387691339815*yLimUp[0]*ySh[0]*yLimUp[1]-29.39387691339815*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimLoR2+((2.8284271247461907*yLimUp0R3-2.8284271247461907*yLimLo0R3)*dxLimR3*dyDo+(8.485281374238571*yLimUp0R2-8.485281374238571*yLimLo0R2)*ySh[0]*dxLimR3)*sFac*xLimLo))/(dxLimR3*dyDo))); 
  gkyl_mat_inc(tsmat, 2,3, -((0.00625*((((623.5382907247957*yLimUp1R2-623.5382907247957*yLimLo1R2)*dxLim*sFac*xLimUpR2+(623.5382907247957*yLimLo1R2-623.5382907247957*yLimUp1R2)*dxLim*sFac*xLimLoR2)*xcLimR2+((831.384387633061*yLimLo1R2-831.384387633061*yLimUp1R2)*dxLim*sFac*xLimUpR3+(360.0*yLimLo[0]*yLimLo[1]-360.0*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimUpR2+(831.384387633061*yLimUp1R2-831.384387633061*yLimLo1R2)*dxLim*sFac*xLimLoR3+(360.0*yLimUp[0]*yLimUp[1]-360.0*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimLoR2)*xcLim+(311.76914536239786*yLimUp1R2-311.76914536239786*yLimLo1R2)*dxLim*sFac*xLimUpR4+(240.0*yLimUp[0]*yLimUp[1]-240.0*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimUpR3+(51.96152422706631*yLimUp0R2-51.96152422706631*yLimLo0R2)*dxLimR3*sFac*xLimUpR2+(311.76914536239786*yLimLo1R2-311.76914536239786*yLimUp1R2)*dxLim*sFac*xLimLoR4+(240.0*yLimLo[0]*yLimLo[1]-240.0*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimLoR3+(51.96152422706631*yLimLo0R2-51.96152422706631*yLimUp0R2)*dxLimR3*sFac*xLimLoR2)*yOff+((509.1168824543146*yLimUp1R3-509.1168824543146*yLimLo1R3)*dyDo*sFac*xLimUpR2+(509.1168824543146*yLimLo1R3-509.1168824543146*yLimUp1R3)*dyDo*sFac*xLimLoR2)*xcLimR3+(((1018.2337649086295*yLimLo1R3-1018.2337649086295*yLimUp1R3)*dyDo+(509.1168824543146*yLimLo1R2-509.1168824543146*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR3+((440.9081537009722*yLimLo[0]*yLimLo1R2-440.9081537009722*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(440.9081537009722*ySh[0]*yLimLo1R2-440.9081537009722*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR2+((1018.2337649086295*yLimUp1R3-1018.2337649086295*yLimLo1R3)*dyDo+(509.1168824543146*yLimUp1R2-509.1168824543146*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR3+((440.9081537009722*yLimUp[0]*yLimUp1R2-440.9081537009722*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(440.9081537009722*ySh[0]*yLimUp1R2-440.9081537009722*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR2)*xcLimR2+(((763.6753236814717*yLimUp1R3-763.6753236814717*yLimLo1R3)*dyDo+(763.6753236814717*yLimUp1R2-763.6753236814717*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimUpR4+((587.8775382679632*yLimUp[0]*yLimUp1R2-587.8775382679632*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(293.9387691339815*yLimUp[0]*yLimUp[1]-293.9387691339815*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(587.8775382679632*ySh[0]*yLimUp1R2-587.8775382679632*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimUpR3+((127.27922061357859*yLimUp0R2*yLimUp[1]-127.27922061357859*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(254.55844122715723*yLimUp[0]*ySh[0]*yLimUp[1]-254.55844122715723*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimUpR2+((763.6753236814717*yLimLo1R3-763.6753236814717*yLimUp1R3)*dyDo+(763.6753236814717*yLimLo1R2-763.6753236814717*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimLoR4+((587.8775382679632*yLimLo[0]*yLimLo1R2-587.8775382679632*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(293.9387691339815*yLimLo[0]*yLimLo[1]-293.9387691339815*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(587.8775382679632*ySh[0]*yLimLo1R2-587.8775382679632*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimLoR3+((127.27922061357859*yLimLo0R2*yLimLo[1]-127.27922061357859*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(254.55844122715723*yLimLo[0]*ySh[0]*yLimLo[1]-254.55844122715723*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimLoR2)*xcLim+((203.64675298172588*yLimLo1R3-203.64675298172588*yLimUp1R3)*dyDo+(305.4701294725887*yLimLo1R2-305.4701294725887*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR5+((220.45407685048605*yLimLo[0]*yLimLo1R2-220.45407685048605*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(220.45407685048605*yLimLo[0]*yLimLo[1]-220.45407685048605*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(220.45407685048605*ySh[0]*yLimLo1R2-220.45407685048605*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR4+((84.85281374238575*yLimLo0R2*yLimLo[1]-84.85281374238575*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(42.42640687119286*yLimLo0R2-42.42640687119286*yLimUp0R2)*ySh[1]*dxLimR3+(169.70562748477153*yLimLo[0]*ySh[0]*yLimLo[1]-169.70562748477153*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimUpR3+((12.24744871391589*yLimLo0R3-12.24744871391589*yLimUp0R3)*dxLimR3*dyDo+(36.74234614174767*yLimLo0R2-36.74234614174767*yLimUp0R2)*ySh[0]*dxLimR3)*sFac*xLimUpR2+((203.64675298172588*yLimUp1R3-203.64675298172588*yLimLo1R3)*dyDo+(305.4701294725887*yLimUp1R2-305.4701294725887*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR5+((220.45407685048605*yLimUp[0]*yLimUp1R2-220.45407685048605*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(220.45407685048605*yLimUp[0]*yLimUp[1]-220.45407685048605*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(220.45407685048605*ySh[0]*yLimUp1R2-220.45407685048605*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR4+((84.85281374238575*yLimUp0R2*yLimUp[1]-84.85281374238575*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(42.42640687119286*yLimUp0R2-42.42640687119286*yLimLo0R2)*ySh[1]*dxLimR3+(169.70562748477153*yLimUp[0]*ySh[0]*yLimUp[1]-169.70562748477153*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimLoR3+((12.24744871391589*yLimUp0R3-12.24744871391589*yLimLo0R3)*dxLimR3*dyDo+(36.74234614174767*yLimUp0R2-36.74234614174767*yLimLo0R2)*ySh[0]*dxLimR3)*sFac*xLimLoR2))/(dxLimR3*dyDo))); 
  gkyl_mat_inc(tsmat, 3,0, (0.03125*((((58.787753826796305*yLimUp[1]-58.787753826796305*yLimLo[1])*dxLim*sFac*xLimUpR2+(58.787753826796305*yLimLo[1]-58.787753826796305*yLimUp[1])*dxLim*sFac*xLimLoR2)*xcLim+(39.19183588453089*yLimLo[1]-39.19183588453089*yLimUp[1])*dxLim*sFac*xLimUpR3+(16.97056274847715*yLimLo[0]-16.97056274847715*yLimUp[0])*dxLimR2*sFac*xLimUpR2+(39.19183588453089*yLimUp[1]-39.19183588453089*yLimLo[1])*dxLim*sFac*xLimLoR3+(16.97056274847715*yLimUp[0]-16.97056274847715*yLimLo[0])*dxLimR2*sFac*xLimLoR2)*yOff+((36.0*yLimUp1R2-36.0*yLimLo1R2)*dyDo*sFac*xLimUpR2+(36.0*yLimLo1R2-36.0*yLimUp1R2)*dyDo*sFac*xLimLoR2)*xcLimR2+(((48.0*yLimLo1R2-48.0*yLimUp1R2)*dyDo+(48.0*yLimLo[1]-48.0*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimUpR3+((20.784609690826525*yLimLo[0]*yLimLo[1]-20.784609690826525*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(41.56921938165305*ySh[0]*yLimLo[1]-41.56921938165305*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimUpR2+((48.0*yLimUp1R2-48.0*yLimLo1R2)*dyDo+(48.0*yLimUp[1]-48.0*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimLoR3+((20.784609690826525*yLimUp[0]*yLimUp[1]-20.784609690826525*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(41.56921938165305*ySh[0]*yLimUp[1]-41.56921938165305*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimLoR2)*xcLim+((18.0*yLimUp1R2-18.0*yLimLo1R2)*dyDo+(36.0*yLimUp[1]-36.0*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimUpR4+((13.856406460551018*yLimUp[0]*yLimUp[1]-13.856406460551018*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(13.856406460551018*yLimUp[0]-13.856406460551018*yLimLo[0])*ySh[1]*dxLimR2+(27.712812921102035*ySh[0]*yLimUp[1]-27.712812921102035*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimUpR3+((3.0*yLimUp0R2-3.0*yLimLo0R2)*dxLimR2*dyDo+(12.0*yLimUp[0]-12.0*yLimLo[0])*ySh[0]*dxLimR2)*sFac*xLimUpR2+((18.0*yLimLo1R2-18.0*yLimUp1R2)*dyDo+(36.0*yLimLo[1]-36.0*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimLoR4+((13.856406460551018*yLimLo[0]*yLimLo[1]-13.856406460551018*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(13.856406460551018*yLimLo[0]-13.856406460551018*yLimUp[0])*ySh[1]*dxLimR2+(27.712812921102035*ySh[0]*yLimLo[1]-27.712812921102035*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimLoR3+((3.0*yLimLo0R2-3.0*yLimUp0R2)*dxLimR2*dyDo+(12.0*yLimLo[0]-12.0*yLimUp[0])*ySh[0]*dxLimR2)*sFac*xLimLoR2))/(dxLimR2*dyDo)); 
  gkyl_mat_inc(tsmat, 3,1, (0.0125*((((169.70562748477153*yLimUp[1]-169.70562748477153*yLimLo[1])*dxLim*sFac*xLimUpR3+(169.70562748477153*yLimLo[1]-169.70562748477153*yLimUp[1])*dxLim*sFac*xLimLoR3)*xcLim+(127.27922061357859*yLimLo[1]-127.27922061357859*yLimUp[1])*dxLim*sFac*xLimUpR4+(48.98979485566358*yLimLo[0]-48.98979485566358*yLimUp[0])*dxLimR2*sFac*xLimUpR3+(127.27922061357859*yLimUp[1]-127.27922061357859*yLimLo[1])*dxLim*sFac*xLimLoR4+(48.98979485566358*yLimUp[0]-48.98979485566358*yLimLo[0])*dxLimR2*sFac*xLimLoR3)*yOff+((103.92304845413263*yLimUp1R2-103.92304845413263*yLimLo1R2)*dyDo*sFac*xLimUpR3+(103.92304845413263*yLimLo1R2-103.92304845413263*yLimUp1R2)*dyDo*sFac*xLimLoR3)*xcLimR2+(((155.88457268119893*yLimLo1R2-155.88457268119893*yLimUp1R2)*dyDo+(155.88457268119893*yLimLo[1]-155.88457268119893*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimUpR4+((60.0*yLimLo[0]*yLimLo[1]-60.0*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(120.0*ySh[0]*yLimLo[1]-120.0*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimUpR3+((155.88457268119893*yLimUp1R2-155.88457268119893*yLimLo1R2)*dyDo+(155.88457268119893*yLimUp[1]-155.88457268119893*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimLoR4+((60.0*yLimUp[0]*yLimUp[1]-60.0*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(120.0*ySh[0]*yLimUp[1]-120.0*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimLoR3)*xcLim+((62.35382907247957*yLimUp1R2-62.35382907247957*yLimLo1R2)*dyDo+(124.70765814495914*yLimUp[1]-124.70765814495914*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimUpR5+((45.0*yLimUp[0]*yLimUp[1]-45.0*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(45.0*yLimUp[0]-45.0*yLimLo[0])*ySh[1]*dxLimR2+(90.0*ySh[0]*yLimUp[1]-90.0*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimUpR4+((8.660254037844386*yLimUp0R2-8.660254037844386*yLimLo0R2)*dxLimR2*dyDo+(34.64101615137754*yLimUp[0]-34.64101615137754*yLimLo[0])*ySh[0]*dxLimR2)*sFac*xLimUpR3+((62.35382907247957*yLimLo1R2-62.35382907247957*yLimUp1R2)*dyDo+(124.70765814495914*yLimLo[1]-124.70765814495914*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimLoR5+((45.0*yLimLo[0]*yLimLo[1]-45.0*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(45.0*yLimLo[0]-45.0*yLimUp[0])*ySh[1]*dxLimR2+(90.0*ySh[0]*yLimLo[1]-90.0*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimLoR4+((8.660254037844386*yLimLo0R2-8.660254037844386*yLimUp0R2)*dxLimR2*dyDo+(34.64101615137754*yLimLo[0]-34.64101615137754*yLimUp[0])*ySh[0]*dxLimR2)*sFac*xLimLoR3))/(dxLimR2*dyDo)); 
  gkyl_mat_inc(tsmat, 3,2, -((0.00625*((((623.5382907247957*yLimUp1R2-623.5382907247957*yLimLo1R2)*dxLim*sFac*xLimUpR2+(623.5382907247957*yLimLo1R2-623.5382907247957*yLimUp1R2)*dxLim*sFac*xLimLoR2)*xcLimR2+((831.384387633061*yLimLo1R2-831.384387633061*yLimUp1R2)*dxLim*sFac*xLimUpR3+(360.0*yLimLo[0]*yLimLo[1]-360.0*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimUpR2+(831.384387633061*yLimUp1R2-831.384387633061*yLimLo1R2)*dxLim*sFac*xLimLoR3+(360.0*yLimUp[0]*yLimUp[1]-360.0*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimLoR2)*xcLim+(311.76914536239786*yLimUp1R2-311.76914536239786*yLimLo1R2)*dxLim*sFac*xLimUpR4+(240.0*yLimUp[0]*yLimUp[1]-240.0*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimUpR3+(51.96152422706631*yLimUp0R2-51.96152422706631*yLimLo0R2)*dxLimR3*sFac*xLimUpR2+(311.76914536239786*yLimLo1R2-311.76914536239786*yLimUp1R2)*dxLim*sFac*xLimLoR4+(240.0*yLimLo[0]*yLimLo[1]-240.0*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimLoR3+(51.96152422706631*yLimLo0R2-51.96152422706631*yLimUp0R2)*dxLimR3*sFac*xLimLoR2)*yOff+((509.1168824543146*yLimUp1R3-509.1168824543146*yLimLo1R3)*dyDo*sFac*xLimUpR2+(509.1168824543146*yLimLo1R3-509.1168824543146*yLimUp1R3)*dyDo*sFac*xLimLoR2)*xcLimR3+(((1018.2337649086295*yLimLo1R3-1018.2337649086295*yLimUp1R3)*dyDo+(509.1168824543146*yLimLo1R2-509.1168824543146*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR3+((440.9081537009722*yLimLo[0]*yLimLo1R2-440.9081537009722*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(440.9081537009722*ySh[0]*yLimLo1R2-440.9081537009722*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR2+((1018.2337649086295*yLimUp1R3-1018.2337649086295*yLimLo1R3)*dyDo+(509.1168824543146*yLimUp1R2-509.1168824543146*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR3+((440.9081537009722*yLimUp[0]*yLimUp1R2-440.9081537009722*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(440.9081537009722*ySh[0]*yLimUp1R2-440.9081537009722*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR2)*xcLimR2+(((763.6753236814717*yLimUp1R3-763.6753236814717*yLimLo1R3)*dyDo+(763.6753236814717*yLimUp1R2-763.6753236814717*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimUpR4+((587.8775382679632*yLimUp[0]*yLimUp1R2-587.8775382679632*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(293.9387691339815*yLimUp[0]*yLimUp[1]-293.9387691339815*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(587.8775382679632*ySh[0]*yLimUp1R2-587.8775382679632*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimUpR3+((127.27922061357859*yLimUp0R2*yLimUp[1]-127.27922061357859*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(254.55844122715723*yLimUp[0]*ySh[0]*yLimUp[1]-254.55844122715723*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimUpR2+((763.6753236814717*yLimLo1R3-763.6753236814717*yLimUp1R3)*dyDo+(763.6753236814717*yLimLo1R2-763.6753236814717*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimLoR4+((587.8775382679632*yLimLo[0]*yLimLo1R2-587.8775382679632*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(293.9387691339815*yLimLo[0]*yLimLo[1]-293.9387691339815*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(587.8775382679632*ySh[0]*yLimLo1R2-587.8775382679632*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimLoR3+((127.27922061357859*yLimLo0R2*yLimLo[1]-127.27922061357859*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(254.55844122715723*yLimLo[0]*ySh[0]*yLimLo[1]-254.55844122715723*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimLoR2)*xcLim+((203.64675298172588*yLimLo1R3-203.64675298172588*yLimUp1R3)*dyDo+(305.4701294725887*yLimLo1R2-305.4701294725887*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR5+((220.45407685048605*yLimLo[0]*yLimLo1R2-220.45407685048605*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(220.45407685048605*yLimLo[0]*yLimLo[1]-220.45407685048605*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(220.45407685048605*ySh[0]*yLimLo1R2-220.45407685048605*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR4+((84.85281374238575*yLimLo0R2*yLimLo[1]-84.85281374238575*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(42.42640687119286*yLimLo0R2-42.42640687119286*yLimUp0R2)*ySh[1]*dxLimR3+(169.70562748477153*yLimLo[0]*ySh[0]*yLimLo[1]-169.70562748477153*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimUpR3+((12.24744871391589*yLimLo0R3-12.24744871391589*yLimUp0R3)*dxLimR3*dyDo+(36.74234614174767*yLimLo0R2-36.74234614174767*yLimUp0R2)*ySh[0]*dxLimR3)*sFac*xLimUpR2+((203.64675298172588*yLimUp1R3-203.64675298172588*yLimLo1R3)*dyDo+(305.4701294725887*yLimUp1R2-305.4701294725887*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR5+((220.45407685048605*yLimUp[0]*yLimUp1R2-220.45407685048605*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(220.45407685048605*yLimUp[0]*yLimUp[1]-220.45407685048605*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(220.45407685048605*ySh[0]*yLimUp1R2-220.45407685048605*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR4+((84.85281374238575*yLimUp0R2*yLimUp[1]-84.85281374238575*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(42.42640687119286*yLimUp0R2-42.42640687119286*yLimLo0R2)*ySh[1]*dxLimR3+(169.70562748477153*yLimUp[0]*ySh[0]*yLimUp[1]-169.70562748477153*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimLoR3+((12.24744871391589*yLimUp0R3-12.24744871391589*yLimLo0R3)*dxLimR3*dyDo+(36.74234614174767*yLimUp0R2-36.74234614174767*yLimLo0R2)*ySh[0]*dxLimR3)*sFac*xLimLoR2))/(dxLimR3*dyDo))); 
  gkyl_mat_inc(tsmat, 3,3, -((0.003125*((((1440.0*yLimUp1R2-1440.0*yLimLo1R2)*dxLim*sFac*xLimUpR3+(1440.0*yLimLo1R2-1440.0*yLimUp1R2)*dxLim*sFac*xLimLoR3)*xcLimR2+((2160.0*yLimLo1R2-2160.0*yLimUp1R2)*dxLim*sFac*xLimUpR4+(831.384387633061*yLimLo[0]*yLimLo[1]-831.384387633061*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimUpR3+(2160.0*yLimUp1R2-2160.0*yLimLo1R2)*dxLim*sFac*xLimLoR4+(831.384387633061*yLimUp[0]*yLimUp[1]-831.384387633061*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimLoR3)*xcLim+(864.0*yLimUp1R2-864.0*yLimLo1R2)*dxLim*sFac*xLimUpR5+(623.5382907247957*yLimUp[0]*yLimUp[1]-623.5382907247957*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimUpR4+(120.0*yLimUp0R2-120.0*yLimLo0R2)*dxLimR3*sFac*xLimUpR3+(864.0*yLimLo1R2-864.0*yLimUp1R2)*dxLim*sFac*xLimLoR5+(623.5382907247957*yLimLo[0]*yLimLo[1]-623.5382907247957*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimLoR4+(120.0*yLimLo0R2-120.0*yLimUp0R2)*dxLimR3*sFac*xLimLoR3)*yOff+((1175.7550765359267*yLimUp1R3-1175.7550765359267*yLimLo1R3)*dyDo*sFac*xLimUpR3+(1175.7550765359267*yLimLo1R3-1175.7550765359267*yLimUp1R3)*dyDo*sFac*xLimLoR3)*xcLimR3+(((2645.4489222058332*yLimLo1R3-2645.4489222058332*yLimUp1R3)*dyDo+(1322.7244611029166*yLimLo1R2-1322.7244611029166*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR4+((1018.2337649086295*yLimLo[0]*yLimLo1R2-1018.2337649086295*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(1018.2337649086295*ySh[0]*yLimLo1R2-1018.2337649086295*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR3+((2645.4489222058332*yLimUp1R3-2645.4489222058332*yLimLo1R3)*dyDo+(1322.7244611029166*yLimUp1R2-1322.7244611029166*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR4+((1018.2337649086295*yLimUp[0]*yLimUp1R2-1018.2337649086295*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(1018.2337649086295*ySh[0]*yLimUp1R2-1018.2337649086295*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR3)*xcLimR2+(((2116.3591377646676*yLimUp1R3-2116.3591377646676*yLimLo1R3)*dyDo+(2116.3591377646676*yLimUp1R2-2116.3591377646676*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimUpR5+((1527.3506473629436*yLimUp[0]*yLimUp1R2-1527.3506473629436*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(763.6753236814717*yLimUp[0]*yLimUp[1]-763.6753236814717*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(1527.3506473629436*ySh[0]*yLimUp1R2-1527.3506473629436*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimUpR4+((293.9387691339815*yLimUp0R2*yLimUp[1]-293.9387691339815*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(587.8775382679632*yLimUp[0]*ySh[0]*yLimUp[1]-587.8775382679632*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimUpR3+((2116.3591377646676*yLimLo1R3-2116.3591377646676*yLimUp1R3)*dyDo+(2116.3591377646676*yLimLo1R2-2116.3591377646676*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimLoR5+((1527.3506473629436*yLimLo[0]*yLimLo1R2-1527.3506473629436*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(763.6753236814717*yLimLo[0]*yLimLo[1]-763.6753236814717*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(1527.3506473629436*ySh[0]*yLimLo1R2-1527.3506473629436*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimLoR4+((293.9387691339815*yLimLo0R2*yLimLo[1]-293.9387691339815*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(587.8775382679632*yLimLo[0]*ySh[0]*yLimLo[1]-587.8775382679632*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimLoR3)*xcLim+((587.8775382679632*yLimLo1R3-587.8775382679632*yLimUp1R3)*dyDo+(881.8163074019445*yLimLo1R2-881.8163074019445*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR6+((610.9402589451777*yLimLo[0]*yLimLo1R2-610.9402589451777*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(610.9402589451777*yLimLo[0]*yLimLo[1]-610.9402589451777*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(610.9402589451777*ySh[0]*yLimLo1R2-610.9402589451777*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR5+((220.45407685048605*yLimLo0R2*yLimLo[1]-220.45407685048605*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(110.227038425243*yLimLo0R2-110.227038425243*yLimUp0R2)*ySh[1]*dxLimR3+(440.9081537009722*yLimLo[0]*ySh[0]*yLimLo[1]-440.9081537009722*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimUpR4+((28.284271247461916*yLimLo0R3-28.284271247461916*yLimUp0R3)*dxLimR3*dyDo+(84.85281374238575*yLimLo0R2-84.85281374238575*yLimUp0R2)*ySh[0]*dxLimR3)*sFac*xLimUpR3+((587.8775382679632*yLimUp1R3-587.8775382679632*yLimLo1R3)*dyDo+(881.8163074019445*yLimUp1R2-881.8163074019445*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR6+((610.9402589451777*yLimUp[0]*yLimUp1R2-610.9402589451777*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(610.9402589451777*yLimUp[0]*yLimUp[1]-610.9402589451777*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(610.9402589451777*ySh[0]*yLimUp1R2-610.9402589451777*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR5+((220.45407685048605*yLimUp0R2*yLimUp[1]-220.45407685048605*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(110.227038425243*yLimUp0R2-110.227038425243*yLimLo0R2)*ySh[1]*dxLimR3+(440.9081537009722*yLimUp[0]*ySh[0]*yLimUp[1]-440.9081537009722*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimLoR4+((28.284271247461916*yLimUp0R3-28.284271247461916*yLimLo0R3)*dxLimR3*dyDo+(84.85281374238575*yLimUp0R2-84.85281374238575*yLimLo0R2)*ySh[0]*dxLimR3)*sFac*xLimLoR3))/(dxLimR3*dyDo))); 

}

GKYL_CU_DH void twistShift_fullcell_2x_ser_p1yshift_p1(double dyDo, double yOff, const double *ySh, struct gkyl_mat *tsmat) 
{ 
  // dyDo:   y cell length of the donor cell.
  // yOff:   yOffset between the donor and target cells (in the direction of the shift).
  // ySh:    yShift translated to [-1,1] logical space.
  // tsmat: twist-shift matrix.


  gkyl_mat_inc(tsmat, 0,0, 1.0); 
  gkyl_mat_inc(tsmat, 1,1, 1.0); 
  gkyl_mat_inc(tsmat, 2,0, -((1.0*(3.4641016151377544*yOff-2.4494897427831783*ySh[0]))/dyDo)); 
  gkyl_mat_inc(tsmat, 2,1, (2.4494897427831783*ySh[1])/dyDo); 
  gkyl_mat_inc(tsmat, 2,2, 1.0); 
  gkyl_mat_inc(tsmat, 3,0, (2.4494897427831783*ySh[1])/dyDo); 
  gkyl_mat_inc(tsmat, 3,1, -((1.0*(3.4641016151377544*yOff-2.4494897427831783*ySh[0]))/dyDo)); 
  gkyl_mat_inc(tsmat, 3,3, 1.0); 

}

