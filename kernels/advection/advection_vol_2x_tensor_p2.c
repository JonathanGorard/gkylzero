#include <gkyl_advection_kernels.h> 
GKYL_CU_DH double advection_vol_2x_tensor_p2(const double *w, const double *dxv, const double *u, const double *f, double* GKYL_RESTRICT out) 
{ 
  // w[NDIM]:   Cell-center coordinates.
  // dxv[NDIM]: Cell spacing.
  // u[NDIM]:   Advection velocity.
  // f:         Input function.
  // out:       Incremented output.
  const double dx2 = 2.0/dxv[0]; 
  const double dy2 = 2.0/dxv[1]; 
  double alpha_mid = 0.0; 
  alpha_mid += fabs(0.3125*u[8]-0.2795084971874737*(u[5]+u[4])+0.25*u[0])/dxv[0]; 
  alpha_mid += fabs(0.3125*u[17]-0.2795084971874737*(u[14]+u[13])+0.25*u[9])/dxv[1]; 

  out[1] += 0.8660254037844386*(f[8]*u[8]+f[7]*u[7]+f[6]*u[6]+f[5]*u[5]+f[4]*u[4]+f[3]*u[3]+f[2]*u[2]+f[1]*u[1]+f[0]*u[0])*dx2; 
  out[2] += 0.8660254037844386*(f[8]*u[17]+f[7]*u[16]+f[6]*u[15]+f[5]*u[14]+f[4]*u[13]+f[3]*u[12]+f[2]*u[11]+f[1]*u[10]+f[0]*u[9])*dy2; 
  out[3] += (0.7745966692414834*f[7]*u[17]+(0.7745966692414834*f[8]+0.8660254037844387*f[5])*u[16]+0.7745966692414834*f[3]*u[15]+0.8660254037844387*f[7]*u[14]+0.7745966692414833*f[1]*u[13]+0.8660254037844386*(f[2]*u[12]+f[3]*u[11]+f[0]*u[10]+f[1]*u[9])+0.7745966692414834*f[6]*u[12]+0.7745966692414833*f[4]*u[10])*dy2+(0.7745966692414834*(f[6]*u[8]+u[6]*f[8]+f[3]*u[7]+u[3]*f[7])+0.8660254037844387*(f[4]*u[6]+u[4]*f[6])+0.7745966692414833*(f[2]*u[5]+u[2]*f[5])+0.8660254037844386*(f[1]*u[3]+u[1]*f[3]+f[0]*u[2]+u[0]*f[2]))*dx2; 
  out[4] += (1.732050807568877*(f[7]*u[8]+u[7]*f[8])+1.936491673103709*(f[5]*u[7]+u[5]*f[7])+1.732050807568877*(f[3]*u[6]+u[3]*f[6])+1.732050807568877*(f[1]*u[4]+u[1]*f[4])+1.936491673103709*(f[2]*u[3]+u[2]*f[3]+f[0]*u[1]+u[0]*f[1]))*dx2; 
  out[5] += (1.732050807568877*(f[6]*u[17]+f[3]*u[16])+(1.732050807568877*f[8]+1.936491673103709*f[4])*u[15]+1.732050807568877*f[2]*u[14]+1.936491673103709*f[6]*u[13]+(1.732050807568877*f[7]+1.936491673103709*f[1])*u[12]+1.732050807568877*f[5]*u[11]+1.936491673103709*(f[0]*u[11]+f[3]*u[10]+f[2]*u[9]))*dy2; 
  out[6] += ((0.5532833351724881*f[8]+0.8660254037844387*f[5])*u[17]+0.7745966692414834*f[7]*u[16]+(0.5532833351724881*f[6]+0.8660254037844386*f[2])*u[15]+0.8660254037844387*f[8]*u[14]+(0.5532833351724881*f[4]+0.8660254037844387*f[0])*u[13]+0.7745966692414834*f[3]*u[12]+0.8660254037844386*f[6]*u[11]+0.7745966692414834*f[1]*u[10]+0.8660254037844387*f[4]*u[9])*dy2+(1.549193338482967*(f[3]*u[8]+u[3]*f[8]+f[6]*u[7]+u[6]*f[7])+1.732050807568877*(f[2]*u[7]+u[2]*f[7]+f[1]*u[6]+u[1]*f[6])+1.732050807568877*(f[3]*u[5]+u[3]*f[5]+f[3]*u[4]+u[3]*f[4])+1.936491673103709*(f[0]*u[3]+u[0]*f[3]+f[1]*u[2]+u[1]*f[2]))*dx2; 
  out[7] += (1.549193338482967*f[3]*u[17]+(1.549193338482967*f[6]+1.732050807568877*f[2])*u[16]+(1.549193338482967*f[7]+1.732050807568877*f[1])*u[15]+1.732050807568877*f[3]*(u[14]+u[13])+(1.549193338482967*f[8]+1.732050807568877*(f[5]+f[4])+1.936491673103709*f[0])*u[12]+1.732050807568877*(f[7]*u[11]+f[6]*u[10])+1.936491673103709*(f[1]*u[11]+f[2]*u[10]+f[3]*u[9]))*dy2+(0.8660254037844387*(f[4]*u[8]+u[4]*f[8])+0.5532833351724881*f[8]*u[8]+0.8660254037844386*(f[1]*u[7]+u[1]*f[7])+0.5532833351724881*f[7]*u[7]+0.7745966692414834*f[6]*u[6]+0.8660254037844387*(f[0]*u[5]+u[0]*f[5])+0.5532833351724881*f[5]*u[5]+0.7745966692414834*(f[3]*u[3]+f[2]*u[2]))*dx2; 
  out[8] += ((1.106566670344976*f[6]+1.732050807568877*f[2])*u[17]+1.549193338482967*f[3]*u[16]+(1.106566670344976*f[8]+1.732050807568877*f[5]+1.237179148263484*f[4]+1.936491673103709*f[0])*u[15]+1.732050807568877*f[6]*u[14]+(1.237179148263484*f[6]+1.936491673103709*f[2])*u[13]+(1.549193338482967*f[7]+1.732050807568877*f[1])*u[12]+(1.732050807568877*f[8]+1.936491673103709*f[4])*u[11]+1.732050807568877*f[3]*u[10]+1.936491673103709*f[6]*u[9])*dy2+((1.106566670344976*f[7]+1.732050807568877*f[1])*u[8]+(1.106566670344976*u[7]+1.732050807568877*u[1])*f[8]+(1.237179148263484*f[5]+1.732050807568877*f[4]+1.936491673103709*f[0])*u[7]+(1.237179148263484*u[5]+1.732050807568877*u[4]+1.936491673103709*u[0])*f[7]+1.549193338482967*(f[3]*u[6]+u[3]*f[6])+1.936491673103709*(f[1]*u[5]+u[1]*f[5])+1.732050807568877*(f[2]*u[3]+u[2]*f[3]))*dx2; 

  return alpha_mid; 
} 
