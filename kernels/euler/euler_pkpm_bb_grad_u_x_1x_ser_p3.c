#include <gkyl_euler_kernels.h> 
GKYL_CU_DH void euler_pkpm_bb_grad_u_x_1x_ser_p3(const double *dxv, const double *bvar, const double *u_il, const double *u_ic, const double *u_ir, double* GKYL_RESTRICT out) 
{ 
  // dxv[NDIM]:      Cell spacing.
  // bvar:           magnetic field unit vector (nine components; first three components, b_i, other six components, b_i b_j.) 
  // u_il/u_ic/u_ir: flow velocity in left/center/right cells.
  // out:            Increment to volume expansion of bb : grad_u in one direction.

  const double dx1 = 2.0/dxv[0]; 

  const double *ux_l = &u_il[0]; 
  const double *uy_l = &u_il[4]; 
  const double *uz_l = &u_il[8]; 

  const double *ux_c = &u_ic[0]; 
  const double *uy_c = &u_ic[4]; 
  const double *uz_c = &u_ic[8]; 

  const double *ux_r = &u_ir[0]; 
  const double *uy_r = &u_ir[4]; 
  const double *uz_r = &u_ir[8]; 

  const double *bxbx = &bvar[12]; 
  const double *bxby = &bvar[16]; 
  const double *bxbz = &bvar[20]; 
  const double *byby = &bvar[24]; 
  const double *bybz = &bvar[28]; 
  const double *bzbz = &bvar[32]; 

  double grad_u_x[4] = {0.0}; 
  double grad_u_y[4] = {0.0}; 
  double grad_u_z[4] = {0.0}; 
  grad_u_x[0] = (-0.1889822365046136*ux_r[3])-0.1889822365046136*ux_l[3]+0.3779644730092272*ux_c[3]+0.3493856214843422*ux_r[2]-0.3493856214843422*ux_l[2]-0.3788861141556919*ux_r[1]-0.3788861141556919*ux_l[1]+0.7577722283113838*ux_c[1]+0.25*ux_r[0]-0.25*ux_l[0]; 
  grad_u_x[1] = (-0.3273268353539885*ux_r[3])+0.3273268353539885*ux_l[3]+0.605153647844909*ux_r[2]+0.605153647844909*ux_l[2]+1.210307295689818*ux_c[2]-0.65625*ux_r[1]+0.65625*ux_l[1]+0.4330127018922193*ux_r[0]+0.4330127018922193*ux_l[0]-0.8660254037844386*ux_c[0]; 
  grad_u_x[2] = (-0.4225771273642583*ux_r[3])-0.4225771273642583*ux_l[3]+0.8451542547285166*ux_c[3]+0.78125*ux_r[2]-0.78125*ux_l[2]-0.8472151069828725*ux_r[1]-0.8472151069828725*ux_l[1]-2.178553132241671*ux_c[1]+0.5590169943749475*ux_r[0]-0.5590169943749475*ux_l[0]; 
  grad_u_x[3] = (-0.5*ux_r[3])+0.5*ux_l[3]+0.9243874661093152*ux_r[2]+0.9243874661093152*ux_l[2]-4.067304850880986*ux_c[2]-1.00243843327159*ux_r[1]+1.00243843327159*ux_l[1]+0.6614378277661477*ux_r[0]+0.6614378277661477*ux_l[0]-1.322875655532295*ux_c[0]; 

  grad_u_y[0] = (-0.1889822365046136*uy_r[3])-0.1889822365046136*uy_l[3]+0.3779644730092272*uy_c[3]+0.3493856214843422*uy_r[2]-0.3493856214843422*uy_l[2]-0.3788861141556919*uy_r[1]-0.3788861141556919*uy_l[1]+0.7577722283113838*uy_c[1]+0.25*uy_r[0]-0.25*uy_l[0]; 
  grad_u_y[1] = (-0.3273268353539885*uy_r[3])+0.3273268353539885*uy_l[3]+0.605153647844909*uy_r[2]+0.605153647844909*uy_l[2]+1.210307295689818*uy_c[2]-0.65625*uy_r[1]+0.65625*uy_l[1]+0.4330127018922193*uy_r[0]+0.4330127018922193*uy_l[0]-0.8660254037844386*uy_c[0]; 
  grad_u_y[2] = (-0.4225771273642583*uy_r[3])-0.4225771273642583*uy_l[3]+0.8451542547285166*uy_c[3]+0.78125*uy_r[2]-0.78125*uy_l[2]-0.8472151069828725*uy_r[1]-0.8472151069828725*uy_l[1]-2.178553132241671*uy_c[1]+0.5590169943749475*uy_r[0]-0.5590169943749475*uy_l[0]; 
  grad_u_y[3] = (-0.5*uy_r[3])+0.5*uy_l[3]+0.9243874661093152*uy_r[2]+0.9243874661093152*uy_l[2]-4.067304850880986*uy_c[2]-1.00243843327159*uy_r[1]+1.00243843327159*uy_l[1]+0.6614378277661477*uy_r[0]+0.6614378277661477*uy_l[0]-1.322875655532295*uy_c[0]; 

  grad_u_z[0] = (-0.1889822365046136*uz_r[3])-0.1889822365046136*uz_l[3]+0.3779644730092272*uz_c[3]+0.3493856214843422*uz_r[2]-0.3493856214843422*uz_l[2]-0.3788861141556919*uz_r[1]-0.3788861141556919*uz_l[1]+0.7577722283113838*uz_c[1]+0.25*uz_r[0]-0.25*uz_l[0]; 
  grad_u_z[1] = (-0.3273268353539885*uz_r[3])+0.3273268353539885*uz_l[3]+0.605153647844909*uz_r[2]+0.605153647844909*uz_l[2]+1.210307295689818*uz_c[2]-0.65625*uz_r[1]+0.65625*uz_l[1]+0.4330127018922193*uz_r[0]+0.4330127018922193*uz_l[0]-0.8660254037844386*uz_c[0]; 
  grad_u_z[2] = (-0.4225771273642583*uz_r[3])-0.4225771273642583*uz_l[3]+0.8451542547285166*uz_c[3]+0.78125*uz_r[2]-0.78125*uz_l[2]-0.8472151069828725*uz_r[1]-0.8472151069828725*uz_l[1]-2.178553132241671*uz_c[1]+0.5590169943749475*uz_r[0]-0.5590169943749475*uz_l[0]; 
  grad_u_z[3] = (-0.5*uz_r[3])+0.5*uz_l[3]+0.9243874661093152*uz_r[2]+0.9243874661093152*uz_l[2]-4.067304850880986*uz_c[2]-1.00243843327159*uz_r[1]+1.00243843327159*uz_l[1]+0.6614378277661477*uz_r[0]+0.6614378277661477*uz_l[0]-1.322875655532295*uz_c[0]; 

  out[0] += 0.7071067811865475*(bxbz[3]*grad_u_z[3]+bxby[3]*grad_u_y[3]+bxbx[3]*grad_u_x[3]+bxbz[2]*grad_u_z[2]+bxby[2]*grad_u_y[2]+bxbx[2]*grad_u_x[2]+bxbz[1]*grad_u_z[1]+bxby[1]*grad_u_y[1]+bxbx[1]*grad_u_x[1]+bxbz[0]*grad_u_z[0]+bxby[0]*grad_u_y[0]+bxbx[0]*grad_u_x[0])*dx1; 
  out[1] += (0.6210590034081186*(bxbz[2]*grad_u_z[3]+bxby[2]*grad_u_y[3]+bxbx[2]*grad_u_x[3]+grad_u_z[2]*bxbz[3]+grad_u_y[2]*bxby[3]+grad_u_x[2]*bxbx[3])+0.6324555320336759*(bxbz[1]*grad_u_z[2]+bxby[1]*grad_u_y[2]+bxbx[1]*grad_u_x[2]+grad_u_z[1]*bxbz[2]+grad_u_y[1]*bxby[2]+grad_u_x[1]*bxbx[2])+0.7071067811865475*(bxbz[0]*grad_u_z[1]+bxby[0]*grad_u_y[1]+bxbx[0]*grad_u_x[1]+grad_u_z[0]*bxbz[1]+grad_u_y[0]*bxby[1]+grad_u_x[0]*bxbx[1]))*dx1; 
  out[2] += ((0.421637021355784*bxbz[3]+0.6210590034081186*bxbz[1])*grad_u_z[3]+(0.421637021355784*bxby[3]+0.6210590034081186*bxby[1])*grad_u_y[3]+0.421637021355784*bxbx[3]*grad_u_x[3]+0.6210590034081186*(bxbx[1]*grad_u_x[3]+grad_u_z[1]*bxbz[3]+grad_u_y[1]*bxby[3]+grad_u_x[1]*bxbx[3])+(0.4517539514526256*bxbz[2]+0.7071067811865475*bxbz[0])*grad_u_z[2]+(0.4517539514526256*bxby[2]+0.7071067811865475*bxby[0])*grad_u_y[2]+0.4517539514526256*bxbx[2]*grad_u_x[2]+0.7071067811865475*(bxbx[0]*grad_u_x[2]+grad_u_z[0]*bxbz[2]+grad_u_y[0]*bxby[2]+grad_u_x[0]*bxbx[2])+0.6324555320336759*(bxbz[1]*grad_u_z[1]+bxby[1]*grad_u_y[1]+bxbx[1]*grad_u_x[1]))*dx1; 
  out[3] += ((0.421637021355784*bxbz[2]+0.7071067811865475*bxbz[0])*grad_u_z[3]+(0.421637021355784*bxby[2]+0.7071067811865475*bxby[0])*grad_u_y[3]+(0.421637021355784*bxbx[2]+0.7071067811865475*bxbx[0])*grad_u_x[3]+(0.421637021355784*grad_u_z[2]+0.7071067811865475*grad_u_z[0])*bxbz[3]+(0.421637021355784*grad_u_y[2]+0.7071067811865475*grad_u_y[0])*bxby[3]+(0.421637021355784*grad_u_x[2]+0.7071067811865475*grad_u_x[0])*bxbx[3]+0.6210590034081186*(bxbz[1]*grad_u_z[2]+bxby[1]*grad_u_y[2]+bxbx[1]*grad_u_x[2]+grad_u_z[1]*bxbz[2]+grad_u_y[1]*bxby[2]+grad_u_x[1]*bxbx[2]))*dx1; 
} 
