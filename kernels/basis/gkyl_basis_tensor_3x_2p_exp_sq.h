GKYL_CU_DH static inline void 
tensor_3x_2p_exp_sq(const double *A, double *ASq) 
{ 
  // A:   Input DG field. 
  // ASq: Output DG field (expansion of A^2). 
 
  const double A0R2 = pow(A[0],2);
  const double A1R2 = pow(A[1],2);
  const double A2R2 = pow(A[2],2);
  const double A3R2 = pow(A[3],2);
  const double A4R2 = pow(A[4],2);
  const double A5R2 = pow(A[5],2);
  const double A6R2 = pow(A[6],2);
  const double A7R2 = pow(A[7],2);

  ASq[0] = 0.3535533905932737*A7R2+0.3535533905932737*A6R2+0.3535533905932737*A5R2+0.3535533905932737*A4R2+0.3535533905932737*A3R2+0.3535533905932737*A2R2+0.3535533905932737*A1R2+0.3535533905932737*A0R2; 
  ASq[1] = 0.7071067811865475*A[6]*A[7]+0.7071067811865475*A[3]*A[5]+0.7071067811865475*A[2]*A[4]+0.7071067811865475*A[0]*A[1]; 
  ASq[2] = 0.7071067811865475*A[5]*A[7]+0.7071067811865475*A[3]*A[6]+0.7071067811865475*A[1]*A[4]+0.7071067811865475*A[0]*A[2]; 
  ASq[3] = 0.7071067811865475*A[4]*A[7]+0.7071067811865475*A[2]*A[6]+0.7071067811865475*A[1]*A[5]+0.7071067811865475*A[0]*A[3]; 
  ASq[4] = 0.7071067811865475*A[3]*A[7]+0.7071067811865475*A[5]*A[6]+0.7071067811865475*A[0]*A[4]+0.7071067811865475*A[1]*A[2]; 
  ASq[5] = 0.7071067811865475*A[2]*A[7]+0.7071067811865475*A[4]*A[6]+0.7071067811865475*A[0]*A[5]+0.7071067811865475*A[1]*A[3]; 
  ASq[6] = 0.7071067811865475*A[1]*A[7]+0.7071067811865475*A[0]*A[6]+0.7071067811865475*A[4]*A[5]+0.7071067811865475*A[2]*A[3]; 
  ASq[7] = 0.3162277660168379*A7R2+0.3162277660168379*A5R2+0.3162277660168379*A4R2+0.3162277660168379*A1R2; 
  ASq[8] = 0.3162277660168379*A7R2+0.3162277660168379*A6R2+0.3162277660168379*A4R2+0.3162277660168379*A2R2; 
  ASq[9] = 0.3162277660168379*A7R2+0.3162277660168379*A6R2+0.3162277660168379*A5R2+0.3162277660168379*A3R2; 
  ASq[10] = 0.7071067811865475*A[0]*A[7]+0.7071067811865475*A[1]*A[6]+0.7071067811865475*A[2]*A[5]+0.7071067811865475*A[3]*A[4]; 
  ASq[11] = 0.632455532033676*A[5]*A[7]+0.632455532033676*A[1]*A[4]; 
  ASq[12] = 0.632455532033676*A[6]*A[7]+0.632455532033676*A[2]*A[4]; 
  ASq[13] = 0.632455532033676*A[4]*A[7]+0.632455532033676*A[1]*A[5]; 
  ASq[14] = 0.632455532033676*A[4]*A[7]+0.632455532033676*A[2]*A[6]; 
  ASq[15] = 0.632455532033676*A[6]*A[7]+0.632455532033676*A[3]*A[5]; 
  ASq[16] = 0.632455532033676*A[5]*A[7]+0.632455532033676*A[3]*A[6]; 
  ASq[17] = 0.6324555320336759*A[1]*A[7]+0.6324555320336759*A[4]*A[5]; 
  ASq[18] = 0.6324555320336759*A[2]*A[7]+0.6324555320336759*A[4]*A[6]; 
  ASq[19] = 0.6324555320336759*A[3]*A[7]+0.6324555320336759*A[5]*A[6]; 
  ASq[20] = 0.2828427124746191*A7R2+0.2828427124746191*A4R2; 
  ASq[21] = 0.2828427124746191*A7R2+0.2828427124746191*A5R2; 
  ASq[22] = 0.2828427124746191*A7R2+0.2828427124746191*A6R2; 
  ASq[23] = 0.5656854249492381*A[4]*A[7]; 
  ASq[24] = 0.5656854249492381*A[5]*A[7]; 
  ASq[25] = 0.5656854249492381*A[6]*A[7]; 
  ASq[26] = 0.2529822128134704*A7R2; 
} 
 
