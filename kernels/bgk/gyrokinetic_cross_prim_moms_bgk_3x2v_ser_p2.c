#include <gkyl_gyrokinetic_cross_prim_moms_bgk_kernels.h> 
#include <gkyl_binop_mul_ser.h> 
#include <gkyl_basis_ser_3x_p2_inv.h> 
 
GKYL_CU_DH void gyrokinetic_cross_prim_moms_bgk_3x2v_ser_p2(const double beta, const double m_self, const double *prim_moms_self, const double m_other, const double *prim_moms_other, const double *nu_sr, const double *nu_rs, double *prim_moms_cross) 
{ 
  // m_:              mass. 
  // prim_moms_:      primitive moments of the distribution function. 
  // prim_moms_cross: cross primitive moments. 
 
  const double m_s = m_self; 
  const double m_r = m_other; 
  const double *n_s = &prim_moms_self[0]; 
  const double *upar_s = &prim_moms_self[20]; 
  const double *vtsq_s = &prim_moms_self[40]; 
  const double *n_r = &prim_moms_other[0]; 
  const double *upar_r = &prim_moms_other[20]; 
  const double *vtsq_r = &prim_moms_other[40]; 
 
  double *n_sr = &prim_moms_cross[0]; 
  double *upar_sr = &prim_moms_cross[20]; 
  double *vtsq_sr = &prim_moms_cross[40]; 
 
  double msNsNusr[20] = {0.0}; 
  double mrNrNurs[20] = {0.0}; 
  double m_n_nu[20] = {0.0}; 
  double m_n_nu_inv[20] = {0.0}; 
  double alphaE[20] = {0.0}; 

  double msNsNusr_inv[20] = {0.0}; 
  double coeff[20] = {0.0}; 
  double dUpar[20] = {0.0}; 
  double cUpar[20] = {0.0}; 

  double dv; 
  double T1[20] = {0.0}; 
  double T2[20] = {0.0}; 
  double T3[20] = {0.0}; 
  double cVtsq[20] = {0.0}; 

  binop_mul_3d_ser_p2(n_s, nu_sr, msNsNusr); 
  binop_mul_3d_ser_p2(n_r, nu_rs, mrNrNurs); 
  msNsNusr[0] = m_s * msNsNusr[0]; 
  mrNrNurs[0] = m_r * mrNrNurs[0]; 
  m_n_nu[0] = msNsNusr[0] + mrNrNurs[0]; 
  msNsNusr[1] = m_s * msNsNusr[1]; 
  mrNrNurs[1] = m_r * mrNrNurs[1]; 
  m_n_nu[1] = msNsNusr[1] + mrNrNurs[1]; 
  msNsNusr[2] = m_s * msNsNusr[2]; 
  mrNrNurs[2] = m_r * mrNrNurs[2]; 
  m_n_nu[2] = msNsNusr[2] + mrNrNurs[2]; 
  msNsNusr[3] = m_s * msNsNusr[3]; 
  mrNrNurs[3] = m_r * mrNrNurs[3]; 
  m_n_nu[3] = msNsNusr[3] + mrNrNurs[3]; 
  msNsNusr[4] = m_s * msNsNusr[4]; 
  mrNrNurs[4] = m_r * mrNrNurs[4]; 
  m_n_nu[4] = msNsNusr[4] + mrNrNurs[4]; 
  msNsNusr[5] = m_s * msNsNusr[5]; 
  mrNrNurs[5] = m_r * mrNrNurs[5]; 
  m_n_nu[5] = msNsNusr[5] + mrNrNurs[5]; 
  msNsNusr[6] = m_s * msNsNusr[6]; 
  mrNrNurs[6] = m_r * mrNrNurs[6]; 
  m_n_nu[6] = msNsNusr[6] + mrNrNurs[6]; 
  msNsNusr[7] = m_s * msNsNusr[7]; 
  mrNrNurs[7] = m_r * mrNrNurs[7]; 
  m_n_nu[7] = msNsNusr[7] + mrNrNurs[7]; 
  msNsNusr[8] = m_s * msNsNusr[8]; 
  mrNrNurs[8] = m_r * mrNrNurs[8]; 
  m_n_nu[8] = msNsNusr[8] + mrNrNurs[8]; 
  msNsNusr[9] = m_s * msNsNusr[9]; 
  mrNrNurs[9] = m_r * mrNrNurs[9]; 
  m_n_nu[9] = msNsNusr[9] + mrNrNurs[9]; 
  msNsNusr[10] = m_s * msNsNusr[10]; 
  mrNrNurs[10] = m_r * mrNrNurs[10]; 
  m_n_nu[10] = msNsNusr[10] + mrNrNurs[10]; 
  msNsNusr[11] = m_s * msNsNusr[11]; 
  mrNrNurs[11] = m_r * mrNrNurs[11]; 
  m_n_nu[11] = msNsNusr[11] + mrNrNurs[11]; 
  msNsNusr[12] = m_s * msNsNusr[12]; 
  mrNrNurs[12] = m_r * mrNrNurs[12]; 
  m_n_nu[12] = msNsNusr[12] + mrNrNurs[12]; 
  msNsNusr[13] = m_s * msNsNusr[13]; 
  mrNrNurs[13] = m_r * mrNrNurs[13]; 
  m_n_nu[13] = msNsNusr[13] + mrNrNurs[13]; 
  msNsNusr[14] = m_s * msNsNusr[14]; 
  mrNrNurs[14] = m_r * mrNrNurs[14]; 
  m_n_nu[14] = msNsNusr[14] + mrNrNurs[14]; 
  msNsNusr[15] = m_s * msNsNusr[15]; 
  mrNrNurs[15] = m_r * mrNrNurs[15]; 
  m_n_nu[15] = msNsNusr[15] + mrNrNurs[15]; 
  msNsNusr[16] = m_s * msNsNusr[16]; 
  mrNrNurs[16] = m_r * mrNrNurs[16]; 
  m_n_nu[16] = msNsNusr[16] + mrNrNurs[16]; 
  msNsNusr[17] = m_s * msNsNusr[17]; 
  mrNrNurs[17] = m_r * mrNrNurs[17]; 
  m_n_nu[17] = msNsNusr[17] + mrNrNurs[17]; 
  msNsNusr[18] = m_s * msNsNusr[18]; 
  mrNrNurs[18] = m_r * mrNrNurs[18]; 
  m_n_nu[18] = msNsNusr[18] + mrNrNurs[18]; 
  msNsNusr[19] = m_s * msNsNusr[19]; 
  mrNrNurs[19] = m_r * mrNrNurs[19]; 
  m_n_nu[19] = msNsNusr[19] + mrNrNurs[19]; 
  ser_3x_p2_inv(m_n_nu, m_n_nu_inv); 
  binop_mul_3d_ser_p2(msNsNusr, mrNrNurs, alphaE); 
  binop_mul_3d_ser_p2(alphaE, m_n_nu_inv, alphaE); 
  alphaE[0] = alphaE[0] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[1] = alphaE[1] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[2] = alphaE[2] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[3] = alphaE[3] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[4] = alphaE[4] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[5] = alphaE[5] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[6] = alphaE[6] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[7] = alphaE[7] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[8] = alphaE[8] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[9] = alphaE[9] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[10] = alphaE[10] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[11] = alphaE[11] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[12] = alphaE[12] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[13] = alphaE[13] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[14] = alphaE[14] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[15] = alphaE[15] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[16] = alphaE[16] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[17] = alphaE[17] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[18] = alphaE[18] * 2 * (1+beta) / (m_s+m_r); 
  alphaE[19] = alphaE[19] * 2 * (1+beta) / (m_s+m_r); 

  n_sr[0] = n_s[0]; 
  n_sr[1] = n_s[1]; 
  n_sr[2] = n_s[2]; 
  n_sr[3] = n_s[3]; 
  n_sr[4] = n_s[4]; 
  n_sr[5] = n_s[5]; 
  n_sr[6] = n_s[6]; 
  n_sr[7] = n_s[7]; 
  n_sr[8] = n_s[8]; 
  n_sr[9] = n_s[9]; 
  n_sr[10] = n_s[10]; 
  n_sr[11] = n_s[11]; 
  n_sr[12] = n_s[12]; 
  n_sr[13] = n_s[13]; 
  n_sr[14] = n_s[14]; 
  n_sr[15] = n_s[15]; 
  n_sr[16] = n_s[16]; 
  n_sr[17] = n_s[17]; 
  n_sr[18] = n_s[18]; 
  n_sr[19] = n_s[19]; 
 
  ser_3x_p2_inv(msNsNusr, msNsNusr_inv); 
  binop_mul_3d_ser_p2(alphaE, msNsNusr_inv, coeff); 
  dUpar[0] = upar_r[0] - upar_s[0]; 
  dUpar[1] = upar_r[1] - upar_s[1]; 
  dUpar[2] = upar_r[2] - upar_s[2]; 
  dUpar[3] = upar_r[3] - upar_s[3]; 
  dUpar[4] = upar_r[4] - upar_s[4]; 
  dUpar[5] = upar_r[5] - upar_s[5]; 
  dUpar[6] = upar_r[6] - upar_s[6]; 
  dUpar[7] = upar_r[7] - upar_s[7]; 
  dUpar[8] = upar_r[8] - upar_s[8]; 
  dUpar[9] = upar_r[9] - upar_s[9]; 
  dUpar[10] = upar_r[10] - upar_s[10]; 
  dUpar[11] = upar_r[11] - upar_s[11]; 
  dUpar[12] = upar_r[12] - upar_s[12]; 
  dUpar[13] = upar_r[13] - upar_s[13]; 
  dUpar[14] = upar_r[14] - upar_s[14]; 
  dUpar[15] = upar_r[15] - upar_s[15]; 
  dUpar[16] = upar_r[16] - upar_s[16]; 
  dUpar[17] = upar_r[17] - upar_s[17]; 
  dUpar[18] = upar_r[18] - upar_s[18]; 
  dUpar[19] = upar_r[19] - upar_s[19]; 
  binop_mul_3d_ser_p2(coeff, dUpar, cUpar); 
  upar_sr[0] = upar_s[0] + cUpar[0]*(m_s+m_r)/2; 
  upar_sr[1] = upar_s[1] + cUpar[1]*(m_s+m_r)/2; 
  upar_sr[2] = upar_s[2] + cUpar[2]*(m_s+m_r)/2; 
  upar_sr[3] = upar_s[3] + cUpar[3]*(m_s+m_r)/2; 
  upar_sr[4] = upar_s[4] + cUpar[4]*(m_s+m_r)/2; 
  upar_sr[5] = upar_s[5] + cUpar[5]*(m_s+m_r)/2; 
  upar_sr[6] = upar_s[6] + cUpar[6]*(m_s+m_r)/2; 
  upar_sr[7] = upar_s[7] + cUpar[7]*(m_s+m_r)/2; 
  upar_sr[8] = upar_s[8] + cUpar[8]*(m_s+m_r)/2; 
  upar_sr[9] = upar_s[9] + cUpar[9]*(m_s+m_r)/2; 
  upar_sr[10] = upar_s[10] + cUpar[10]*(m_s+m_r)/2; 
  upar_sr[11] = upar_s[11] + cUpar[11]*(m_s+m_r)/2; 
  upar_sr[12] = upar_s[12] + cUpar[12]*(m_s+m_r)/2; 
  upar_sr[13] = upar_s[13] + cUpar[13]*(m_s+m_r)/2; 
  upar_sr[14] = upar_s[14] + cUpar[14]*(m_s+m_r)/2; 
  upar_sr[15] = upar_s[15] + cUpar[15]*(m_s+m_r)/2; 
  upar_sr[16] = upar_s[16] + cUpar[16]*(m_s+m_r)/2; 
  upar_sr[17] = upar_s[17] + cUpar[17]*(m_s+m_r)/2; 
  upar_sr[18] = upar_s[18] + cUpar[18]*(m_s+m_r)/2; 
  upar_sr[19] = upar_s[19] + cUpar[19]*(m_s+m_r)/2; 
 
  dv = 3.0; 
  T1[0] = dv * (m_r*vtsq_r[0]-m_s*vtsq_s[0]); 
  T1[1] = dv * (m_r*vtsq_r[1]-m_s*vtsq_s[1]); 
  T1[2] = dv * (m_r*vtsq_r[2]-m_s*vtsq_s[2]); 
  T1[3] = dv * (m_r*vtsq_r[3]-m_s*vtsq_s[3]); 
  T1[4] = dv * (m_r*vtsq_r[4]-m_s*vtsq_s[4]); 
  T1[5] = dv * (m_r*vtsq_r[5]-m_s*vtsq_s[5]); 
  T1[6] = dv * (m_r*vtsq_r[6]-m_s*vtsq_s[6]); 
  T1[7] = dv * (m_r*vtsq_r[7]-m_s*vtsq_s[7]); 
  T1[8] = dv * (m_r*vtsq_r[8]-m_s*vtsq_s[8]); 
  T1[9] = dv * (m_r*vtsq_r[9]-m_s*vtsq_s[9]); 
  T1[10] = dv * (m_r*vtsq_r[10]-m_s*vtsq_s[10]); 
  T1[11] = dv * (m_r*vtsq_r[11]-m_s*vtsq_s[11]); 
  T1[12] = dv * (m_r*vtsq_r[12]-m_s*vtsq_s[12]); 
  T1[13] = dv * (m_r*vtsq_r[13]-m_s*vtsq_s[13]); 
  T1[14] = dv * (m_r*vtsq_r[14]-m_s*vtsq_s[14]); 
  T1[15] = dv * (m_r*vtsq_r[15]-m_s*vtsq_s[15]); 
  T1[16] = dv * (m_r*vtsq_r[16]-m_s*vtsq_s[16]); 
  T1[17] = dv * (m_r*vtsq_r[17]-m_s*vtsq_s[17]); 
  T1[18] = dv * (m_r*vtsq_r[18]-m_s*vtsq_s[18]); 
  T1[19] = dv * (m_r*vtsq_r[19]-m_s*vtsq_s[19]); 
  binop_mul_3d_ser_p2(dUpar, dUpar, T2); 
  binop_mul_3d_ser_p2(coeff, T2, T3); 
  cVtsq[0] = T1[0] + m_r*T2[0] - (m_s+m_r)*(m_s+m_r)/4*T3[0] ; 
  cVtsq[1] = T1[1] + m_r*T2[1] - (m_s+m_r)*(m_s+m_r)/4*T3[1] ; 
  cVtsq[2] = T1[2] + m_r*T2[2] - (m_s+m_r)*(m_s+m_r)/4*T3[2] ; 
  cVtsq[3] = T1[3] + m_r*T2[3] - (m_s+m_r)*(m_s+m_r)/4*T3[3] ; 
  cVtsq[4] = T1[4] + m_r*T2[4] - (m_s+m_r)*(m_s+m_r)/4*T3[4] ; 
  cVtsq[5] = T1[5] + m_r*T2[5] - (m_s+m_r)*(m_s+m_r)/4*T3[5] ; 
  cVtsq[6] = T1[6] + m_r*T2[6] - (m_s+m_r)*(m_s+m_r)/4*T3[6] ; 
  cVtsq[7] = T1[7] + m_r*T2[7] - (m_s+m_r)*(m_s+m_r)/4*T3[7] ; 
  cVtsq[8] = T1[8] + m_r*T2[8] - (m_s+m_r)*(m_s+m_r)/4*T3[8] ; 
  cVtsq[9] = T1[9] + m_r*T2[9] - (m_s+m_r)*(m_s+m_r)/4*T3[9] ; 
  cVtsq[10] = T1[10] + m_r*T2[10] - (m_s+m_r)*(m_s+m_r)/4*T3[10] ; 
  cVtsq[11] = T1[11] + m_r*T2[11] - (m_s+m_r)*(m_s+m_r)/4*T3[11] ; 
  cVtsq[12] = T1[12] + m_r*T2[12] - (m_s+m_r)*(m_s+m_r)/4*T3[12] ; 
  cVtsq[13] = T1[13] + m_r*T2[13] - (m_s+m_r)*(m_s+m_r)/4*T3[13] ; 
  cVtsq[14] = T1[14] + m_r*T2[14] - (m_s+m_r)*(m_s+m_r)/4*T3[14] ; 
  cVtsq[15] = T1[15] + m_r*T2[15] - (m_s+m_r)*(m_s+m_r)/4*T3[15] ; 
  cVtsq[16] = T1[16] + m_r*T2[16] - (m_s+m_r)*(m_s+m_r)/4*T3[16] ; 
  cVtsq[17] = T1[17] + m_r*T2[17] - (m_s+m_r)*(m_s+m_r)/4*T3[17] ; 
  cVtsq[18] = T1[18] + m_r*T2[18] - (m_s+m_r)*(m_s+m_r)/4*T3[18] ; 
  cVtsq[19] = T1[19] + m_r*T2[19] - (m_s+m_r)*(m_s+m_r)/4*T3[19] ; 
  binop_mul_3d_ser_p2(coeff, cVtsq, cVtsq); 
  vtsq_sr[0] = vtsq_s[0] + cVtsq[0]/dv; 
  vtsq_sr[1] = vtsq_s[1] + cVtsq[1]/dv; 
  vtsq_sr[2] = vtsq_s[2] + cVtsq[2]/dv; 
  vtsq_sr[3] = vtsq_s[3] + cVtsq[3]/dv; 
  vtsq_sr[4] = vtsq_s[4] + cVtsq[4]/dv; 
  vtsq_sr[5] = vtsq_s[5] + cVtsq[5]/dv; 
  vtsq_sr[6] = vtsq_s[6] + cVtsq[6]/dv; 
  vtsq_sr[7] = vtsq_s[7] + cVtsq[7]/dv; 
  vtsq_sr[8] = vtsq_s[8] + cVtsq[8]/dv; 
  vtsq_sr[9] = vtsq_s[9] + cVtsq[9]/dv; 
  vtsq_sr[10] = vtsq_s[10] + cVtsq[10]/dv; 
  vtsq_sr[11] = vtsq_s[11] + cVtsq[11]/dv; 
  vtsq_sr[12] = vtsq_s[12] + cVtsq[12]/dv; 
  vtsq_sr[13] = vtsq_s[13] + cVtsq[13]/dv; 
  vtsq_sr[14] = vtsq_s[14] + cVtsq[14]/dv; 
  vtsq_sr[15] = vtsq_s[15] + cVtsq[15]/dv; 
  vtsq_sr[16] = vtsq_s[16] + cVtsq[16]/dv; 
  vtsq_sr[17] = vtsq_s[17] + cVtsq[17]/dv; 
  vtsq_sr[18] = vtsq_s[18] + cVtsq[18]/dv; 
  vtsq_sr[19] = vtsq_s[19] + cVtsq[19]/dv; 
} 
 
