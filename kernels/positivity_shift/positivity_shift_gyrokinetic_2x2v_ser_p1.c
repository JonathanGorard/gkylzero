#include <gkyl_positivity_shift_gyrokinetic_kernels.h> 

GKYL_CU_DH bool positivity_shift_gyrokinetic_2x2v_ser_p1(double ffloor, double *distf, double *Deltaf) 
{ 
  // ffloor: Distribution function floor to shift to when f<0.
  // distf: distribution function.
  // Deltaf: Change in the distribution function.

  bool shifted = false;

  Deltaf[0] = -1.0*distf[0]; 
  Deltaf[1] = -1.0*distf[1]; 
  Deltaf[2] = -1.0*distf[2]; 
  Deltaf[3] = -1.0*distf[3]; 
  Deltaf[4] = -1.0*distf[4]; 
  Deltaf[5] = -1.0*distf[5]; 
  Deltaf[6] = -1.0*distf[6]; 
  Deltaf[7] = -1.0*distf[7]; 
  Deltaf[8] = -1.0*distf[8]; 
  Deltaf[9] = -1.0*distf[9]; 
  Deltaf[10] = -1.0*distf[10]; 
  Deltaf[11] = -1.0*distf[11]; 
  Deltaf[12] = -1.0*distf[12]; 
  Deltaf[13] = -1.0*distf[13]; 
  Deltaf[14] = -1.0*distf[14]; 
  Deltaf[15] = -1.0*distf[15]; 
  Deltaf[16] = -1.0*distf[16]; 
  Deltaf[17] = -1.0*distf[17]; 
  Deltaf[18] = -1.0*distf[18]; 
  Deltaf[19] = -1.0*distf[19]; 
  Deltaf[20] = -1.0*distf[20]; 
  Deltaf[21] = -1.0*distf[21]; 
  Deltaf[22] = -1.0*distf[22]; 
  Deltaf[23] = -1.0*distf[23]; 

  double fnod[24];
  fnod[0] = 0.03586095690932793*distf[23]-0.06211299937499416*distf[22]-0.06211299937499416*distf[21]-0.06211299937499416*distf[20]+0.1075828707279838*distf[19]+0.1075828707279838*distf[18]+0.1075828707279838*distf[17]-0.1863389981249825*distf[16]+0.02777777777777778*distf[15]-0.04811252243246882*distf[14]-0.04811252243246882*distf[13]-0.04811252243246882*distf[12]-0.04811252243246882*distf[11]+0.08333333333333333*distf[10]+0.08333333333333333*distf[9]+0.08333333333333333*distf[8]+0.08333333333333333*distf[7]+0.08333333333333333*distf[6]+0.08333333333333333*distf[5]-0.1443375672974065*distf[4]-0.1443375672974065*distf[3]-0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[1] = (-0.03586095690932793*distf[23])+0.06211299937499416*distf[22]+0.06211299937499416*distf[21]-0.06211299937499416*distf[20]-0.1075828707279838*distf[19]+0.1075828707279838*distf[18]+0.1075828707279838*distf[17]-0.1863389981249825*distf[16]-0.02777777777777778*distf[15]+0.04811252243246882*distf[14]+0.04811252243246882*distf[13]+0.04811252243246882*distf[12]-0.04811252243246882*distf[11]-0.08333333333333333*distf[10]-0.08333333333333333*distf[9]-0.08333333333333333*distf[8]+0.08333333333333333*distf[7]+0.08333333333333333*distf[6]+0.08333333333333333*distf[5]+0.1443375672974065*distf[4]-0.1443375672974065*distf[3]-0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[2] = 0.0537914353639919*distf[23]-0.09316949906249124*distf[22]-0.09316949906249124*distf[21]-0.09316949906249124*distf[20]+0.1613743060919757*distf[19]+0.1613743060919757*distf[18]+0.1613743060919757*distf[17]-0.2795084971874737*distf[16]-0.04811252243246882*distf[12]+0.08333333333333333*distf[9]+0.08333333333333333*distf[8]+0.08333333333333333*distf[5]-0.1443375672974065*distf[4]-0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[3] = (-0.0537914353639919*distf[23])+0.09316949906249124*distf[22]+0.09316949906249124*distf[21]-0.09316949906249124*distf[20]-0.1613743060919757*distf[19]+0.1613743060919757*distf[18]+0.1613743060919757*distf[17]-0.2795084971874737*distf[16]+0.04811252243246882*distf[12]-0.08333333333333333*distf[9]-0.08333333333333333*distf[8]+0.08333333333333333*distf[5]+0.1443375672974065*distf[4]-0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[4] = 0.03586095690932793*distf[23]-0.06211299937499416*distf[22]-0.06211299937499416*distf[21]-0.06211299937499416*distf[20]+0.1075828707279838*distf[19]+0.1075828707279838*distf[18]+0.1075828707279838*distf[17]-0.1863389981249825*distf[16]-0.02777777777777778*distf[15]+0.04811252243246882*distf[14]+0.04811252243246882*distf[13]-0.04811252243246882*distf[12]+0.04811252243246882*distf[11]-0.08333333333333333*distf[10]+0.08333333333333333*distf[9]+0.08333333333333333*distf[8]-0.08333333333333333*distf[7]-0.08333333333333333*distf[6]+0.08333333333333333*distf[5]-0.1443375672974065*distf[4]+0.1443375672974065*distf[3]-0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[5] = (-0.03586095690932793*distf[23])+0.06211299937499416*distf[22]+0.06211299937499416*distf[21]-0.06211299937499416*distf[20]-0.1075828707279838*distf[19]+0.1075828707279838*distf[18]+0.1075828707279838*distf[17]-0.1863389981249825*distf[16]+0.02777777777777778*distf[15]-0.04811252243246882*distf[14]-0.04811252243246882*distf[13]+0.04811252243246882*distf[12]+0.04811252243246882*distf[11]+0.08333333333333333*distf[10]-0.08333333333333333*distf[9]-0.08333333333333333*distf[8]-0.08333333333333333*distf[7]-0.08333333333333333*distf[6]+0.08333333333333333*distf[5]+0.1443375672974065*distf[4]+0.1443375672974065*distf[3]-0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[6] = (-0.03586095690932793*distf[23])+0.06211299937499416*distf[22]-0.06211299937499416*distf[21]+0.06211299937499416*distf[20]+0.1075828707279838*distf[19]-0.1075828707279838*distf[18]+0.1075828707279838*distf[17]-0.1863389981249825*distf[16]-0.02777777777777778*distf[15]+0.04811252243246882*distf[14]-0.04811252243246882*distf[13]+0.04811252243246882*distf[12]+0.04811252243246882*distf[11]+0.08333333333333333*distf[10]-0.08333333333333333*distf[9]+0.08333333333333333*distf[8]-0.08333333333333333*distf[7]+0.08333333333333333*distf[6]-0.08333333333333333*distf[5]-0.1443375672974065*distf[4]-0.1443375672974065*distf[3]+0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[7] = 0.03586095690932793*distf[23]-0.06211299937499416*distf[22]+0.06211299937499416*distf[21]+0.06211299937499416*distf[20]-0.1075828707279838*distf[19]-0.1075828707279838*distf[18]+0.1075828707279838*distf[17]-0.1863389981249825*distf[16]+0.02777777777777778*distf[15]-0.04811252243246882*distf[14]+0.04811252243246882*distf[13]-0.04811252243246882*distf[12]+0.04811252243246882*distf[11]-0.08333333333333333*distf[10]+0.08333333333333333*distf[9]-0.08333333333333333*distf[8]-0.08333333333333333*distf[7]+0.08333333333333333*distf[6]-0.08333333333333333*distf[5]+0.1443375672974065*distf[4]-0.1443375672974065*distf[3]+0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[8] = (-0.0537914353639919*distf[23])+0.09316949906249124*distf[22]-0.09316949906249124*distf[21]+0.09316949906249124*distf[20]+0.1613743060919757*distf[19]-0.1613743060919757*distf[18]+0.1613743060919757*distf[17]-0.2795084971874737*distf[16]+0.04811252243246882*distf[12]-0.08333333333333333*distf[9]+0.08333333333333333*distf[8]-0.08333333333333333*distf[5]-0.1443375672974065*distf[4]+0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[9] = 0.0537914353639919*distf[23]-0.09316949906249124*distf[22]+0.09316949906249124*distf[21]+0.09316949906249124*distf[20]-0.1613743060919757*distf[19]-0.1613743060919757*distf[18]+0.1613743060919757*distf[17]-0.2795084971874737*distf[16]-0.04811252243246882*distf[12]+0.08333333333333333*distf[9]-0.08333333333333333*distf[8]-0.08333333333333333*distf[5]+0.1443375672974065*distf[4]+0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[10] = (-0.03586095690932793*distf[23])+0.06211299937499416*distf[22]-0.06211299937499416*distf[21]+0.06211299937499416*distf[20]+0.1075828707279838*distf[19]-0.1075828707279838*distf[18]+0.1075828707279838*distf[17]-0.1863389981249825*distf[16]+0.02777777777777778*distf[15]-0.04811252243246882*distf[14]+0.04811252243246882*distf[13]+0.04811252243246882*distf[12]-0.04811252243246882*distf[11]-0.08333333333333333*distf[10]-0.08333333333333333*distf[9]+0.08333333333333333*distf[8]+0.08333333333333333*distf[7]-0.08333333333333333*distf[6]-0.08333333333333333*distf[5]-0.1443375672974065*distf[4]+0.1443375672974065*distf[3]+0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[11] = 0.03586095690932793*distf[23]-0.06211299937499416*distf[22]+0.06211299937499416*distf[21]+0.06211299937499416*distf[20]-0.1075828707279838*distf[19]-0.1075828707279838*distf[18]+0.1075828707279838*distf[17]-0.1863389981249825*distf[16]-0.02777777777777778*distf[15]+0.04811252243246882*distf[14]-0.04811252243246882*distf[13]-0.04811252243246882*distf[12]-0.04811252243246882*distf[11]+0.08333333333333333*distf[10]+0.08333333333333333*distf[9]-0.08333333333333333*distf[8]+0.08333333333333333*distf[7]-0.08333333333333333*distf[6]-0.08333333333333333*distf[5]+0.1443375672974065*distf[4]+0.1443375672974065*distf[3]+0.1443375672974065*distf[2]-0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[12] = (-0.03586095690932793*distf[23])-0.06211299937499416*distf[22]+0.06211299937499416*distf[21]+0.06211299937499416*distf[20]+0.1075828707279838*distf[19]+0.1075828707279838*distf[18]-0.1075828707279838*distf[17]-0.1863389981249825*distf[16]-0.02777777777777778*distf[15]-0.04811252243246882*distf[14]+0.04811252243246882*distf[13]+0.04811252243246882*distf[12]+0.04811252243246882*distf[11]+0.08333333333333333*distf[10]+0.08333333333333333*distf[9]-0.08333333333333333*distf[8]+0.08333333333333333*distf[7]-0.08333333333333333*distf[6]-0.08333333333333333*distf[5]-0.1443375672974065*distf[4]-0.1443375672974065*distf[3]-0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[13] = 0.03586095690932793*distf[23]+0.06211299937499416*distf[22]-0.06211299937499416*distf[21]+0.06211299937499416*distf[20]-0.1075828707279838*distf[19]+0.1075828707279838*distf[18]-0.1075828707279838*distf[17]-0.1863389981249825*distf[16]+0.02777777777777778*distf[15]+0.04811252243246882*distf[14]-0.04811252243246882*distf[13]-0.04811252243246882*distf[12]+0.04811252243246882*distf[11]-0.08333333333333333*distf[10]-0.08333333333333333*distf[9]+0.08333333333333333*distf[8]+0.08333333333333333*distf[7]-0.08333333333333333*distf[6]-0.08333333333333333*distf[5]+0.1443375672974065*distf[4]-0.1443375672974065*distf[3]-0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[14] = (-0.0537914353639919*distf[23])-0.09316949906249124*distf[22]+0.09316949906249124*distf[21]+0.09316949906249124*distf[20]+0.1613743060919757*distf[19]+0.1613743060919757*distf[18]-0.1613743060919757*distf[17]-0.2795084971874737*distf[16]+0.04811252243246882*distf[12]+0.08333333333333333*distf[9]-0.08333333333333333*distf[8]-0.08333333333333333*distf[5]-0.1443375672974065*distf[4]-0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[15] = 0.0537914353639919*distf[23]+0.09316949906249124*distf[22]-0.09316949906249124*distf[21]+0.09316949906249124*distf[20]-0.1613743060919757*distf[19]+0.1613743060919757*distf[18]-0.1613743060919757*distf[17]-0.2795084971874737*distf[16]-0.04811252243246882*distf[12]-0.08333333333333333*distf[9]+0.08333333333333333*distf[8]-0.08333333333333333*distf[5]+0.1443375672974065*distf[4]-0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[16] = (-0.03586095690932793*distf[23])-0.06211299937499416*distf[22]+0.06211299937499416*distf[21]+0.06211299937499416*distf[20]+0.1075828707279838*distf[19]+0.1075828707279838*distf[18]-0.1075828707279838*distf[17]-0.1863389981249825*distf[16]+0.02777777777777778*distf[15]+0.04811252243246882*distf[14]-0.04811252243246882*distf[13]+0.04811252243246882*distf[12]-0.04811252243246882*distf[11]-0.08333333333333333*distf[10]+0.08333333333333333*distf[9]-0.08333333333333333*distf[8]-0.08333333333333333*distf[7]+0.08333333333333333*distf[6]-0.08333333333333333*distf[5]-0.1443375672974065*distf[4]+0.1443375672974065*distf[3]-0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[17] = 0.03586095690932793*distf[23]+0.06211299937499416*distf[22]-0.06211299937499416*distf[21]+0.06211299937499416*distf[20]-0.1075828707279838*distf[19]+0.1075828707279838*distf[18]-0.1075828707279838*distf[17]-0.1863389981249825*distf[16]-0.02777777777777778*distf[15]-0.04811252243246882*distf[14]+0.04811252243246882*distf[13]-0.04811252243246882*distf[12]-0.04811252243246882*distf[11]+0.08333333333333333*distf[10]-0.08333333333333333*distf[9]+0.08333333333333333*distf[8]-0.08333333333333333*distf[7]+0.08333333333333333*distf[6]-0.08333333333333333*distf[5]+0.1443375672974065*distf[4]+0.1443375672974065*distf[3]-0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[18] = 0.03586095690932793*distf[23]+0.06211299937499416*distf[22]+0.06211299937499416*distf[21]-0.06211299937499416*distf[20]+0.1075828707279838*distf[19]-0.1075828707279838*distf[18]-0.1075828707279838*distf[17]-0.1863389981249825*distf[16]+0.02777777777777778*distf[15]+0.04811252243246882*distf[14]+0.04811252243246882*distf[13]-0.04811252243246882*distf[12]-0.04811252243246882*distf[11]+0.08333333333333333*distf[10]-0.08333333333333333*distf[9]-0.08333333333333333*distf[8]-0.08333333333333333*distf[7]-0.08333333333333333*distf[6]+0.08333333333333333*distf[5]-0.1443375672974065*distf[4]-0.1443375672974065*distf[3]+0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[19] = (-0.03586095690932793*distf[23])-0.06211299937499416*distf[22]-0.06211299937499416*distf[21]-0.06211299937499416*distf[20]-0.1075828707279838*distf[19]-0.1075828707279838*distf[18]-0.1075828707279838*distf[17]-0.1863389981249825*distf[16]-0.02777777777777778*distf[15]-0.04811252243246882*distf[14]-0.04811252243246882*distf[13]+0.04811252243246882*distf[12]-0.04811252243246882*distf[11]-0.08333333333333333*distf[10]+0.08333333333333333*distf[9]+0.08333333333333333*distf[8]-0.08333333333333333*distf[7]-0.08333333333333333*distf[6]+0.08333333333333333*distf[5]+0.1443375672974065*distf[4]-0.1443375672974065*distf[3]+0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[20] = 0.0537914353639919*distf[23]+0.09316949906249124*distf[22]+0.09316949906249124*distf[21]-0.09316949906249124*distf[20]+0.1613743060919757*distf[19]-0.1613743060919757*distf[18]-0.1613743060919757*distf[17]-0.2795084971874737*distf[16]-0.04811252243246882*distf[12]-0.08333333333333333*distf[9]-0.08333333333333333*distf[8]+0.08333333333333333*distf[5]-0.1443375672974065*distf[4]+0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[21] = (-0.0537914353639919*distf[23])-0.09316949906249124*distf[22]-0.09316949906249124*distf[21]-0.09316949906249124*distf[20]-0.1613743060919757*distf[19]-0.1613743060919757*distf[18]-0.1613743060919757*distf[17]-0.2795084971874737*distf[16]+0.04811252243246882*distf[12]+0.08333333333333333*distf[9]+0.08333333333333333*distf[8]+0.08333333333333333*distf[5]+0.1443375672974065*distf[4]+0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[22] = 0.03586095690932793*distf[23]+0.06211299937499416*distf[22]+0.06211299937499416*distf[21]-0.06211299937499416*distf[20]+0.1075828707279838*distf[19]-0.1075828707279838*distf[18]-0.1075828707279838*distf[17]-0.1863389981249825*distf[16]-0.02777777777777778*distf[15]-0.04811252243246882*distf[14]-0.04811252243246882*distf[13]-0.04811252243246882*distf[12]+0.04811252243246882*distf[11]-0.08333333333333333*distf[10]-0.08333333333333333*distf[9]-0.08333333333333333*distf[8]+0.08333333333333333*distf[7]+0.08333333333333333*distf[6]+0.08333333333333333*distf[5]-0.1443375672974065*distf[4]+0.1443375672974065*distf[3]+0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 
  fnod[23] = (-0.03586095690932793*distf[23])-0.06211299937499416*distf[22]-0.06211299937499416*distf[21]-0.06211299937499416*distf[20]-0.1075828707279838*distf[19]-0.1075828707279838*distf[18]-0.1075828707279838*distf[17]-0.1863389981249825*distf[16]+0.02777777777777778*distf[15]+0.04811252243246882*distf[14]+0.04811252243246882*distf[13]+0.04811252243246882*distf[12]+0.04811252243246882*distf[11]+0.08333333333333333*distf[10]+0.08333333333333333*distf[9]+0.08333333333333333*distf[8]+0.08333333333333333*distf[7]+0.08333333333333333*distf[6]+0.08333333333333333*distf[5]+0.1443375672974065*distf[4]+0.1443375672974065*distf[3]+0.1443375672974065*distf[2]+0.1443375672974065*distf[1]+0.25*distf[0]; 

  // If f < 0. at positivity control points, set it to ffloor.
  if (fnod[0] < 0.) {
    fnod[0] = ffloor;
    shifted = true;
  }
  if (fnod[1] < 0.) {
    fnod[1] = ffloor;
    shifted = true;
  }
  if (fnod[2] < 0.) {
    fnod[2] = ffloor;
    shifted = true;
  }
  if (fnod[3] < 0.) {
    fnod[3] = ffloor;
    shifted = true;
  }
  if (fnod[4] < 0.) {
    fnod[4] = ffloor;
    shifted = true;
  }
  if (fnod[5] < 0.) {
    fnod[5] = ffloor;
    shifted = true;
  }
  if (fnod[6] < 0.) {
    fnod[6] = ffloor;
    shifted = true;
  }
  if (fnod[7] < 0.) {
    fnod[7] = ffloor;
    shifted = true;
  }
  if (fnod[8] < 0.) {
    fnod[8] = ffloor;
    shifted = true;
  }
  if (fnod[9] < 0.) {
    fnod[9] = ffloor;
    shifted = true;
  }
  if (fnod[10] < 0.) {
    fnod[10] = ffloor;
    shifted = true;
  }
  if (fnod[11] < 0.) {
    fnod[11] = ffloor;
    shifted = true;
  }
  if (fnod[12] < 0.) {
    fnod[12] = ffloor;
    shifted = true;
  }
  if (fnod[13] < 0.) {
    fnod[13] = ffloor;
    shifted = true;
  }
  if (fnod[14] < 0.) {
    fnod[14] = ffloor;
    shifted = true;
  }
  if (fnod[15] < 0.) {
    fnod[15] = ffloor;
    shifted = true;
  }
  if (fnod[16] < 0.) {
    fnod[16] = ffloor;
    shifted = true;
  }
  if (fnod[17] < 0.) {
    fnod[17] = ffloor;
    shifted = true;
  }
  if (fnod[18] < 0.) {
    fnod[18] = ffloor;
    shifted = true;
  }
  if (fnod[19] < 0.) {
    fnod[19] = ffloor;
    shifted = true;
  }
  if (fnod[20] < 0.) {
    fnod[20] = ffloor;
    shifted = true;
  }
  if (fnod[21] < 0.) {
    fnod[21] = ffloor;
    shifted = true;
  }
  if (fnod[22] < 0.) {
    fnod[22] = ffloor;
    shifted = true;
  }
  if (fnod[23] < 0.) {
    fnod[23] = ffloor;
    shifted = true;
  }

  distf[0] = 0.75*fnod[23]+0.75*fnod[22]-1.0*fnod[21]-1.0*fnod[20]+0.75*fnod[19]+0.75*fnod[18]+0.75*fnod[17]+0.75*fnod[16]-1.0*fnod[15]-1.0*fnod[14]+0.75*fnod[13]+0.75*fnod[12]+0.75*fnod[11]+0.75*fnod[10]-1.0*fnod[9]-1.0*fnod[8]+0.75*fnod[7]+0.75*fnod[6]+0.75*fnod[5]+0.75*fnod[4]-1.0*fnod[3]-1.0*fnod[2]+0.75*fnod[1]+0.75*fnod[0]; 
  distf[1] = 1.299038105676658*fnod[23]+1.299038105676658*fnod[22]-1.732050807568877*fnod[21]-1.732050807568877*fnod[20]+1.299038105676658*fnod[19]+1.299038105676658*fnod[18]+1.299038105676658*fnod[17]+1.299038105676658*fnod[16]-1.732050807568877*fnod[15]-1.732050807568877*fnod[14]+1.299038105676658*fnod[13]+1.299038105676658*fnod[12]-1.299038105676658*fnod[11]-1.299038105676658*fnod[10]+1.732050807568877*fnod[9]+1.732050807568877*fnod[8]-1.299038105676658*fnod[7]-1.299038105676658*fnod[6]-1.299038105676658*fnod[5]-1.299038105676658*fnod[4]+1.732050807568877*fnod[3]+1.732050807568877*fnod[2]-1.299038105676658*fnod[1]-1.299038105676658*fnod[0]; 
  distf[2] = 1.299038105676658*fnod[23]+1.299038105676658*fnod[22]-1.732050807568877*fnod[21]-1.732050807568877*fnod[20]+1.299038105676658*fnod[19]+1.299038105676658*fnod[18]-1.299038105676658*fnod[17]-1.299038105676658*fnod[16]+1.732050807568877*fnod[15]+1.732050807568877*fnod[14]-1.299038105676658*fnod[13]-1.299038105676658*fnod[12]+1.299038105676658*fnod[11]+1.299038105676658*fnod[10]-1.732050807568877*fnod[9]-1.732050807568877*fnod[8]+1.299038105676658*fnod[7]+1.299038105676658*fnod[6]-1.299038105676658*fnod[5]-1.299038105676658*fnod[4]+1.732050807568877*fnod[3]+1.732050807568877*fnod[2]-1.299038105676658*fnod[1]-1.299038105676658*fnod[0]; 
  distf[3] = 0.4330127018922193*fnod[23]+0.4330127018922193*fnod[22]-0.4330127018922193*fnod[19]-0.4330127018922193*fnod[18]+0.4330127018922193*fnod[17]+0.4330127018922193*fnod[16]-0.4330127018922193*fnod[13]-0.4330127018922193*fnod[12]+0.4330127018922193*fnod[11]+0.4330127018922193*fnod[10]-0.4330127018922193*fnod[7]-0.4330127018922193*fnod[6]+0.4330127018922193*fnod[5]+0.4330127018922193*fnod[4]-0.4330127018922193*fnod[1]-0.4330127018922193*fnod[0]; 
  distf[4] = 1.299038105676658*fnod[23]-1.299038105676658*fnod[22]-1.732050807568877*fnod[21]+1.732050807568877*fnod[20]+1.299038105676658*fnod[19]-1.299038105676658*fnod[18]+1.299038105676658*fnod[17]-1.299038105676658*fnod[16]-1.732050807568877*fnod[15]+1.732050807568877*fnod[14]+1.299038105676658*fnod[13]-1.299038105676658*fnod[12]+1.299038105676658*fnod[11]-1.299038105676658*fnod[10]-1.732050807568877*fnod[9]+1.732050807568877*fnod[8]+1.299038105676658*fnod[7]-1.299038105676658*fnod[6]+1.299038105676658*fnod[5]-1.299038105676658*fnod[4]-1.732050807568877*fnod[3]+1.732050807568877*fnod[2]+1.299038105676658*fnod[1]-1.299038105676658*fnod[0]; 
  distf[5] = 2.25*fnod[23]+2.25*fnod[22]-3.0*fnod[21]-3.0*fnod[20]+2.25*fnod[19]+2.25*fnod[18]-2.25*fnod[17]-2.25*fnod[16]+3.0*fnod[15]+3.0*fnod[14]-2.25*fnod[13]-2.25*fnod[12]-2.25*fnod[11]-2.25*fnod[10]+3.0*fnod[9]+3.0*fnod[8]-2.25*fnod[7]-2.25*fnod[6]+2.25*fnod[5]+2.25*fnod[4]-3.0*fnod[3]-3.0*fnod[2]+2.25*fnod[1]+2.25*fnod[0]; 
  distf[6] = 0.75*fnod[23]+0.75*fnod[22]-0.75*fnod[19]-0.75*fnod[18]+0.75*fnod[17]+0.75*fnod[16]-0.75*fnod[13]-0.75*fnod[12]-0.75*fnod[11]-0.75*fnod[10]+0.75*fnod[7]+0.75*fnod[6]-0.75*fnod[5]-0.75*fnod[4]+0.75*fnod[1]+0.75*fnod[0]; 
  distf[7] = 0.75*fnod[23]+0.75*fnod[22]-0.75*fnod[19]-0.75*fnod[18]-0.75*fnod[17]-0.75*fnod[16]+0.75*fnod[13]+0.75*fnod[12]+0.75*fnod[11]+0.75*fnod[10]-0.75*fnod[7]-0.75*fnod[6]-0.75*fnod[5]-0.75*fnod[4]+0.75*fnod[1]+0.75*fnod[0]; 
  distf[8] = 2.25*fnod[23]-2.25*fnod[22]-3.0*fnod[21]+3.0*fnod[20]+2.25*fnod[19]-2.25*fnod[18]+2.25*fnod[17]-2.25*fnod[16]-3.0*fnod[15]+3.0*fnod[14]+2.25*fnod[13]-2.25*fnod[12]-2.25*fnod[11]+2.25*fnod[10]+3.0*fnod[9]-3.0*fnod[8]-2.25*fnod[7]+2.25*fnod[6]-2.25*fnod[5]+2.25*fnod[4]+3.0*fnod[3]-3.0*fnod[2]-2.25*fnod[1]+2.25*fnod[0]; 
  distf[9] = 2.25*fnod[23]-2.25*fnod[22]-3.0*fnod[21]+3.0*fnod[20]+2.25*fnod[19]-2.25*fnod[18]-2.25*fnod[17]+2.25*fnod[16]+3.0*fnod[15]-3.0*fnod[14]-2.25*fnod[13]+2.25*fnod[12]+2.25*fnod[11]-2.25*fnod[10]-3.0*fnod[9]+3.0*fnod[8]+2.25*fnod[7]-2.25*fnod[6]-2.25*fnod[5]+2.25*fnod[4]+3.0*fnod[3]-3.0*fnod[2]-2.25*fnod[1]+2.25*fnod[0]; 
  distf[10] = 0.75*fnod[23]-0.75*fnod[22]-0.75*fnod[19]+0.75*fnod[18]+0.75*fnod[17]-0.75*fnod[16]-0.75*fnod[13]+0.75*fnod[12]+0.75*fnod[11]-0.75*fnod[10]-0.75*fnod[7]+0.75*fnod[6]+0.75*fnod[5]-0.75*fnod[4]-0.75*fnod[1]+0.75*fnod[0]; 
  distf[11] = 1.299038105676658*fnod[23]+1.299038105676658*fnod[22]-1.299038105676658*fnod[19]-1.299038105676658*fnod[18]-1.299038105676658*fnod[17]-1.299038105676658*fnod[16]+1.299038105676658*fnod[13]+1.299038105676658*fnod[12]-1.299038105676658*fnod[11]-1.299038105676658*fnod[10]+1.299038105676658*fnod[7]+1.299038105676658*fnod[6]+1.299038105676658*fnod[5]+1.299038105676658*fnod[4]-1.299038105676658*fnod[1]-1.299038105676658*fnod[0]; 
  distf[12] = 3.897114317029973*fnod[23]-3.897114317029973*fnod[22]-5.196152422706631*fnod[21]+5.196152422706631*fnod[20]+3.897114317029973*fnod[19]-3.897114317029973*fnod[18]-3.897114317029973*fnod[17]+3.897114317029973*fnod[16]+5.196152422706631*fnod[15]-5.196152422706631*fnod[14]-3.897114317029973*fnod[13]+3.897114317029973*fnod[12]-3.897114317029973*fnod[11]+3.897114317029973*fnod[10]+5.196152422706631*fnod[9]-5.196152422706631*fnod[8]-3.897114317029973*fnod[7]+3.897114317029973*fnod[6]+3.897114317029973*fnod[5]-3.897114317029973*fnod[4]-5.196152422706631*fnod[3]+5.196152422706631*fnod[2]+3.897114317029973*fnod[1]-3.897114317029973*fnod[0]; 
  distf[13] = 1.299038105676658*fnod[23]-1.299038105676658*fnod[22]-1.299038105676658*fnod[19]+1.299038105676658*fnod[18]+1.299038105676658*fnod[17]-1.299038105676658*fnod[16]-1.299038105676658*fnod[13]+1.299038105676658*fnod[12]-1.299038105676658*fnod[11]+1.299038105676658*fnod[10]+1.299038105676658*fnod[7]-1.299038105676658*fnod[6]-1.299038105676658*fnod[5]+1.299038105676658*fnod[4]+1.299038105676658*fnod[1]-1.299038105676658*fnod[0]; 
  distf[14] = 1.299038105676658*fnod[23]-1.299038105676658*fnod[22]-1.299038105676658*fnod[19]+1.299038105676658*fnod[18]-1.299038105676658*fnod[17]+1.299038105676658*fnod[16]+1.299038105676658*fnod[13]-1.299038105676658*fnod[12]+1.299038105676658*fnod[11]-1.299038105676658*fnod[10]-1.299038105676658*fnod[7]+1.299038105676658*fnod[6]-1.299038105676658*fnod[5]+1.299038105676658*fnod[4]+1.299038105676658*fnod[1]-1.299038105676658*fnod[0]; 
  distf[15] = 2.25*fnod[23]-2.25*fnod[22]-2.25*fnod[19]+2.25*fnod[18]-2.25*fnod[17]+2.25*fnod[16]+2.25*fnod[13]-2.25*fnod[12]-2.25*fnod[11]+2.25*fnod[10]+2.25*fnod[7]-2.25*fnod[6]+2.25*fnod[5]-2.25*fnod[4]-2.25*fnod[1]+2.25*fnod[0]; 
  distf[16] = 0.6708203932499369*fnod[23]+0.6708203932499369*fnod[22]-1.341640786499874*fnod[21]-1.341640786499874*fnod[20]+0.6708203932499369*fnod[19]+0.6708203932499369*fnod[18]+0.6708203932499369*fnod[17]+0.6708203932499369*fnod[16]-1.341640786499874*fnod[15]-1.341640786499874*fnod[14]+0.6708203932499369*fnod[13]+0.6708203932499369*fnod[12]+0.6708203932499369*fnod[11]+0.6708203932499369*fnod[10]-1.341640786499874*fnod[9]-1.341640786499874*fnod[8]+0.6708203932499369*fnod[7]+0.6708203932499369*fnod[6]+0.6708203932499369*fnod[5]+0.6708203932499369*fnod[4]-1.341640786499874*fnod[3]-1.341640786499874*fnod[2]+0.6708203932499369*fnod[1]+0.6708203932499369*fnod[0]; 
  distf[17] = 1.161895003862225*fnod[23]+1.161895003862225*fnod[22]-2.32379000772445*fnod[21]-2.32379000772445*fnod[20]+1.161895003862225*fnod[19]+1.161895003862225*fnod[18]+1.161895003862225*fnod[17]+1.161895003862225*fnod[16]-2.32379000772445*fnod[15]-2.32379000772445*fnod[14]+1.161895003862225*fnod[13]+1.161895003862225*fnod[12]-1.161895003862225*fnod[11]-1.161895003862225*fnod[10]+2.32379000772445*fnod[9]+2.32379000772445*fnod[8]-1.161895003862225*fnod[7]-1.161895003862225*fnod[6]-1.161895003862225*fnod[5]-1.161895003862225*fnod[4]+2.32379000772445*fnod[3]+2.32379000772445*fnod[2]-1.161895003862225*fnod[1]-1.161895003862225*fnod[0]; 
  distf[18] = 1.161895003862225*fnod[23]+1.161895003862225*fnod[22]-2.32379000772445*fnod[21]-2.32379000772445*fnod[20]+1.161895003862225*fnod[19]+1.161895003862225*fnod[18]-1.161895003862225*fnod[17]-1.161895003862225*fnod[16]+2.32379000772445*fnod[15]+2.32379000772445*fnod[14]-1.161895003862225*fnod[13]-1.161895003862225*fnod[12]+1.161895003862225*fnod[11]+1.161895003862225*fnod[10]-2.32379000772445*fnod[9]-2.32379000772445*fnod[8]+1.161895003862225*fnod[7]+1.161895003862225*fnod[6]-1.161895003862225*fnod[5]-1.161895003862225*fnod[4]+2.32379000772445*fnod[3]+2.32379000772445*fnod[2]-1.161895003862225*fnod[1]-1.161895003862225*fnod[0]; 
  distf[19] = 1.161895003862225*fnod[23]-1.161895003862225*fnod[22]-2.32379000772445*fnod[21]+2.32379000772445*fnod[20]+1.161895003862225*fnod[19]-1.161895003862225*fnod[18]+1.161895003862225*fnod[17]-1.161895003862225*fnod[16]-2.32379000772445*fnod[15]+2.32379000772445*fnod[14]+1.161895003862225*fnod[13]-1.161895003862225*fnod[12]+1.161895003862225*fnod[11]-1.161895003862225*fnod[10]-2.32379000772445*fnod[9]+2.32379000772445*fnod[8]+1.161895003862225*fnod[7]-1.161895003862225*fnod[6]+1.161895003862225*fnod[5]-1.161895003862225*fnod[4]-2.32379000772445*fnod[3]+2.32379000772445*fnod[2]+1.161895003862225*fnod[1]-1.161895003862225*fnod[0]; 
  distf[20] = 2.012461179749811*fnod[23]+2.012461179749811*fnod[22]-4.024922359499621*fnod[21]-4.024922359499621*fnod[20]+2.012461179749811*fnod[19]+2.012461179749811*fnod[18]-2.012461179749811*fnod[17]-2.012461179749811*fnod[16]+4.024922359499621*fnod[15]+4.024922359499621*fnod[14]-2.012461179749811*fnod[13]-2.012461179749811*fnod[12]-2.012461179749811*fnod[11]-2.012461179749811*fnod[10]+4.024922359499621*fnod[9]+4.024922359499621*fnod[8]-2.012461179749811*fnod[7]-2.012461179749811*fnod[6]+2.012461179749811*fnod[5]+2.012461179749811*fnod[4]-4.024922359499621*fnod[3]-4.024922359499621*fnod[2]+2.012461179749811*fnod[1]+2.012461179749811*fnod[0]; 
  distf[21] = 2.012461179749811*fnod[23]-2.012461179749811*fnod[22]-4.024922359499621*fnod[21]+4.024922359499621*fnod[20]+2.012461179749811*fnod[19]-2.012461179749811*fnod[18]+2.012461179749811*fnod[17]-2.012461179749811*fnod[16]-4.024922359499621*fnod[15]+4.024922359499621*fnod[14]+2.012461179749811*fnod[13]-2.012461179749811*fnod[12]-2.012461179749811*fnod[11]+2.012461179749811*fnod[10]+4.024922359499621*fnod[9]-4.024922359499621*fnod[8]-2.012461179749811*fnod[7]+2.012461179749811*fnod[6]-2.012461179749811*fnod[5]+2.012461179749811*fnod[4]+4.024922359499621*fnod[3]-4.024922359499621*fnod[2]-2.012461179749811*fnod[1]+2.012461179749811*fnod[0]; 
  distf[22] = 2.012461179749811*fnod[23]-2.012461179749811*fnod[22]-4.024922359499621*fnod[21]+4.024922359499621*fnod[20]+2.012461179749811*fnod[19]-2.012461179749811*fnod[18]-2.012461179749811*fnod[17]+2.012461179749811*fnod[16]+4.024922359499621*fnod[15]-4.024922359499621*fnod[14]-2.012461179749811*fnod[13]+2.012461179749811*fnod[12]+2.012461179749811*fnod[11]-2.012461179749811*fnod[10]-4.024922359499621*fnod[9]+4.024922359499621*fnod[8]+2.012461179749811*fnod[7]-2.012461179749811*fnod[6]-2.012461179749811*fnod[5]+2.012461179749811*fnod[4]+4.024922359499621*fnod[3]-4.024922359499621*fnod[2]-2.012461179749811*fnod[1]+2.012461179749811*fnod[0]; 
  distf[23] = 3.485685011586675*fnod[23]-3.485685011586675*fnod[22]-6.971370023173351*fnod[21]+6.971370023173351*fnod[20]+3.485685011586675*fnod[19]-3.485685011586675*fnod[18]-3.485685011586675*fnod[17]+3.485685011586675*fnod[16]+6.971370023173351*fnod[15]-6.971370023173351*fnod[14]-3.485685011586675*fnod[13]+3.485685011586675*fnod[12]-3.485685011586675*fnod[11]+3.485685011586675*fnod[10]+6.971370023173351*fnod[9]-6.971370023173351*fnod[8]-3.485685011586675*fnod[7]+3.485685011586675*fnod[6]+3.485685011586675*fnod[5]-3.485685011586675*fnod[4]-6.971370023173351*fnod[3]+6.971370023173351*fnod[2]+3.485685011586675*fnod[1]-3.485685011586675*fnod[0]; 

  if (shifted) {
  Deltaf[0] += distf[0]; 
  Deltaf[1] += distf[1]; 
  Deltaf[2] += distf[2]; 
  Deltaf[3] += distf[3]; 
  Deltaf[4] += distf[4]; 
  Deltaf[5] += distf[5]; 
  Deltaf[6] += distf[6]; 
  Deltaf[7] += distf[7]; 
  Deltaf[8] += distf[8]; 
  Deltaf[9] += distf[9]; 
  Deltaf[10] += distf[10]; 
  Deltaf[11] += distf[11]; 
  Deltaf[12] += distf[12]; 
  Deltaf[13] += distf[13]; 
  Deltaf[14] += distf[14]; 
  Deltaf[15] += distf[15]; 
  Deltaf[16] += distf[16]; 
  Deltaf[17] += distf[17]; 
  Deltaf[18] += distf[18]; 
  Deltaf[19] += distf[19]; 
  Deltaf[20] += distf[20]; 
  Deltaf[21] += distf[21]; 
  Deltaf[22] += distf[22]; 
  Deltaf[23] += distf[23]; 
  }

  return shifted;

}
