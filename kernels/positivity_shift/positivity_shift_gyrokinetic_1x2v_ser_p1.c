#include <gkyl_positivity_shift_gyrokinetic_kernels.h> 

GKYL_CU_DH bool positivity_shift_gyrokinetic_1x2v_ser_p1(double ffloor, double *distf, double *Deltaf) 
{ 
  // ffloor: Distribution function floor to shift to when f<0.
  // distf: distribution function.
  // Deltaf: Change in the distribution function.

  bool shifted = false;

  Deltaf[0] = -1.0*distf[0]; 
  Deltaf[1] = -1.0*distf[1]; 
  Deltaf[2] = -1.0*distf[2]; 
  Deltaf[3] = -1.0*distf[3]; 
  Deltaf[4] = -1.0*distf[4]; 
  Deltaf[5] = -1.0*distf[5]; 
  Deltaf[6] = -1.0*distf[6]; 
  Deltaf[7] = -1.0*distf[7]; 
  Deltaf[8] = -1.0*distf[8]; 
  Deltaf[9] = -1.0*distf[9]; 
  Deltaf[10] = -1.0*distf[10]; 
  Deltaf[11] = -1.0*distf[11]; 

  double fnod[12];
  fnod[0] = (-0.0878410461157883*distf[11])+0.1521451548625461*distf[10]+0.1521451548625461*distf[9]-0.2635231383473649*distf[8]-0.06804138174397717*distf[7]+0.1178511301977579*distf[6]+0.1178511301977579*distf[5]+0.1178511301977579*distf[4]-0.2041241452319315*distf[3]-0.2041241452319315*distf[2]-0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[1] = 0.0878410461157883*distf[11]-0.1521451548625461*distf[10]+0.1521451548625461*distf[9]-0.2635231383473649*distf[8]+0.06804138174397717*distf[7]-0.1178511301977579*distf[6]-0.1178511301977579*distf[5]+0.1178511301977579*distf[4]+0.2041241452319315*distf[3]-0.2041241452319315*distf[2]-0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[2] = (-0.1317615691736824*distf[11])+0.2282177322938191*distf[10]+0.2282177322938191*distf[9]-0.3952847075210473*distf[8]+0.1178511301977579*distf[5]-0.2041241452319315*distf[3]-0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[3] = 0.1317615691736824*distf[11]-0.2282177322938191*distf[10]+0.2282177322938191*distf[9]-0.3952847075210473*distf[8]-0.1178511301977579*distf[5]+0.2041241452319315*distf[3]-0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[4] = (-0.0878410461157883*distf[11])+0.1521451548625461*distf[10]+0.1521451548625461*distf[9]-0.2635231383473649*distf[8]+0.06804138174397717*distf[7]-0.1178511301977579*distf[6]+0.1178511301977579*distf[5]-0.1178511301977579*distf[4]-0.2041241452319315*distf[3]+0.2041241452319315*distf[2]-0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[5] = 0.0878410461157883*distf[11]-0.1521451548625461*distf[10]+0.1521451548625461*distf[9]-0.2635231383473649*distf[8]-0.06804138174397717*distf[7]+0.1178511301977579*distf[6]-0.1178511301977579*distf[5]-0.1178511301977579*distf[4]+0.2041241452319315*distf[3]+0.2041241452319315*distf[2]-0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[6] = 0.0878410461157883*distf[11]+0.1521451548625461*distf[10]-0.1521451548625461*distf[9]-0.2635231383473649*distf[8]+0.06804138174397717*distf[7]+0.1178511301977579*distf[6]-0.1178511301977579*distf[5]-0.1178511301977579*distf[4]-0.2041241452319315*distf[3]-0.2041241452319315*distf[2]+0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[7] = (-0.0878410461157883*distf[11])-0.1521451548625461*distf[10]-0.1521451548625461*distf[9]-0.2635231383473649*distf[8]-0.06804138174397717*distf[7]-0.1178511301977579*distf[6]+0.1178511301977579*distf[5]-0.1178511301977579*distf[4]+0.2041241452319315*distf[3]-0.2041241452319315*distf[2]+0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[8] = 0.1317615691736824*distf[11]+0.2282177322938191*distf[10]-0.2282177322938191*distf[9]-0.3952847075210473*distf[8]-0.1178511301977579*distf[5]-0.2041241452319315*distf[3]+0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[9] = (-0.1317615691736824*distf[11])-0.2282177322938191*distf[10]-0.2282177322938191*distf[9]-0.3952847075210473*distf[8]+0.1178511301977579*distf[5]+0.2041241452319315*distf[3]+0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[10] = 0.0878410461157883*distf[11]+0.1521451548625461*distf[10]-0.1521451548625461*distf[9]-0.2635231383473649*distf[8]-0.06804138174397717*distf[7]-0.1178511301977579*distf[6]-0.1178511301977579*distf[5]+0.1178511301977579*distf[4]-0.2041241452319315*distf[3]+0.2041241452319315*distf[2]+0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 
  fnod[11] = (-0.0878410461157883*distf[11])-0.1521451548625461*distf[10]-0.1521451548625461*distf[9]-0.2635231383473649*distf[8]+0.06804138174397717*distf[7]+0.1178511301977579*distf[6]+0.1178511301977579*distf[5]+0.1178511301977579*distf[4]+0.2041241452319315*distf[3]+0.2041241452319315*distf[2]+0.2041241452319315*distf[1]+0.3535533905932737*distf[0]; 

  // If f < 0. at positivity control points, set it to ffloor.
  if (fnod[0] < 0.) {
    fnod[0] = ffloor;
    shifted = true;
  }
  if (fnod[1] < 0.) {
    fnod[1] = ffloor;
    shifted = true;
  }
  if (fnod[2] < 0.) {
    fnod[2] = ffloor;
    shifted = true;
  }
  if (fnod[3] < 0.) {
    fnod[3] = ffloor;
    shifted = true;
  }
  if (fnod[4] < 0.) {
    fnod[4] = ffloor;
    shifted = true;
  }
  if (fnod[5] < 0.) {
    fnod[5] = ffloor;
    shifted = true;
  }
  if (fnod[6] < 0.) {
    fnod[6] = ffloor;
    shifted = true;
  }
  if (fnod[7] < 0.) {
    fnod[7] = ffloor;
    shifted = true;
  }
  if (fnod[8] < 0.) {
    fnod[8] = ffloor;
    shifted = true;
  }
  if (fnod[9] < 0.) {
    fnod[9] = ffloor;
    shifted = true;
  }
  if (fnod[10] < 0.) {
    fnod[10] = ffloor;
    shifted = true;
  }
  if (fnod[11] < 0.) {
    fnod[11] = ffloor;
    shifted = true;
  }

  distf[0] = 1.060660171779821*fnod[11]+1.060660171779821*fnod[10]-1.414213562373095*fnod[9]-1.414213562373095*fnod[8]+1.060660171779821*fnod[7]+1.060660171779821*fnod[6]+1.060660171779821*fnod[5]+1.060660171779821*fnod[4]-1.414213562373095*fnod[3]-1.414213562373095*fnod[2]+1.060660171779821*fnod[1]+1.060660171779821*fnod[0]; 
  distf[1] = 1.837117307087383*fnod[11]+1.837117307087383*fnod[10]-2.449489742783178*fnod[9]-2.449489742783178*fnod[8]+1.837117307087383*fnod[7]+1.837117307087383*fnod[6]-1.837117307087383*fnod[5]-1.837117307087383*fnod[4]+2.449489742783178*fnod[3]+2.449489742783178*fnod[2]-1.837117307087383*fnod[1]-1.837117307087383*fnod[0]; 
  distf[2] = 0.6123724356957944*fnod[11]+0.6123724356957944*fnod[10]-0.6123724356957944*fnod[7]-0.6123724356957944*fnod[6]+0.6123724356957944*fnod[5]+0.6123724356957944*fnod[4]-0.6123724356957944*fnod[1]-0.6123724356957944*fnod[0]; 
  distf[3] = 1.837117307087383*fnod[11]-1.837117307087383*fnod[10]-2.449489742783178*fnod[9]+2.449489742783178*fnod[8]+1.837117307087383*fnod[7]-1.837117307087383*fnod[6]+1.837117307087383*fnod[5]-1.837117307087383*fnod[4]-2.449489742783178*fnod[3]+2.449489742783178*fnod[2]+1.837117307087383*fnod[1]-1.837117307087383*fnod[0]; 
  distf[4] = 1.060660171779821*fnod[11]+1.060660171779821*fnod[10]-1.060660171779821*fnod[7]-1.060660171779821*fnod[6]-1.060660171779821*fnod[5]-1.060660171779821*fnod[4]+1.060660171779821*fnod[1]+1.060660171779821*fnod[0]; 
  distf[5] = 3.181980515339463*fnod[11]-3.181980515339463*fnod[10]-4.242640687119286*fnod[9]+4.242640687119286*fnod[8]+3.181980515339463*fnod[7]-3.181980515339463*fnod[6]-3.181980515339463*fnod[5]+3.181980515339463*fnod[4]+4.242640687119286*fnod[3]-4.242640687119286*fnod[2]-3.181980515339463*fnod[1]+3.181980515339463*fnod[0]; 
  distf[6] = 1.060660171779821*fnod[11]-1.060660171779821*fnod[10]-1.060660171779821*fnod[7]+1.060660171779821*fnod[6]+1.060660171779821*fnod[5]-1.060660171779821*fnod[4]-1.060660171779821*fnod[1]+1.060660171779821*fnod[0]; 
  distf[7] = 1.837117307087383*fnod[11]-1.837117307087383*fnod[10]-1.837117307087383*fnod[7]+1.837117307087383*fnod[6]-1.837117307087383*fnod[5]+1.837117307087383*fnod[4]+1.837117307087383*fnod[1]-1.837117307087383*fnod[0]; 
  distf[8] = 0.9486832980505137*fnod[11]+0.9486832980505137*fnod[10]-1.897366596101028*fnod[9]-1.897366596101028*fnod[8]+0.9486832980505137*fnod[7]+0.9486832980505137*fnod[6]+0.9486832980505137*fnod[5]+0.9486832980505137*fnod[4]-1.897366596101028*fnod[3]-1.897366596101028*fnod[2]+0.9486832980505137*fnod[1]+0.9486832980505137*fnod[0]; 
  distf[9] = 1.643167672515498*fnod[11]+1.643167672515498*fnod[10]-3.286335345030997*fnod[9]-3.286335345030997*fnod[8]+1.643167672515498*fnod[7]+1.643167672515498*fnod[6]-1.643167672515498*fnod[5]-1.643167672515498*fnod[4]+3.286335345030997*fnod[3]+3.286335345030997*fnod[2]-1.643167672515498*fnod[1]-1.643167672515498*fnod[0]; 
  distf[10] = 1.643167672515498*fnod[11]-1.643167672515498*fnod[10]-3.286335345030997*fnod[9]+3.286335345030997*fnod[8]+1.643167672515498*fnod[7]-1.643167672515498*fnod[6]+1.643167672515498*fnod[5]-1.643167672515498*fnod[4]-3.286335345030997*fnod[3]+3.286335345030997*fnod[2]+1.643167672515498*fnod[1]-1.643167672515498*fnod[0]; 
  distf[11] = 2.846049894151541*fnod[11]-2.846049894151541*fnod[10]-5.692099788303083*fnod[9]+5.692099788303083*fnod[8]+2.846049894151541*fnod[7]-2.846049894151541*fnod[6]-2.846049894151541*fnod[5]+2.846049894151541*fnod[4]+5.692099788303083*fnod[3]-5.692099788303083*fnod[2]-2.846049894151541*fnod[1]+2.846049894151541*fnod[0]; 

  if (shifted) {
  Deltaf[0] += distf[0]; 
  Deltaf[1] += distf[1]; 
  Deltaf[2] += distf[2]; 
  Deltaf[3] += distf[3]; 
  Deltaf[4] += distf[4]; 
  Deltaf[5] += distf[5]; 
  Deltaf[6] += distf[6]; 
  Deltaf[7] += distf[7]; 
  Deltaf[8] += distf[8]; 
  Deltaf[9] += distf[9]; 
  Deltaf[10] += distf[10]; 
  Deltaf[11] += distf[11]; 
  }

  return shifted;

}
