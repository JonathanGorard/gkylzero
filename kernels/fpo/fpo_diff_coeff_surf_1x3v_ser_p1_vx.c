#include <gkyl_fpo_vlasov_kernels.h> 

GKYL_CU_DH void fpo_diff_coeff_diag_1x3v_vx_ser_p1(const double *diff_coeff_L, const double *diff_coeff_R, double *diff_coeff_surf_R) {
  // diff_coeff_L,R: Diffusion tensor in left and right along pv1 direction. 
  // diff_coeff_surf_R: Output array for surface projection of recovered diffusion tensor at lower edge of right cell. 
  const double *D_L = 0; 
  const double *D_R = 0; 
  double *D_surf_out = 0; 


  D_L = &diff_coeff_L[0]; 
  D_R = &diff_coeff_R[0]; 
  D_surf_out = &diff_coeff_surf_R[0]; 

  D_surf_out[0] = -(0.408248290463863*D_R[2])+0.408248290463863*D_L[2]+0.3535533905932737*D_R[0]+0.3535533905932737*D_L[0]; 
  D_surf_out[1] = -(0.408248290463863*D_R[5])+0.408248290463863*D_L[5]+0.3535533905932737*D_R[1]+0.3535533905932737*D_L[1]; 
  D_surf_out[2] = -(0.408248290463863*D_R[7])+0.408248290463863*D_L[7]+0.3535533905932737*D_R[3]+0.3535533905932737*D_L[3]; 
  D_surf_out[3] = -(0.408248290463863*D_R[9])+0.408248290463863*D_L[9]+0.3535533905932737*D_R[4]+0.3535533905932737*D_L[4]; 
  D_surf_out[4] = -(0.408248290463863*D_R[11])+0.408248290463863*D_L[11]+0.3535533905932737*D_R[6]+0.3535533905932737*D_L[6]; 
  D_surf_out[5] = -(0.408248290463863*D_R[12])+0.408248290463863*D_L[12]+0.3535533905932737*D_R[8]+0.3535533905932737*D_L[8]; 
  D_surf_out[6] = -(0.408248290463863*D_R[14])+0.408248290463863*D_L[14]+0.3535533905932737*D_R[10]+0.3535533905932737*D_L[10]; 
  D_surf_out[7] = -(0.408248290463863*D_R[15])+0.408248290463863*D_L[15]+0.3535533905932737*D_R[13]+0.3535533905932737*D_L[13]; 


  D_L = &diff_coeff_L[40]; 
  D_R = &diff_coeff_R[40]; 
  D_surf_out = &diff_coeff_surf_R[8]; 

  D_surf_out[0] = -(0.408248290463863*D_R[2])+0.408248290463863*D_L[2]+0.3535533905932737*D_R[0]+0.3535533905932737*D_L[0]; 
  D_surf_out[1] = -(0.408248290463863*D_R[5])+0.408248290463863*D_L[5]+0.3535533905932737*D_R[1]+0.3535533905932737*D_L[1]; 
  D_surf_out[2] = -(0.408248290463863*D_R[7])+0.408248290463863*D_L[7]+0.3535533905932737*D_R[3]+0.3535533905932737*D_L[3]; 
  D_surf_out[3] = -(0.408248290463863*D_R[9])+0.408248290463863*D_L[9]+0.3535533905932737*D_R[4]+0.3535533905932737*D_L[4]; 
  D_surf_out[4] = -(0.408248290463863*D_R[11])+0.408248290463863*D_L[11]+0.3535533905932737*D_R[6]+0.3535533905932737*D_L[6]; 
  D_surf_out[5] = -(0.408248290463863*D_R[12])+0.408248290463863*D_L[12]+0.3535533905932737*D_R[8]+0.3535533905932737*D_L[8]; 
  D_surf_out[6] = -(0.408248290463863*D_R[14])+0.408248290463863*D_L[14]+0.3535533905932737*D_R[10]+0.3535533905932737*D_L[10]; 
  D_surf_out[7] = -(0.408248290463863*D_R[15])+0.408248290463863*D_L[15]+0.3535533905932737*D_R[13]+0.3535533905932737*D_L[13]; 


  D_L = &diff_coeff_L[80]; 
  D_R = &diff_coeff_R[80]; 
  D_surf_out = &diff_coeff_surf_R[16]; 

  D_surf_out[0] = -(0.408248290463863*D_R[2])+0.408248290463863*D_L[2]+0.3535533905932737*D_R[0]+0.3535533905932737*D_L[0]; 
  D_surf_out[1] = -(0.408248290463863*D_R[5])+0.408248290463863*D_L[5]+0.3535533905932737*D_R[1]+0.3535533905932737*D_L[1]; 
  D_surf_out[2] = -(0.408248290463863*D_R[7])+0.408248290463863*D_L[7]+0.3535533905932737*D_R[3]+0.3535533905932737*D_L[3]; 
  D_surf_out[3] = -(0.408248290463863*D_R[9])+0.408248290463863*D_L[9]+0.3535533905932737*D_R[4]+0.3535533905932737*D_L[4]; 
  D_surf_out[4] = -(0.408248290463863*D_R[11])+0.408248290463863*D_L[11]+0.3535533905932737*D_R[6]+0.3535533905932737*D_L[6]; 
  D_surf_out[5] = -(0.408248290463863*D_R[12])+0.408248290463863*D_L[12]+0.3535533905932737*D_R[8]+0.3535533905932737*D_L[8]; 
  D_surf_out[6] = -(0.408248290463863*D_R[14])+0.408248290463863*D_L[14]+0.3535533905932737*D_R[10]+0.3535533905932737*D_L[10]; 
  D_surf_out[7] = -(0.408248290463863*D_R[15])+0.408248290463863*D_L[15]+0.3535533905932737*D_R[13]+0.3535533905932737*D_L[13]; 

}
