#include <gkyl_maxwell_kernels.h> 
#include <gkyl_binop_mul_ser.h> 
GKYL_CU_DH void em_calc_surf_BB_3x_tensor_p2(const double *em, double* GKYL_RESTRICT out_surf) 
{ 
  // em:             Input electromagnetic fields. 
  // out_surf:       Output [BxBx_xl, BxBx_xr, ByBy_xl, ByBy_xr, BzBz_xl, BzBz_xr, BxBy_xl, BxBy_xr, BxBz_xl, BxBz_xr, 
  //                         BxBx_yl, BxBx_yr, ByBy_yl, ByBy_yr, BzBz_yl, BzBz_yr, BxBy_yl, BxBy_yr, ByBz_yl, ByBz_yr, 
  //                         BxBx_zl, BxBx_zr, ByBy_zl, ByBy_zr, BzBz_zl, BzBz_zr, BxBz_zl, BxBz_zr, ByBz_zl, ByBz_zr]. 
 
  double *Bx_sq_xl = &out_surf[0]; 
  double *Bx_sq_xr = &out_surf[9]; 
  double *By_sq_xl = &out_surf[18]; 
  double *By_sq_xr = &out_surf[27]; 
  double *Bz_sq_xl = &out_surf[36]; 
  double *Bz_sq_xr = &out_surf[45]; 
  double *B_x_B_y_xl = &out_surf[54]; 
  double *B_x_B_y_xr = &out_surf[63]; 
  double *B_x_B_z_xl = &out_surf[72]; 
  double *B_x_B_z_xr = &out_surf[81]; 
 
  double *Bx_sq_yl = &out_surf[90]; 
  double *Bx_sq_yr = &out_surf[99]; 
  double *By_sq_yl = &out_surf[108]; 
  double *By_sq_yr = &out_surf[117]; 
  double *Bz_sq_yl = &out_surf[126]; 
  double *Bz_sq_yr = &out_surf[135]; 
  double *B_x_B_y_yl = &out_surf[144]; 
  double *B_x_B_y_yr = &out_surf[153]; 
  double *B_y_B_z_yl = &out_surf[162]; 
  double *B_y_B_z_yr = &out_surf[171]; 
 
  double *Bx_sq_zl = &out_surf[180]; 
  double *Bx_sq_zr = &out_surf[189]; 
  double *By_sq_zl = &out_surf[198]; 
  double *By_sq_zr = &out_surf[207]; 
  double *Bz_sq_zl = &out_surf[216]; 
  double *Bz_sq_zr = &out_surf[225]; 
  double *B_x_B_z_zl = &out_surf[234]; 
  double *B_x_B_z_zr = &out_surf[243]; 
  double *B_y_B_z_zl = &out_surf[252]; 
  double *B_y_B_z_zr = &out_surf[261]; 
 
  const double *B_x = &em[81]; 
  const double *B_y = &em[108]; 
  const double *B_z = &em[135]; 
 
  double B_x_xl[9] = {0.0}; 
  double B_x_xr[9] = {0.0}; 
  double B_y_xl[9] = {0.0}; 
  double B_y_xr[9] = {0.0}; 
  double B_z_xl[9] = {0.0}; 
  double B_z_xr[9] = {0.0}; 
 
  B_x_xl[0] = 1.58113883008419*B_x[7]-1.224744871391589*B_x[1]+0.7071067811865475*B_x[0]; 
  B_x_xl[1] = 1.58113883008419*B_x[11]-1.224744871391589*B_x[4]+0.7071067811865475*B_x[2]; 
  B_x_xl[2] = 1.58113883008419*B_x[13]-1.224744871391589*B_x[5]+0.7071067811865475*B_x[3]; 
  B_x_xl[3] = 1.58113883008419*B_x[17]-1.224744871391589*B_x[10]+0.7071067811865475*B_x[6]; 
  B_x_xl[4] = 1.58113883008419*B_x[20]-1.224744871391589*B_x[12]+0.7071067811865475*B_x[8]; 
  B_x_xl[5] = 1.58113883008419*B_x[21]-1.224744871391589*B_x[15]+0.7071067811865475*B_x[9]; 
  B_x_xl[6] = 1.58113883008419*B_x[23]-1.224744871391589*B_x[18]+0.7071067811865475*B_x[14]; 
  B_x_xl[7] = 1.58113883008419*B_x[24]-1.224744871391589*B_x[19]+0.7071067811865475*B_x[16]; 
  B_x_xl[8] = 1.58113883008419*B_x[26]-1.224744871391589*B_x[25]+0.7071067811865475*B_x[22]; 
  B_x_xr[0] = 1.58113883008419*B_x[7]+1.224744871391589*B_x[1]+0.7071067811865475*B_x[0]; 
  B_x_xr[1] = 1.58113883008419*B_x[11]+1.224744871391589*B_x[4]+0.7071067811865475*B_x[2]; 
  B_x_xr[2] = 1.58113883008419*B_x[13]+1.224744871391589*B_x[5]+0.7071067811865475*B_x[3]; 
  B_x_xr[3] = 1.58113883008419*B_x[17]+1.224744871391589*B_x[10]+0.7071067811865475*B_x[6]; 
  B_x_xr[4] = 1.58113883008419*B_x[20]+1.224744871391589*B_x[12]+0.7071067811865475*B_x[8]; 
  B_x_xr[5] = 1.58113883008419*B_x[21]+1.224744871391589*B_x[15]+0.7071067811865475*B_x[9]; 
  B_x_xr[6] = 1.58113883008419*B_x[23]+1.224744871391589*B_x[18]+0.7071067811865475*B_x[14]; 
  B_x_xr[7] = 1.58113883008419*B_x[24]+1.224744871391589*B_x[19]+0.7071067811865475*B_x[16]; 
  B_x_xr[8] = 1.58113883008419*B_x[26]+1.224744871391589*B_x[25]+0.7071067811865475*B_x[22]; 
  B_y_xl[0] = 1.58113883008419*B_y[7]-1.224744871391589*B_y[1]+0.7071067811865475*B_y[0]; 
  B_y_xl[1] = 1.58113883008419*B_y[11]-1.224744871391589*B_y[4]+0.7071067811865475*B_y[2]; 
  B_y_xl[2] = 1.58113883008419*B_y[13]-1.224744871391589*B_y[5]+0.7071067811865475*B_y[3]; 
  B_y_xl[3] = 1.58113883008419*B_y[17]-1.224744871391589*B_y[10]+0.7071067811865475*B_y[6]; 
  B_y_xl[4] = 1.58113883008419*B_y[20]-1.224744871391589*B_y[12]+0.7071067811865475*B_y[8]; 
  B_y_xl[5] = 1.58113883008419*B_y[21]-1.224744871391589*B_y[15]+0.7071067811865475*B_y[9]; 
  B_y_xl[6] = 1.58113883008419*B_y[23]-1.224744871391589*B_y[18]+0.7071067811865475*B_y[14]; 
  B_y_xl[7] = 1.58113883008419*B_y[24]-1.224744871391589*B_y[19]+0.7071067811865475*B_y[16]; 
  B_y_xl[8] = 1.58113883008419*B_y[26]-1.224744871391589*B_y[25]+0.7071067811865475*B_y[22]; 
  B_y_xr[0] = 1.58113883008419*B_y[7]+1.224744871391589*B_y[1]+0.7071067811865475*B_y[0]; 
  B_y_xr[1] = 1.58113883008419*B_y[11]+1.224744871391589*B_y[4]+0.7071067811865475*B_y[2]; 
  B_y_xr[2] = 1.58113883008419*B_y[13]+1.224744871391589*B_y[5]+0.7071067811865475*B_y[3]; 
  B_y_xr[3] = 1.58113883008419*B_y[17]+1.224744871391589*B_y[10]+0.7071067811865475*B_y[6]; 
  B_y_xr[4] = 1.58113883008419*B_y[20]+1.224744871391589*B_y[12]+0.7071067811865475*B_y[8]; 
  B_y_xr[5] = 1.58113883008419*B_y[21]+1.224744871391589*B_y[15]+0.7071067811865475*B_y[9]; 
  B_y_xr[6] = 1.58113883008419*B_y[23]+1.224744871391589*B_y[18]+0.7071067811865475*B_y[14]; 
  B_y_xr[7] = 1.58113883008419*B_y[24]+1.224744871391589*B_y[19]+0.7071067811865475*B_y[16]; 
  B_y_xr[8] = 1.58113883008419*B_y[26]+1.224744871391589*B_y[25]+0.7071067811865475*B_y[22]; 
  B_z_xl[0] = 1.58113883008419*B_z[7]-1.224744871391589*B_z[1]+0.7071067811865475*B_z[0]; 
  B_z_xl[1] = 1.58113883008419*B_z[11]-1.224744871391589*B_z[4]+0.7071067811865475*B_z[2]; 
  B_z_xl[2] = 1.58113883008419*B_z[13]-1.224744871391589*B_z[5]+0.7071067811865475*B_z[3]; 
  B_z_xl[3] = 1.58113883008419*B_z[17]-1.224744871391589*B_z[10]+0.7071067811865475*B_z[6]; 
  B_z_xl[4] = 1.58113883008419*B_z[20]-1.224744871391589*B_z[12]+0.7071067811865475*B_z[8]; 
  B_z_xl[5] = 1.58113883008419*B_z[21]-1.224744871391589*B_z[15]+0.7071067811865475*B_z[9]; 
  B_z_xl[6] = 1.58113883008419*B_z[23]-1.224744871391589*B_z[18]+0.7071067811865475*B_z[14]; 
  B_z_xl[7] = 1.58113883008419*B_z[24]-1.224744871391589*B_z[19]+0.7071067811865475*B_z[16]; 
  B_z_xl[8] = 1.58113883008419*B_z[26]-1.224744871391589*B_z[25]+0.7071067811865475*B_z[22]; 
  B_z_xr[0] = 1.58113883008419*B_z[7]+1.224744871391589*B_z[1]+0.7071067811865475*B_z[0]; 
  B_z_xr[1] = 1.58113883008419*B_z[11]+1.224744871391589*B_z[4]+0.7071067811865475*B_z[2]; 
  B_z_xr[2] = 1.58113883008419*B_z[13]+1.224744871391589*B_z[5]+0.7071067811865475*B_z[3]; 
  B_z_xr[3] = 1.58113883008419*B_z[17]+1.224744871391589*B_z[10]+0.7071067811865475*B_z[6]; 
  B_z_xr[4] = 1.58113883008419*B_z[20]+1.224744871391589*B_z[12]+0.7071067811865475*B_z[8]; 
  B_z_xr[5] = 1.58113883008419*B_z[21]+1.224744871391589*B_z[15]+0.7071067811865475*B_z[9]; 
  B_z_xr[6] = 1.58113883008419*B_z[23]+1.224744871391589*B_z[18]+0.7071067811865475*B_z[14]; 
  B_z_xr[7] = 1.58113883008419*B_z[24]+1.224744871391589*B_z[19]+0.7071067811865475*B_z[16]; 
  B_z_xr[8] = 1.58113883008419*B_z[26]+1.224744871391589*B_z[25]+0.7071067811865475*B_z[22]; 
  // Calculate B_i B_j on the left x interface. 
  binop_mul_2d_tensor_p2(B_x_xl, B_x_xl, Bx_sq_xl); 
  binop_mul_2d_tensor_p2(B_y_xl, B_y_xl, By_sq_xl); 
  binop_mul_2d_tensor_p2(B_z_xl, B_z_xl, Bz_sq_xl); 
  binop_mul_2d_tensor_p2(B_x_xl, B_y_xl, B_x_B_y_xl); 
  binop_mul_2d_tensor_p2(B_x_xl, B_z_xl, B_x_B_z_xl); 
 
  // Calculate B_i B_j on the right x interface. 
  binop_mul_2d_tensor_p2(B_x_xr, B_x_xr, Bx_sq_xr); 
  binop_mul_2d_tensor_p2(B_y_xr, B_y_xr, By_sq_xr); 
  binop_mul_2d_tensor_p2(B_z_xr, B_z_xr, Bz_sq_xr); 
  binop_mul_2d_tensor_p2(B_x_xr, B_y_xr, B_x_B_y_xr); 
  binop_mul_2d_tensor_p2(B_x_xr, B_z_xr, B_x_B_z_xr); 
 
  double B_x_yl[9] = {0.0}; 
  double B_x_yr[9] = {0.0}; 
  double B_y_yl[9] = {0.0}; 
  double B_y_yr[9] = {0.0}; 
  double B_z_yl[9] = {0.0}; 
  double B_z_yr[9] = {0.0}; 
 
  B_x_yl[0] = 1.58113883008419*B_x[8]-1.224744871391589*B_x[2]+0.7071067811865475*B_x[0]; 
  B_x_yl[1] = 1.58113883008419*B_x[12]-1.224744871391589*B_x[4]+0.7071067811865475*B_x[1]; 
  B_x_yl[2] = 1.58113883008419*B_x[14]-1.224744871391589*B_x[6]+0.7071067811865475*B_x[3]; 
  B_x_yl[3] = 1.58113883008419*B_x[18]-1.224744871391589*B_x[10]+0.7071067811865475*B_x[5]; 
  B_x_yl[4] = 1.58113883008419*B_x[20]-1.224744871391589*B_x[11]+0.7071067811865475*B_x[7]; 
  B_x_yl[5] = 1.58113883008419*B_x[22]-1.224744871391589*B_x[16]+0.7071067811865475*B_x[9]; 
  B_x_yl[6] = 1.58113883008419*B_x[23]-1.224744871391589*B_x[17]+0.7071067811865475*B_x[13]; 
  B_x_yl[7] = 1.58113883008419*B_x[25]-1.224744871391589*B_x[19]+0.7071067811865475*B_x[15]; 
  B_x_yl[8] = 1.58113883008419*B_x[26]-1.224744871391589*B_x[24]+0.7071067811865475*B_x[21]; 
  B_x_yr[0] = 1.58113883008419*B_x[8]+1.224744871391589*B_x[2]+0.7071067811865475*B_x[0]; 
  B_x_yr[1] = 1.58113883008419*B_x[12]+1.224744871391589*B_x[4]+0.7071067811865475*B_x[1]; 
  B_x_yr[2] = 1.58113883008419*B_x[14]+1.224744871391589*B_x[6]+0.7071067811865475*B_x[3]; 
  B_x_yr[3] = 1.58113883008419*B_x[18]+1.224744871391589*B_x[10]+0.7071067811865475*B_x[5]; 
  B_x_yr[4] = 1.58113883008419*B_x[20]+1.224744871391589*B_x[11]+0.7071067811865475*B_x[7]; 
  B_x_yr[5] = 1.58113883008419*B_x[22]+1.224744871391589*B_x[16]+0.7071067811865475*B_x[9]; 
  B_x_yr[6] = 1.58113883008419*B_x[23]+1.224744871391589*B_x[17]+0.7071067811865475*B_x[13]; 
  B_x_yr[7] = 1.58113883008419*B_x[25]+1.224744871391589*B_x[19]+0.7071067811865475*B_x[15]; 
  B_x_yr[8] = 1.58113883008419*B_x[26]+1.224744871391589*B_x[24]+0.7071067811865475*B_x[21]; 
  B_y_yl[0] = 1.58113883008419*B_y[8]-1.224744871391589*B_y[2]+0.7071067811865475*B_y[0]; 
  B_y_yl[1] = 1.58113883008419*B_y[12]-1.224744871391589*B_y[4]+0.7071067811865475*B_y[1]; 
  B_y_yl[2] = 1.58113883008419*B_y[14]-1.224744871391589*B_y[6]+0.7071067811865475*B_y[3]; 
  B_y_yl[3] = 1.58113883008419*B_y[18]-1.224744871391589*B_y[10]+0.7071067811865475*B_y[5]; 
  B_y_yl[4] = 1.58113883008419*B_y[20]-1.224744871391589*B_y[11]+0.7071067811865475*B_y[7]; 
  B_y_yl[5] = 1.58113883008419*B_y[22]-1.224744871391589*B_y[16]+0.7071067811865475*B_y[9]; 
  B_y_yl[6] = 1.58113883008419*B_y[23]-1.224744871391589*B_y[17]+0.7071067811865475*B_y[13]; 
  B_y_yl[7] = 1.58113883008419*B_y[25]-1.224744871391589*B_y[19]+0.7071067811865475*B_y[15]; 
  B_y_yl[8] = 1.58113883008419*B_y[26]-1.224744871391589*B_y[24]+0.7071067811865475*B_y[21]; 
  B_y_yr[0] = 1.58113883008419*B_y[8]+1.224744871391589*B_y[2]+0.7071067811865475*B_y[0]; 
  B_y_yr[1] = 1.58113883008419*B_y[12]+1.224744871391589*B_y[4]+0.7071067811865475*B_y[1]; 
  B_y_yr[2] = 1.58113883008419*B_y[14]+1.224744871391589*B_y[6]+0.7071067811865475*B_y[3]; 
  B_y_yr[3] = 1.58113883008419*B_y[18]+1.224744871391589*B_y[10]+0.7071067811865475*B_y[5]; 
  B_y_yr[4] = 1.58113883008419*B_y[20]+1.224744871391589*B_y[11]+0.7071067811865475*B_y[7]; 
  B_y_yr[5] = 1.58113883008419*B_y[22]+1.224744871391589*B_y[16]+0.7071067811865475*B_y[9]; 
  B_y_yr[6] = 1.58113883008419*B_y[23]+1.224744871391589*B_y[17]+0.7071067811865475*B_y[13]; 
  B_y_yr[7] = 1.58113883008419*B_y[25]+1.224744871391589*B_y[19]+0.7071067811865475*B_y[15]; 
  B_y_yr[8] = 1.58113883008419*B_y[26]+1.224744871391589*B_y[24]+0.7071067811865475*B_y[21]; 
  B_z_yl[0] = 1.58113883008419*B_z[8]-1.224744871391589*B_z[2]+0.7071067811865475*B_z[0]; 
  B_z_yl[1] = 1.58113883008419*B_z[12]-1.224744871391589*B_z[4]+0.7071067811865475*B_z[1]; 
  B_z_yl[2] = 1.58113883008419*B_z[14]-1.224744871391589*B_z[6]+0.7071067811865475*B_z[3]; 
  B_z_yl[3] = 1.58113883008419*B_z[18]-1.224744871391589*B_z[10]+0.7071067811865475*B_z[5]; 
  B_z_yl[4] = 1.58113883008419*B_z[20]-1.224744871391589*B_z[11]+0.7071067811865475*B_z[7]; 
  B_z_yl[5] = 1.58113883008419*B_z[22]-1.224744871391589*B_z[16]+0.7071067811865475*B_z[9]; 
  B_z_yl[6] = 1.58113883008419*B_z[23]-1.224744871391589*B_z[17]+0.7071067811865475*B_z[13]; 
  B_z_yl[7] = 1.58113883008419*B_z[25]-1.224744871391589*B_z[19]+0.7071067811865475*B_z[15]; 
  B_z_yl[8] = 1.58113883008419*B_z[26]-1.224744871391589*B_z[24]+0.7071067811865475*B_z[21]; 
  B_z_yr[0] = 1.58113883008419*B_z[8]+1.224744871391589*B_z[2]+0.7071067811865475*B_z[0]; 
  B_z_yr[1] = 1.58113883008419*B_z[12]+1.224744871391589*B_z[4]+0.7071067811865475*B_z[1]; 
  B_z_yr[2] = 1.58113883008419*B_z[14]+1.224744871391589*B_z[6]+0.7071067811865475*B_z[3]; 
  B_z_yr[3] = 1.58113883008419*B_z[18]+1.224744871391589*B_z[10]+0.7071067811865475*B_z[5]; 
  B_z_yr[4] = 1.58113883008419*B_z[20]+1.224744871391589*B_z[11]+0.7071067811865475*B_z[7]; 
  B_z_yr[5] = 1.58113883008419*B_z[22]+1.224744871391589*B_z[16]+0.7071067811865475*B_z[9]; 
  B_z_yr[6] = 1.58113883008419*B_z[23]+1.224744871391589*B_z[17]+0.7071067811865475*B_z[13]; 
  B_z_yr[7] = 1.58113883008419*B_z[25]+1.224744871391589*B_z[19]+0.7071067811865475*B_z[15]; 
  B_z_yr[8] = 1.58113883008419*B_z[26]+1.224744871391589*B_z[24]+0.7071067811865475*B_z[21]; 
  // Calculate B_i B_j on the left y interface. 
  binop_mul_2d_tensor_p2(B_x_yl, B_x_yl, Bx_sq_yl); 
  binop_mul_2d_tensor_p2(B_y_yl, B_y_yl, By_sq_yl); 
  binop_mul_2d_tensor_p2(B_z_yl, B_z_yl, Bz_sq_yl); 
  binop_mul_2d_tensor_p2(B_x_yl, B_y_yl, B_x_B_y_yl); 
  binop_mul_2d_tensor_p2(B_y_yl, B_z_yl, B_y_B_z_yl); 
 
  // Calculate B_i B_j on the right y interface. 
  binop_mul_2d_tensor_p2(B_x_yr, B_x_yr, Bx_sq_yr); 
  binop_mul_2d_tensor_p2(B_y_yr, B_y_yr, By_sq_yr); 
  binop_mul_2d_tensor_p2(B_z_yr, B_z_yr, Bz_sq_yr); 
  binop_mul_2d_tensor_p2(B_x_yr, B_y_yr, B_x_B_y_yr); 
  binop_mul_2d_tensor_p2(B_y_yr, B_z_yr, B_y_B_z_yr); 
 
  double B_x_zl[9] = {0.0}; 
  double B_x_zr[9] = {0.0}; 
  double B_y_zl[9] = {0.0}; 
  double B_y_zr[9] = {0.0}; 
  double B_z_zl[9] = {0.0}; 
  double B_z_zr[9] = {0.0}; 
 
  B_x_zl[0] = 1.58113883008419*B_x[9]-1.224744871391589*B_x[3]+0.7071067811865475*B_x[0]; 
  B_x_zl[1] = 1.58113883008419*B_x[15]-1.224744871391589*B_x[5]+0.7071067811865475*B_x[1]; 
  B_x_zl[2] = 1.58113883008419*B_x[16]-1.224744871391589*B_x[6]+0.7071067811865475*B_x[2]; 
  B_x_zl[3] = 1.58113883008419*B_x[19]-1.224744871391589*B_x[10]+0.7071067811865475*B_x[4]; 
  B_x_zl[4] = 1.58113883008419*B_x[21]-1.224744871391589*B_x[13]+0.7071067811865475*B_x[7]; 
  B_x_zl[5] = 1.58113883008419*B_x[22]-1.224744871391589*B_x[14]+0.7071067811865475*B_x[8]; 
  B_x_zl[6] = 1.58113883008419*B_x[24]-1.224744871391589*B_x[17]+0.7071067811865475*B_x[11]; 
  B_x_zl[7] = 1.58113883008419*B_x[25]-1.224744871391589*B_x[18]+0.7071067811865475*B_x[12]; 
  B_x_zl[8] = 1.58113883008419*B_x[26]-1.224744871391589*B_x[23]+0.7071067811865475*B_x[20]; 
  B_x_zr[0] = 1.58113883008419*B_x[9]+1.224744871391589*B_x[3]+0.7071067811865475*B_x[0]; 
  B_x_zr[1] = 1.58113883008419*B_x[15]+1.224744871391589*B_x[5]+0.7071067811865475*B_x[1]; 
  B_x_zr[2] = 1.58113883008419*B_x[16]+1.224744871391589*B_x[6]+0.7071067811865475*B_x[2]; 
  B_x_zr[3] = 1.58113883008419*B_x[19]+1.224744871391589*B_x[10]+0.7071067811865475*B_x[4]; 
  B_x_zr[4] = 1.58113883008419*B_x[21]+1.224744871391589*B_x[13]+0.7071067811865475*B_x[7]; 
  B_x_zr[5] = 1.58113883008419*B_x[22]+1.224744871391589*B_x[14]+0.7071067811865475*B_x[8]; 
  B_x_zr[6] = 1.58113883008419*B_x[24]+1.224744871391589*B_x[17]+0.7071067811865475*B_x[11]; 
  B_x_zr[7] = 1.58113883008419*B_x[25]+1.224744871391589*B_x[18]+0.7071067811865475*B_x[12]; 
  B_x_zr[8] = 1.58113883008419*B_x[26]+1.224744871391589*B_x[23]+0.7071067811865475*B_x[20]; 
  B_y_zl[0] = 1.58113883008419*B_y[9]-1.224744871391589*B_y[3]+0.7071067811865475*B_y[0]; 
  B_y_zl[1] = 1.58113883008419*B_y[15]-1.224744871391589*B_y[5]+0.7071067811865475*B_y[1]; 
  B_y_zl[2] = 1.58113883008419*B_y[16]-1.224744871391589*B_y[6]+0.7071067811865475*B_y[2]; 
  B_y_zl[3] = 1.58113883008419*B_y[19]-1.224744871391589*B_y[10]+0.7071067811865475*B_y[4]; 
  B_y_zl[4] = 1.58113883008419*B_y[21]-1.224744871391589*B_y[13]+0.7071067811865475*B_y[7]; 
  B_y_zl[5] = 1.58113883008419*B_y[22]-1.224744871391589*B_y[14]+0.7071067811865475*B_y[8]; 
  B_y_zl[6] = 1.58113883008419*B_y[24]-1.224744871391589*B_y[17]+0.7071067811865475*B_y[11]; 
  B_y_zl[7] = 1.58113883008419*B_y[25]-1.224744871391589*B_y[18]+0.7071067811865475*B_y[12]; 
  B_y_zl[8] = 1.58113883008419*B_y[26]-1.224744871391589*B_y[23]+0.7071067811865475*B_y[20]; 
  B_y_zr[0] = 1.58113883008419*B_y[9]+1.224744871391589*B_y[3]+0.7071067811865475*B_y[0]; 
  B_y_zr[1] = 1.58113883008419*B_y[15]+1.224744871391589*B_y[5]+0.7071067811865475*B_y[1]; 
  B_y_zr[2] = 1.58113883008419*B_y[16]+1.224744871391589*B_y[6]+0.7071067811865475*B_y[2]; 
  B_y_zr[3] = 1.58113883008419*B_y[19]+1.224744871391589*B_y[10]+0.7071067811865475*B_y[4]; 
  B_y_zr[4] = 1.58113883008419*B_y[21]+1.224744871391589*B_y[13]+0.7071067811865475*B_y[7]; 
  B_y_zr[5] = 1.58113883008419*B_y[22]+1.224744871391589*B_y[14]+0.7071067811865475*B_y[8]; 
  B_y_zr[6] = 1.58113883008419*B_y[24]+1.224744871391589*B_y[17]+0.7071067811865475*B_y[11]; 
  B_y_zr[7] = 1.58113883008419*B_y[25]+1.224744871391589*B_y[18]+0.7071067811865475*B_y[12]; 
  B_y_zr[8] = 1.58113883008419*B_y[26]+1.224744871391589*B_y[23]+0.7071067811865475*B_y[20]; 
  B_z_zl[0] = 1.58113883008419*B_z[9]-1.224744871391589*B_z[3]+0.7071067811865475*B_z[0]; 
  B_z_zl[1] = 1.58113883008419*B_z[15]-1.224744871391589*B_z[5]+0.7071067811865475*B_z[1]; 
  B_z_zl[2] = 1.58113883008419*B_z[16]-1.224744871391589*B_z[6]+0.7071067811865475*B_z[2]; 
  B_z_zl[3] = 1.58113883008419*B_z[19]-1.224744871391589*B_z[10]+0.7071067811865475*B_z[4]; 
  B_z_zl[4] = 1.58113883008419*B_z[21]-1.224744871391589*B_z[13]+0.7071067811865475*B_z[7]; 
  B_z_zl[5] = 1.58113883008419*B_z[22]-1.224744871391589*B_z[14]+0.7071067811865475*B_z[8]; 
  B_z_zl[6] = 1.58113883008419*B_z[24]-1.224744871391589*B_z[17]+0.7071067811865475*B_z[11]; 
  B_z_zl[7] = 1.58113883008419*B_z[25]-1.224744871391589*B_z[18]+0.7071067811865475*B_z[12]; 
  B_z_zl[8] = 1.58113883008419*B_z[26]-1.224744871391589*B_z[23]+0.7071067811865475*B_z[20]; 
  B_z_zr[0] = 1.58113883008419*B_z[9]+1.224744871391589*B_z[3]+0.7071067811865475*B_z[0]; 
  B_z_zr[1] = 1.58113883008419*B_z[15]+1.224744871391589*B_z[5]+0.7071067811865475*B_z[1]; 
  B_z_zr[2] = 1.58113883008419*B_z[16]+1.224744871391589*B_z[6]+0.7071067811865475*B_z[2]; 
  B_z_zr[3] = 1.58113883008419*B_z[19]+1.224744871391589*B_z[10]+0.7071067811865475*B_z[4]; 
  B_z_zr[4] = 1.58113883008419*B_z[21]+1.224744871391589*B_z[13]+0.7071067811865475*B_z[7]; 
  B_z_zr[5] = 1.58113883008419*B_z[22]+1.224744871391589*B_z[14]+0.7071067811865475*B_z[8]; 
  B_z_zr[6] = 1.58113883008419*B_z[24]+1.224744871391589*B_z[17]+0.7071067811865475*B_z[11]; 
  B_z_zr[7] = 1.58113883008419*B_z[25]+1.224744871391589*B_z[18]+0.7071067811865475*B_z[12]; 
  B_z_zr[8] = 1.58113883008419*B_z[26]+1.224744871391589*B_z[23]+0.7071067811865475*B_z[20]; 
  // Calculate B_i B_j on the left z interface. 
  binop_mul_2d_tensor_p2(B_x_zl, B_x_zl, Bx_sq_zl); 
  binop_mul_2d_tensor_p2(B_y_zl, B_y_zl, By_sq_zl); 
  binop_mul_2d_tensor_p2(B_z_zl, B_z_zl, Bz_sq_zl); 
  binop_mul_2d_tensor_p2(B_x_zl, B_z_zl, B_x_B_z_zl); 
  binop_mul_2d_tensor_p2(B_y_zl, B_z_zl, B_y_B_z_zl); 
 
  // Calculate B_i B_j on the right z interface. 
  binop_mul_2d_tensor_p2(B_x_zr, B_x_zr, Bx_sq_zr); 
  binop_mul_2d_tensor_p2(B_y_zr, B_y_zr, By_sq_zr); 
  binop_mul_2d_tensor_p2(B_z_zr, B_z_zr, Bz_sq_zr); 
  binop_mul_2d_tensor_p2(B_x_zr, B_z_zr, B_x_B_z_zr); 
  binop_mul_2d_tensor_p2(B_y_zr, B_z_zr, B_y_B_z_zr); 
 
} 
 
