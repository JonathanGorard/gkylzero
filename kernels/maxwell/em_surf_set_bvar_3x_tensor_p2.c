#include <gkyl_maxwell_kernels.h> 
GKYL_CU_DH void em_surf_set_bvar_3x_tensor_p2(const double* bvar, double* GKYL_RESTRICT bvar_surf) 
{ 
  // bvar:      Input volume expansion of b_i = B_i/|B| (first 3 components), b_i b_j = B_i B_j/|B|^2 (last 6 components). 
  // bvar_surf: Output surface expansion of magnetic field unit vector and tensor in each direction. 
 
  const double *bx = &bvar[0]; 
  const double *by = &bvar[27]; 
  const double *bz = &bvar[54]; 
  const double *bxbx = &bvar[81]; 
  const double *bxby = &bvar[108]; 
  const double *bxbz = &bvar[135]; 
  const double *byby = &bvar[162]; 
  const double *bybz = &bvar[189]; 
  const double *bzbz = &bvar[216]; 
 
  double *bx_xl = &bvar_surf[0]; 
  double *bx_xr = &bvar_surf[9]; 
  double *bxbx_xl = &bvar_surf[18]; 
  double *bxbx_xr = &bvar_surf[27]; 
  double *bxby_xl = &bvar_surf[36]; 
  double *bxby_xr = &bvar_surf[45]; 
  double *bxbz_xl = &bvar_surf[54]; 
  double *bxbz_xr = &bvar_surf[63]; 
 
  bx_xl[0] = 1.58113883008419*bx[7]-1.224744871391589*bx[1]+0.7071067811865475*bx[0]; 
  bx_xl[1] = 1.58113883008419*bx[11]-1.224744871391589*bx[4]+0.7071067811865475*bx[2]; 
  bx_xl[2] = 1.58113883008419*bx[13]-1.224744871391589*bx[5]+0.7071067811865475*bx[3]; 
  bx_xl[3] = 1.58113883008419*bx[17]-1.224744871391589*bx[10]+0.7071067811865475*bx[6]; 
  bx_xl[4] = 1.58113883008419*bx[20]-1.224744871391589*bx[12]+0.7071067811865475*bx[8]; 
  bx_xl[5] = 1.58113883008419*bx[21]-1.224744871391589*bx[15]+0.7071067811865475*bx[9]; 
  bx_xl[6] = 1.58113883008419*bx[23]-1.224744871391589*bx[18]+0.7071067811865475*bx[14]; 
  bx_xl[7] = 1.58113883008419*bx[24]-1.224744871391589*bx[19]+0.7071067811865475*bx[16]; 
  bx_xl[8] = 1.58113883008419*bx[26]-1.224744871391589*bx[25]+0.7071067811865475*bx[22]; 
  bxbx_xl[0] = 1.58113883008419*bxbx[7]-1.224744871391589*bxbx[1]+0.7071067811865475*bxbx[0]; 
  bxbx_xl[1] = 1.58113883008419*bxbx[11]-1.224744871391589*bxbx[4]+0.7071067811865475*bxbx[2]; 
  bxbx_xl[2] = 1.58113883008419*bxbx[13]-1.224744871391589*bxbx[5]+0.7071067811865475*bxbx[3]; 
  bxbx_xl[3] = 1.58113883008419*bxbx[17]-1.224744871391589*bxbx[10]+0.7071067811865475*bxbx[6]; 
  bxbx_xl[4] = 1.58113883008419*bxbx[20]-1.224744871391589*bxbx[12]+0.7071067811865475*bxbx[8]; 
  bxbx_xl[5] = 1.58113883008419*bxbx[21]-1.224744871391589*bxbx[15]+0.7071067811865475*bxbx[9]; 
  bxbx_xl[6] = 1.58113883008419*bxbx[23]-1.224744871391589*bxbx[18]+0.7071067811865475*bxbx[14]; 
  bxbx_xl[7] = 1.58113883008419*bxbx[24]-1.224744871391589*bxbx[19]+0.7071067811865475*bxbx[16]; 
  bxbx_xl[8] = 1.58113883008419*bxbx[26]-1.224744871391589*bxbx[25]+0.7071067811865475*bxbx[22]; 
  bxby_xl[0] = 1.58113883008419*bxby[7]-1.224744871391589*bxby[1]+0.7071067811865475*bxby[0]; 
  bxby_xl[1] = 1.58113883008419*bxby[11]-1.224744871391589*bxby[4]+0.7071067811865475*bxby[2]; 
  bxby_xl[2] = 1.58113883008419*bxby[13]-1.224744871391589*bxby[5]+0.7071067811865475*bxby[3]; 
  bxby_xl[3] = 1.58113883008419*bxby[17]-1.224744871391589*bxby[10]+0.7071067811865475*bxby[6]; 
  bxby_xl[4] = 1.58113883008419*bxby[20]-1.224744871391589*bxby[12]+0.7071067811865475*bxby[8]; 
  bxby_xl[5] = 1.58113883008419*bxby[21]-1.224744871391589*bxby[15]+0.7071067811865475*bxby[9]; 
  bxby_xl[6] = 1.58113883008419*bxby[23]-1.224744871391589*bxby[18]+0.7071067811865475*bxby[14]; 
  bxby_xl[7] = 1.58113883008419*bxby[24]-1.224744871391589*bxby[19]+0.7071067811865475*bxby[16]; 
  bxby_xl[8] = 1.58113883008419*bxby[26]-1.224744871391589*bxby[25]+0.7071067811865475*bxby[22]; 
  bxbz_xl[0] = 1.58113883008419*bxbz[7]-1.224744871391589*bxbz[1]+0.7071067811865475*bxbz[0]; 
  bxbz_xl[1] = 1.58113883008419*bxbz[11]-1.224744871391589*bxbz[4]+0.7071067811865475*bxbz[2]; 
  bxbz_xl[2] = 1.58113883008419*bxbz[13]-1.224744871391589*bxbz[5]+0.7071067811865475*bxbz[3]; 
  bxbz_xl[3] = 1.58113883008419*bxbz[17]-1.224744871391589*bxbz[10]+0.7071067811865475*bxbz[6]; 
  bxbz_xl[4] = 1.58113883008419*bxbz[20]-1.224744871391589*bxbz[12]+0.7071067811865475*bxbz[8]; 
  bxbz_xl[5] = 1.58113883008419*bxbz[21]-1.224744871391589*bxbz[15]+0.7071067811865475*bxbz[9]; 
  bxbz_xl[6] = 1.58113883008419*bxbz[23]-1.224744871391589*bxbz[18]+0.7071067811865475*bxbz[14]; 
  bxbz_xl[7] = 1.58113883008419*bxbz[24]-1.224744871391589*bxbz[19]+0.7071067811865475*bxbz[16]; 
  bxbz_xl[8] = 1.58113883008419*bxbz[26]-1.224744871391589*bxbz[25]+0.7071067811865475*bxbz[22]; 
 
  bx_xr[0] = 1.58113883008419*bx[7]+1.224744871391589*bx[1]+0.7071067811865475*bx[0]; 
  bx_xr[1] = 1.58113883008419*bx[11]+1.224744871391589*bx[4]+0.7071067811865475*bx[2]; 
  bx_xr[2] = 1.58113883008419*bx[13]+1.224744871391589*bx[5]+0.7071067811865475*bx[3]; 
  bx_xr[3] = 1.58113883008419*bx[17]+1.224744871391589*bx[10]+0.7071067811865475*bx[6]; 
  bx_xr[4] = 1.58113883008419*bx[20]+1.224744871391589*bx[12]+0.7071067811865475*bx[8]; 
  bx_xr[5] = 1.58113883008419*bx[21]+1.224744871391589*bx[15]+0.7071067811865475*bx[9]; 
  bx_xr[6] = 1.58113883008419*bx[23]+1.224744871391589*bx[18]+0.7071067811865475*bx[14]; 
  bx_xr[7] = 1.58113883008419*bx[24]+1.224744871391589*bx[19]+0.7071067811865475*bx[16]; 
  bx_xr[8] = 1.58113883008419*bx[26]+1.224744871391589*bx[25]+0.7071067811865475*bx[22]; 
  bxbx_xr[0] = 1.58113883008419*bxbx[7]+1.224744871391589*bxbx[1]+0.7071067811865475*bxbx[0]; 
  bxbx_xr[1] = 1.58113883008419*bxbx[11]+1.224744871391589*bxbx[4]+0.7071067811865475*bxbx[2]; 
  bxbx_xr[2] = 1.58113883008419*bxbx[13]+1.224744871391589*bxbx[5]+0.7071067811865475*bxbx[3]; 
  bxbx_xr[3] = 1.58113883008419*bxbx[17]+1.224744871391589*bxbx[10]+0.7071067811865475*bxbx[6]; 
  bxbx_xr[4] = 1.58113883008419*bxbx[20]+1.224744871391589*bxbx[12]+0.7071067811865475*bxbx[8]; 
  bxbx_xr[5] = 1.58113883008419*bxbx[21]+1.224744871391589*bxbx[15]+0.7071067811865475*bxbx[9]; 
  bxbx_xr[6] = 1.58113883008419*bxbx[23]+1.224744871391589*bxbx[18]+0.7071067811865475*bxbx[14]; 
  bxbx_xr[7] = 1.58113883008419*bxbx[24]+1.224744871391589*bxbx[19]+0.7071067811865475*bxbx[16]; 
  bxbx_xr[8] = 1.58113883008419*bxbx[26]+1.224744871391589*bxbx[25]+0.7071067811865475*bxbx[22]; 
  bxby_xr[0] = 1.58113883008419*bxby[7]+1.224744871391589*bxby[1]+0.7071067811865475*bxby[0]; 
  bxby_xr[1] = 1.58113883008419*bxby[11]+1.224744871391589*bxby[4]+0.7071067811865475*bxby[2]; 
  bxby_xr[2] = 1.58113883008419*bxby[13]+1.224744871391589*bxby[5]+0.7071067811865475*bxby[3]; 
  bxby_xr[3] = 1.58113883008419*bxby[17]+1.224744871391589*bxby[10]+0.7071067811865475*bxby[6]; 
  bxby_xr[4] = 1.58113883008419*bxby[20]+1.224744871391589*bxby[12]+0.7071067811865475*bxby[8]; 
  bxby_xr[5] = 1.58113883008419*bxby[21]+1.224744871391589*bxby[15]+0.7071067811865475*bxby[9]; 
  bxby_xr[6] = 1.58113883008419*bxby[23]+1.224744871391589*bxby[18]+0.7071067811865475*bxby[14]; 
  bxby_xr[7] = 1.58113883008419*bxby[24]+1.224744871391589*bxby[19]+0.7071067811865475*bxby[16]; 
  bxby_xr[8] = 1.58113883008419*bxby[26]+1.224744871391589*bxby[25]+0.7071067811865475*bxby[22]; 
  bxbz_xr[0] = 1.58113883008419*bxbz[7]+1.224744871391589*bxbz[1]+0.7071067811865475*bxbz[0]; 
  bxbz_xr[1] = 1.58113883008419*bxbz[11]+1.224744871391589*bxbz[4]+0.7071067811865475*bxbz[2]; 
  bxbz_xr[2] = 1.58113883008419*bxbz[13]+1.224744871391589*bxbz[5]+0.7071067811865475*bxbz[3]; 
  bxbz_xr[3] = 1.58113883008419*bxbz[17]+1.224744871391589*bxbz[10]+0.7071067811865475*bxbz[6]; 
  bxbz_xr[4] = 1.58113883008419*bxbz[20]+1.224744871391589*bxbz[12]+0.7071067811865475*bxbz[8]; 
  bxbz_xr[5] = 1.58113883008419*bxbz[21]+1.224744871391589*bxbz[15]+0.7071067811865475*bxbz[9]; 
  bxbz_xr[6] = 1.58113883008419*bxbz[23]+1.224744871391589*bxbz[18]+0.7071067811865475*bxbz[14]; 
  bxbz_xr[7] = 1.58113883008419*bxbz[24]+1.224744871391589*bxbz[19]+0.7071067811865475*bxbz[16]; 
  bxbz_xr[8] = 1.58113883008419*bxbz[26]+1.224744871391589*bxbz[25]+0.7071067811865475*bxbz[22]; 
 
  double *by_yl = &bvar_surf[72]; 
  double *by_yr = &bvar_surf[81]; 
  double *bxby_yl = &bvar_surf[90]; 
  double *bxby_yr = &bvar_surf[99]; 
  double *byby_yl = &bvar_surf[108]; 
  double *byby_yr = &bvar_surf[117]; 
  double *bybz_yl = &bvar_surf[126]; 
  double *bybz_yr = &bvar_surf[135]; 
 
  by_yl[0] = 1.58113883008419*by[8]-1.224744871391589*by[2]+0.7071067811865475*by[0]; 
  by_yl[1] = 1.58113883008419*by[12]-1.224744871391589*by[4]+0.7071067811865475*by[1]; 
  by_yl[2] = 1.58113883008419*by[14]-1.224744871391589*by[6]+0.7071067811865475*by[3]; 
  by_yl[3] = 1.58113883008419*by[18]-1.224744871391589*by[10]+0.7071067811865475*by[5]; 
  by_yl[4] = 1.58113883008419*by[20]-1.224744871391589*by[11]+0.7071067811865475*by[7]; 
  by_yl[5] = 1.58113883008419*by[22]-1.224744871391589*by[16]+0.7071067811865475*by[9]; 
  by_yl[6] = 1.58113883008419*by[23]-1.224744871391589*by[17]+0.7071067811865475*by[13]; 
  by_yl[7] = 1.58113883008419*by[25]-1.224744871391589*by[19]+0.7071067811865475*by[15]; 
  by_yl[8] = 1.58113883008419*by[26]-1.224744871391589*by[24]+0.7071067811865475*by[21]; 
  bxby_yl[0] = 1.58113883008419*bxby[8]-1.224744871391589*bxby[2]+0.7071067811865475*bxby[0]; 
  bxby_yl[1] = 1.58113883008419*bxby[12]-1.224744871391589*bxby[4]+0.7071067811865475*bxby[1]; 
  bxby_yl[2] = 1.58113883008419*bxby[14]-1.224744871391589*bxby[6]+0.7071067811865475*bxby[3]; 
  bxby_yl[3] = 1.58113883008419*bxby[18]-1.224744871391589*bxby[10]+0.7071067811865475*bxby[5]; 
  bxby_yl[4] = 1.58113883008419*bxby[20]-1.224744871391589*bxby[11]+0.7071067811865475*bxby[7]; 
  bxby_yl[5] = 1.58113883008419*bxby[22]-1.224744871391589*bxby[16]+0.7071067811865475*bxby[9]; 
  bxby_yl[6] = 1.58113883008419*bxby[23]-1.224744871391589*bxby[17]+0.7071067811865475*bxby[13]; 
  bxby_yl[7] = 1.58113883008419*bxby[25]-1.224744871391589*bxby[19]+0.7071067811865475*bxby[15]; 
  bxby_yl[8] = 1.58113883008419*bxby[26]-1.224744871391589*bxby[24]+0.7071067811865475*bxby[21]; 
  byby_yl[0] = 1.58113883008419*byby[8]-1.224744871391589*byby[2]+0.7071067811865475*byby[0]; 
  byby_yl[1] = 1.58113883008419*byby[12]-1.224744871391589*byby[4]+0.7071067811865475*byby[1]; 
  byby_yl[2] = 1.58113883008419*byby[14]-1.224744871391589*byby[6]+0.7071067811865475*byby[3]; 
  byby_yl[3] = 1.58113883008419*byby[18]-1.224744871391589*byby[10]+0.7071067811865475*byby[5]; 
  byby_yl[4] = 1.58113883008419*byby[20]-1.224744871391589*byby[11]+0.7071067811865475*byby[7]; 
  byby_yl[5] = 1.58113883008419*byby[22]-1.224744871391589*byby[16]+0.7071067811865475*byby[9]; 
  byby_yl[6] = 1.58113883008419*byby[23]-1.224744871391589*byby[17]+0.7071067811865475*byby[13]; 
  byby_yl[7] = 1.58113883008419*byby[25]-1.224744871391589*byby[19]+0.7071067811865475*byby[15]; 
  byby_yl[8] = 1.58113883008419*byby[26]-1.224744871391589*byby[24]+0.7071067811865475*byby[21]; 
  bybz_yl[0] = 1.58113883008419*bybz[8]-1.224744871391589*bybz[2]+0.7071067811865475*bybz[0]; 
  bybz_yl[1] = 1.58113883008419*bybz[12]-1.224744871391589*bybz[4]+0.7071067811865475*bybz[1]; 
  bybz_yl[2] = 1.58113883008419*bybz[14]-1.224744871391589*bybz[6]+0.7071067811865475*bybz[3]; 
  bybz_yl[3] = 1.58113883008419*bybz[18]-1.224744871391589*bybz[10]+0.7071067811865475*bybz[5]; 
  bybz_yl[4] = 1.58113883008419*bybz[20]-1.224744871391589*bybz[11]+0.7071067811865475*bybz[7]; 
  bybz_yl[5] = 1.58113883008419*bybz[22]-1.224744871391589*bybz[16]+0.7071067811865475*bybz[9]; 
  bybz_yl[6] = 1.58113883008419*bybz[23]-1.224744871391589*bybz[17]+0.7071067811865475*bybz[13]; 
  bybz_yl[7] = 1.58113883008419*bybz[25]-1.224744871391589*bybz[19]+0.7071067811865475*bybz[15]; 
  bybz_yl[8] = 1.58113883008419*bybz[26]-1.224744871391589*bybz[24]+0.7071067811865475*bybz[21]; 
 
  by_yr[0] = 1.58113883008419*by[8]+1.224744871391589*by[2]+0.7071067811865475*by[0]; 
  by_yr[1] = 1.58113883008419*by[12]+1.224744871391589*by[4]+0.7071067811865475*by[1]; 
  by_yr[2] = 1.58113883008419*by[14]+1.224744871391589*by[6]+0.7071067811865475*by[3]; 
  by_yr[3] = 1.58113883008419*by[18]+1.224744871391589*by[10]+0.7071067811865475*by[5]; 
  by_yr[4] = 1.58113883008419*by[20]+1.224744871391589*by[11]+0.7071067811865475*by[7]; 
  by_yr[5] = 1.58113883008419*by[22]+1.224744871391589*by[16]+0.7071067811865475*by[9]; 
  by_yr[6] = 1.58113883008419*by[23]+1.224744871391589*by[17]+0.7071067811865475*by[13]; 
  by_yr[7] = 1.58113883008419*by[25]+1.224744871391589*by[19]+0.7071067811865475*by[15]; 
  by_yr[8] = 1.58113883008419*by[26]+1.224744871391589*by[24]+0.7071067811865475*by[21]; 
  bxby_yr[0] = 1.58113883008419*bxby[8]+1.224744871391589*bxby[2]+0.7071067811865475*bxby[0]; 
  bxby_yr[1] = 1.58113883008419*bxby[12]+1.224744871391589*bxby[4]+0.7071067811865475*bxby[1]; 
  bxby_yr[2] = 1.58113883008419*bxby[14]+1.224744871391589*bxby[6]+0.7071067811865475*bxby[3]; 
  bxby_yr[3] = 1.58113883008419*bxby[18]+1.224744871391589*bxby[10]+0.7071067811865475*bxby[5]; 
  bxby_yr[4] = 1.58113883008419*bxby[20]+1.224744871391589*bxby[11]+0.7071067811865475*bxby[7]; 
  bxby_yr[5] = 1.58113883008419*bxby[22]+1.224744871391589*bxby[16]+0.7071067811865475*bxby[9]; 
  bxby_yr[6] = 1.58113883008419*bxby[23]+1.224744871391589*bxby[17]+0.7071067811865475*bxby[13]; 
  bxby_yr[7] = 1.58113883008419*bxby[25]+1.224744871391589*bxby[19]+0.7071067811865475*bxby[15]; 
  bxby_yr[8] = 1.58113883008419*bxby[26]+1.224744871391589*bxby[24]+0.7071067811865475*bxby[21]; 
  byby_yr[0] = 1.58113883008419*byby[8]+1.224744871391589*byby[2]+0.7071067811865475*byby[0]; 
  byby_yr[1] = 1.58113883008419*byby[12]+1.224744871391589*byby[4]+0.7071067811865475*byby[1]; 
  byby_yr[2] = 1.58113883008419*byby[14]+1.224744871391589*byby[6]+0.7071067811865475*byby[3]; 
  byby_yr[3] = 1.58113883008419*byby[18]+1.224744871391589*byby[10]+0.7071067811865475*byby[5]; 
  byby_yr[4] = 1.58113883008419*byby[20]+1.224744871391589*byby[11]+0.7071067811865475*byby[7]; 
  byby_yr[5] = 1.58113883008419*byby[22]+1.224744871391589*byby[16]+0.7071067811865475*byby[9]; 
  byby_yr[6] = 1.58113883008419*byby[23]+1.224744871391589*byby[17]+0.7071067811865475*byby[13]; 
  byby_yr[7] = 1.58113883008419*byby[25]+1.224744871391589*byby[19]+0.7071067811865475*byby[15]; 
  byby_yr[8] = 1.58113883008419*byby[26]+1.224744871391589*byby[24]+0.7071067811865475*byby[21]; 
  bybz_yr[0] = 1.58113883008419*bybz[8]+1.224744871391589*bybz[2]+0.7071067811865475*bybz[0]; 
  bybz_yr[1] = 1.58113883008419*bybz[12]+1.224744871391589*bybz[4]+0.7071067811865475*bybz[1]; 
  bybz_yr[2] = 1.58113883008419*bybz[14]+1.224744871391589*bybz[6]+0.7071067811865475*bybz[3]; 
  bybz_yr[3] = 1.58113883008419*bybz[18]+1.224744871391589*bybz[10]+0.7071067811865475*bybz[5]; 
  bybz_yr[4] = 1.58113883008419*bybz[20]+1.224744871391589*bybz[11]+0.7071067811865475*bybz[7]; 
  bybz_yr[5] = 1.58113883008419*bybz[22]+1.224744871391589*bybz[16]+0.7071067811865475*bybz[9]; 
  bybz_yr[6] = 1.58113883008419*bybz[23]+1.224744871391589*bybz[17]+0.7071067811865475*bybz[13]; 
  bybz_yr[7] = 1.58113883008419*bybz[25]+1.224744871391589*bybz[19]+0.7071067811865475*bybz[15]; 
  bybz_yr[8] = 1.58113883008419*bybz[26]+1.224744871391589*bybz[24]+0.7071067811865475*bybz[21]; 
 
  double *bz_zl = &bvar_surf[144]; 
  double *bz_zr = &bvar_surf[153]; 
  double *bxbz_zl = &bvar_surf[162]; 
  double *bxbz_zr = &bvar_surf[171]; 
  double *bybz_zl = &bvar_surf[180]; 
  double *bybz_zr = &bvar_surf[189]; 
  double *bzbz_zl = &bvar_surf[198]; 
  double *bzbz_zr = &bvar_surf[207]; 
 
  bz_zl[0] = 1.58113883008419*bz[9]-1.224744871391589*bz[3]+0.7071067811865475*bz[0]; 
  bz_zl[1] = 1.58113883008419*bz[15]-1.224744871391589*bz[5]+0.7071067811865475*bz[1]; 
  bz_zl[2] = 1.58113883008419*bz[16]-1.224744871391589*bz[6]+0.7071067811865475*bz[2]; 
  bz_zl[3] = 1.58113883008419*bz[19]-1.224744871391589*bz[10]+0.7071067811865475*bz[4]; 
  bz_zl[4] = 1.58113883008419*bz[21]-1.224744871391589*bz[13]+0.7071067811865475*bz[7]; 
  bz_zl[5] = 1.58113883008419*bz[22]-1.224744871391589*bz[14]+0.7071067811865475*bz[8]; 
  bz_zl[6] = 1.58113883008419*bz[24]-1.224744871391589*bz[17]+0.7071067811865475*bz[11]; 
  bz_zl[7] = 1.58113883008419*bz[25]-1.224744871391589*bz[18]+0.7071067811865475*bz[12]; 
  bz_zl[8] = 1.58113883008419*bz[26]-1.224744871391589*bz[23]+0.7071067811865475*bz[20]; 
  bxbz_zl[0] = 1.58113883008419*bxbz[9]-1.224744871391589*bxbz[3]+0.7071067811865475*bxbz[0]; 
  bxbz_zl[1] = 1.58113883008419*bxbz[15]-1.224744871391589*bxbz[5]+0.7071067811865475*bxbz[1]; 
  bxbz_zl[2] = 1.58113883008419*bxbz[16]-1.224744871391589*bxbz[6]+0.7071067811865475*bxbz[2]; 
  bxbz_zl[3] = 1.58113883008419*bxbz[19]-1.224744871391589*bxbz[10]+0.7071067811865475*bxbz[4]; 
  bxbz_zl[4] = 1.58113883008419*bxbz[21]-1.224744871391589*bxbz[13]+0.7071067811865475*bxbz[7]; 
  bxbz_zl[5] = 1.58113883008419*bxbz[22]-1.224744871391589*bxbz[14]+0.7071067811865475*bxbz[8]; 
  bxbz_zl[6] = 1.58113883008419*bxbz[24]-1.224744871391589*bxbz[17]+0.7071067811865475*bxbz[11]; 
  bxbz_zl[7] = 1.58113883008419*bxbz[25]-1.224744871391589*bxbz[18]+0.7071067811865475*bxbz[12]; 
  bxbz_zl[8] = 1.58113883008419*bxbz[26]-1.224744871391589*bxbz[23]+0.7071067811865475*bxbz[20]; 
  bybz_zl[0] = 1.58113883008419*bybz[9]-1.224744871391589*bybz[3]+0.7071067811865475*bybz[0]; 
  bybz_zl[1] = 1.58113883008419*bybz[15]-1.224744871391589*bybz[5]+0.7071067811865475*bybz[1]; 
  bybz_zl[2] = 1.58113883008419*bybz[16]-1.224744871391589*bybz[6]+0.7071067811865475*bybz[2]; 
  bybz_zl[3] = 1.58113883008419*bybz[19]-1.224744871391589*bybz[10]+0.7071067811865475*bybz[4]; 
  bybz_zl[4] = 1.58113883008419*bybz[21]-1.224744871391589*bybz[13]+0.7071067811865475*bybz[7]; 
  bybz_zl[5] = 1.58113883008419*bybz[22]-1.224744871391589*bybz[14]+0.7071067811865475*bybz[8]; 
  bybz_zl[6] = 1.58113883008419*bybz[24]-1.224744871391589*bybz[17]+0.7071067811865475*bybz[11]; 
  bybz_zl[7] = 1.58113883008419*bybz[25]-1.224744871391589*bybz[18]+0.7071067811865475*bybz[12]; 
  bybz_zl[8] = 1.58113883008419*bybz[26]-1.224744871391589*bybz[23]+0.7071067811865475*bybz[20]; 
  bzbz_zl[0] = 1.58113883008419*bzbz[9]-1.224744871391589*bzbz[3]+0.7071067811865475*bzbz[0]; 
  bzbz_zl[1] = 1.58113883008419*bzbz[15]-1.224744871391589*bzbz[5]+0.7071067811865475*bzbz[1]; 
  bzbz_zl[2] = 1.58113883008419*bzbz[16]-1.224744871391589*bzbz[6]+0.7071067811865475*bzbz[2]; 
  bzbz_zl[3] = 1.58113883008419*bzbz[19]-1.224744871391589*bzbz[10]+0.7071067811865475*bzbz[4]; 
  bzbz_zl[4] = 1.58113883008419*bzbz[21]-1.224744871391589*bzbz[13]+0.7071067811865475*bzbz[7]; 
  bzbz_zl[5] = 1.58113883008419*bzbz[22]-1.224744871391589*bzbz[14]+0.7071067811865475*bzbz[8]; 
  bzbz_zl[6] = 1.58113883008419*bzbz[24]-1.224744871391589*bzbz[17]+0.7071067811865475*bzbz[11]; 
  bzbz_zl[7] = 1.58113883008419*bzbz[25]-1.224744871391589*bzbz[18]+0.7071067811865475*bzbz[12]; 
  bzbz_zl[8] = 1.58113883008419*bzbz[26]-1.224744871391589*bzbz[23]+0.7071067811865475*bzbz[20]; 
 
  bz_zr[0] = 1.58113883008419*bz[9]+1.224744871391589*bz[3]+0.7071067811865475*bz[0]; 
  bz_zr[1] = 1.58113883008419*bz[15]+1.224744871391589*bz[5]+0.7071067811865475*bz[1]; 
  bz_zr[2] = 1.58113883008419*bz[16]+1.224744871391589*bz[6]+0.7071067811865475*bz[2]; 
  bz_zr[3] = 1.58113883008419*bz[19]+1.224744871391589*bz[10]+0.7071067811865475*bz[4]; 
  bz_zr[4] = 1.58113883008419*bz[21]+1.224744871391589*bz[13]+0.7071067811865475*bz[7]; 
  bz_zr[5] = 1.58113883008419*bz[22]+1.224744871391589*bz[14]+0.7071067811865475*bz[8]; 
  bz_zr[6] = 1.58113883008419*bz[24]+1.224744871391589*bz[17]+0.7071067811865475*bz[11]; 
  bz_zr[7] = 1.58113883008419*bz[25]+1.224744871391589*bz[18]+0.7071067811865475*bz[12]; 
  bz_zr[8] = 1.58113883008419*bz[26]+1.224744871391589*bz[23]+0.7071067811865475*bz[20]; 
  bxbz_zr[0] = 1.58113883008419*bxbz[9]+1.224744871391589*bxbz[3]+0.7071067811865475*bxbz[0]; 
  bxbz_zr[1] = 1.58113883008419*bxbz[15]+1.224744871391589*bxbz[5]+0.7071067811865475*bxbz[1]; 
  bxbz_zr[2] = 1.58113883008419*bxbz[16]+1.224744871391589*bxbz[6]+0.7071067811865475*bxbz[2]; 
  bxbz_zr[3] = 1.58113883008419*bxbz[19]+1.224744871391589*bxbz[10]+0.7071067811865475*bxbz[4]; 
  bxbz_zr[4] = 1.58113883008419*bxbz[21]+1.224744871391589*bxbz[13]+0.7071067811865475*bxbz[7]; 
  bxbz_zr[5] = 1.58113883008419*bxbz[22]+1.224744871391589*bxbz[14]+0.7071067811865475*bxbz[8]; 
  bxbz_zr[6] = 1.58113883008419*bxbz[24]+1.224744871391589*bxbz[17]+0.7071067811865475*bxbz[11]; 
  bxbz_zr[7] = 1.58113883008419*bxbz[25]+1.224744871391589*bxbz[18]+0.7071067811865475*bxbz[12]; 
  bxbz_zr[8] = 1.58113883008419*bxbz[26]+1.224744871391589*bxbz[23]+0.7071067811865475*bxbz[20]; 
  bybz_zr[0] = 1.58113883008419*bybz[9]+1.224744871391589*bybz[3]+0.7071067811865475*bybz[0]; 
  bybz_zr[1] = 1.58113883008419*bybz[15]+1.224744871391589*bybz[5]+0.7071067811865475*bybz[1]; 
  bybz_zr[2] = 1.58113883008419*bybz[16]+1.224744871391589*bybz[6]+0.7071067811865475*bybz[2]; 
  bybz_zr[3] = 1.58113883008419*bybz[19]+1.224744871391589*bybz[10]+0.7071067811865475*bybz[4]; 
  bybz_zr[4] = 1.58113883008419*bybz[21]+1.224744871391589*bybz[13]+0.7071067811865475*bybz[7]; 
  bybz_zr[5] = 1.58113883008419*bybz[22]+1.224744871391589*bybz[14]+0.7071067811865475*bybz[8]; 
  bybz_zr[6] = 1.58113883008419*bybz[24]+1.224744871391589*bybz[17]+0.7071067811865475*bybz[11]; 
  bybz_zr[7] = 1.58113883008419*bybz[25]+1.224744871391589*bybz[18]+0.7071067811865475*bybz[12]; 
  bybz_zr[8] = 1.58113883008419*bybz[26]+1.224744871391589*bybz[23]+0.7071067811865475*bybz[20]; 
  bzbz_zr[0] = 1.58113883008419*bzbz[9]+1.224744871391589*bzbz[3]+0.7071067811865475*bzbz[0]; 
  bzbz_zr[1] = 1.58113883008419*bzbz[15]+1.224744871391589*bzbz[5]+0.7071067811865475*bzbz[1]; 
  bzbz_zr[2] = 1.58113883008419*bzbz[16]+1.224744871391589*bzbz[6]+0.7071067811865475*bzbz[2]; 
  bzbz_zr[3] = 1.58113883008419*bzbz[19]+1.224744871391589*bzbz[10]+0.7071067811865475*bzbz[4]; 
  bzbz_zr[4] = 1.58113883008419*bzbz[21]+1.224744871391589*bzbz[13]+0.7071067811865475*bzbz[7]; 
  bzbz_zr[5] = 1.58113883008419*bzbz[22]+1.224744871391589*bzbz[14]+0.7071067811865475*bzbz[8]; 
  bzbz_zr[6] = 1.58113883008419*bzbz[24]+1.224744871391589*bzbz[17]+0.7071067811865475*bzbz[11]; 
  bzbz_zr[7] = 1.58113883008419*bzbz[25]+1.224744871391589*bzbz[18]+0.7071067811865475*bzbz[12]; 
  bzbz_zr[8] = 1.58113883008419*bzbz[26]+1.224744871391589*bzbz[23]+0.7071067811865475*bzbz[20]; 
 
} 
 
